               ALLOCATE (COAL_VECTOR_MAP(-1:MaxVectorNum))
               ALLOCATE (COAL_VECTOR_TYPE_IS_VALUE(-1:nArray), &
                  allocate(AllArray(LowB1:UpB1))
               allocate(AllArray(LowB1:UpB1))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(LowB1:UpB1))
               allocate(AllArray(LowB1:UpB1))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(UpB1,UpB2))
               allocate(AllArray(UpB1,UpB2))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(LowB1:UpB1,LowB2:UpB2))
               allocate(AllArray(LowB1:UpB1,LowB2:UpB2))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(LowB1:UpB1,LowB2:UpB2))
               allocate(AllArray(LowB1:UpB1,LowB2:UpB2))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(UpB1,UpB2))
               allocate(AllArray(UpB1,UpB2))
                  allocate(AllArray(LowB1:UpB1))
               allocate(AllArray(LowB1:UpB1))
                  allocate(AllArray(LowB1:UpB1,LowB2:UpB2))
               allocate(AllArray(LowB1:UpB1,LowB2:UpB2))
                  allocate(AllArray(LowB1:UpB1,LowB2:UpB2,LowB3:UpB3))
               allocate(AllArray(LowB1:UpB1,LowB2:UpB2,LowB3:UpB3))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(LowB1:UpB1,LowB2:UpB2))
               allocate(AllArray(LowB1:UpB1,LowB2:UpB2))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(UpB1))
               allocate(AllArray(UpB1))
                  allocate(AllArray(LowB1:UpB1,LowB2:UpB2))
               allocate(AllArray(LowB1:UpB1,LowB2:UpB2))
         ALLOCATE(DIMENSION_NAME(DIMENSIONS),      &
         ALLOCATE(DEM_1_PTR(MAX_UNIQUE_VALUES))
         ALLOCATE(DEM_1_NAME_STORAGE(MAX_UNIQUE_VALUES))
         ALLOCATE(DEM_2_PTR(MAX_UNIQUE_VALUES))
         ALLOCATE(DEM_2_NAME_STORAGE(MAX_UNIQUE_VALUES))
            ALLOCATE(DEM_3_PTR(MAX_UNIQUE_VALUES))
            ALLOCATE(DEM_3_NAME_STORAGE(MAX_UNIQUE_VALUES))
            ALLOCATE(DEM_4_PTR(MAX_UNIQUE_VALUES))
            ALLOCATE(DEM_4_NAME_STORAGE(MAX_UNIQUE_VALUES))
            ALLOCATE(DEM_5_PTR(MAX_UNIQUE_VALUES))
            ALLOCATE(DEM_5_NAME_STORAGE(MAX_UNIQUE_VALUES))
            ALLOCATE(DEM_6_PTR(MAX_UNIQUE_VALUES))
            ALLOCATE(DEM_6_NAME_STORAGE(MAX_UNIQUE_VALUES))
            ALLOCATE(DEM_7_PTR(MAX_UNIQUE_VALUES))
            ALLOCATE(DEM_7_NAME_STORAGE(MAX_UNIQUE_VALUES))
         ALLOCATE(DEM_1_PTR(DEM_1_UNIQUE_VALUES),           &
         ALLOCATE(DEM_2_PTR(DEM_2_UNIQUE_VALUES),           & 
            ALLOCATE(DEM_3_PTR(DEM_3_UNIQUE_VALUES),        &
            ALLOCATE(DEM_4_PTR(DEM_4_UNIQUE_VALUES),        &
            ALLOCATE(DEM_5_PTR(DEM_5_UNIQUE_VALUES),        &
            ALLOCATE(DEM_6_PTR(DEM_6_UNIQUE_VALUES),        &
            ALLOCATE(DEM_7_PTR(DEM_7_UNIQUE_VALUES),        &
         ALLOCATE(PLAN_IDENTIFIER(0:MAX_NUMBER_OF_PLANS_TO_SAVE), STAT=I4ST)
         ALLOCATE(PLAN_OBJECT_FUNCTION_VALUE(0:MAX_NUMBER_OF_PLANS_TO_SAVE), STAT=I4ST)
         ALLOCATE(PLAN_HAS_MUT_EXC_UNITS(0:MAX_NUMBER_OF_PLANS_TO_SAVE), STAT=I4ST)
         ALLOCATE(PLAN_OPTION_SEQUENCE(50, MAX_NUMBER_OF_PLANS_TO_SAVE), STAT=I4ST)
         ALLOCATE(OPTION_POINTR(ACTIVE_OPTIONS), STAT=I4ST)
         ALLOCATE(OPTION_ANN_UNITS(ACTIVE_OPTIONS), STAT=I4ST)
         ALLOCATE(AVAIL_ANNUAL_UNITS(ACTIVE_OPTIONS), STAT=I4ST)
         ALLOCATE(OPTION_AVAIL_UNITS(ACTIVE_OPTIONS), STAT=I4ST)
         ALLOCATE(AVAIL_CUM_UNITS(ACTIVE_OPTIONS), STAT=I4ST)
         ALLOCATE(OPTION_CAP(ACTIVE_OPTIONS), STAT=I4ST)
         ALLOCATE(OPTION_LOADING_TYPE(ACTIVE_OPTIONS), STAT=I4ST)
         ALLOCATE(OPTION_IS_ACTIVE(ACTIVE_OPTIONS), STAT=I4ST)
         ALLOCATE(PLAN_BEING_TESTED(50), STAT=I4ST)
               ALLOCATE(BAD_ODD_PLANS(OPTION_DEPTH,MAX_BAD_PLANS))
            ALLOCATE(BAD_EVEN_PLANS(OPTION_DEPTH,MAX_BAD_PLANS))
            ALLOCATE(DEPTH_BEST_PLANS(OPTION_DEPTH, DEPTH_PLANS_2_SAVE), STAT=I4ST)
            ALLOCATE(DEPTH_PLAN_OBJECTIVE_VALUE(DEPTH_PLANS_2_SAVE), STAT=I4ST)
            ALLOCATE(PLANS_2_TEST_AT_NEXT_DEPTH(OPTION_DEPTH, MAX_PLANS_2_TEST), STAT=I4ST)
                     ALLOCATE(BAD_ODD_PLANS(OPTION_DEPTH,MAX_BAD_PLANS))
                     ALLOCATE(   &
                     ALLOCATE(LIST_OF_COMBINATIONS(OPTION_DEPTH-1,   &
                     ALLOCATE(LIST_OF_COMBINATIONS(OPTION_DEPTH-1,   &
                  ALLOCATE(DEPTH_BEST_PLANS(OPTION_DEPTH, DEPTH_PLANS_2_SAVE), STAT=I4ST)
                  ALLOCATE(DEPTH_PLAN_OBJECTIVE_VALUE(DEPTH_PLANS_2_SAVE), STAT=I4ST)
                  ALLOCATE(PLANS_2_TEST_AT_NEXT_DEPTH(OPTION_DEPTH, MAX_PLANS_2_TEST), STAT=I4ST)
                           ALLOCATE(TEMP_BAD_ARRAY(OPTION_DEPTH, MAX_BAD_PLANS), STAT=I4ST)
                              ALLOCATE(BAD_ODD_PLANS(OPTION_DEPTH,   &
                              ALLOCATE(BAD_EVEN_PLANS(OPTION_DEPTH,   &
            ALLOCATE(SORTED_POINTER(NUMBER_OF_SAVED_PLANS))
            ALLOCATE(POSITION_MATCHED(OPTION_DEPTH-1))
            ALLOCATE(POSITION_MATCHED(OPTION_DEPTH-1))
      ALLOCATE(ACTIVE_OPTION_LIST(TOTAL_OPTIONS))
         ALLOCATE(COMBINATION_ARRAYS(DEPTH))
      ALLOCATE(DSM_CAP(3,STUDY_PERIOD))
         ALLOCATE(PLAN_IDENTIFIER(0:MAX_NUMBER_OF_PLANS_TO_SAVE), &
            ALLOCATE(ACTIVE_OPTIONS(OPTION_DEPTH))
      ALLOCATE(DSM_CAP(3,STUDY_PERIOD))
         ALLOCATE(COMMITTED_OPTION_POINTERS(MAX_COMMITTED_OPTIONS), &
      ALLOCATE(DSM_CAP(3,STUDY_PERIOD))
         ALLOCATE(DELAYED_ON_LINE_DATE(NEXT_COMMITTED_OPTION))
         ALLOCATE(TEMP_I2_ARRAY(NEXT_COMMITTED_OPTION))
         ALLOCATE(COMMITTED_OPTION_POINTERS(MAX_COMMITTED_OPTIONS))
         ALLOCATE(COMMITTED_OPTION_TIMES_DELAYED(MAX_COMMITTED_OPTIONS))
         ALLOCATE(COMMITTED_OPTION_START_YEAR(MAX_COMMITTED_OPTIONS))
         ALLOCATE(COMMITTED_OPTION_ON_LINE_YR(MAX_COMMITTED_OPTIONS))
         ALLOCATE( &
         ALLOCATE(REC_LOCATOR(MAX_COMMITTED_OPTIONS))
         ALLOCATE(TEMP_R4_ARRAY(NEXT_COMMITTED_OPTION))
         ALLOCATE(OPTION_PERCENT_COMPLETED(MAX_COMMITTED_OPTIONS))
         ALLOCATE(TEMP_L1_ARRAY(NEXT_COMMITTED_OPTION))
         ALLOCATE(HAS_BEEN_ACCELERATED(MAX_COMMITTED_OPTIONS))
         ALLOCATE(TEMP_I2_ARRAY(NEXT_PLANNED_OPTION))
         ALLOCATE(PLANNED_OPTION_POINTERS(MAX_COMMITTED_OPTIONS))
         ALLOCATE(PLANNED_OPTION_START_YEAR(MAX_COMMITTED_OPTIONS))
         ALLOCATE(PLANNED_OPTION_ON_LINE_YR(MAX_COMMITTED_OPTIONS))
            ALLOCATE(RECLN(2))
            ALLOCATE(RECLN(200))
         ALLOCATE(OVER_COST_LEVELS(MAX_OVER_TABLE_ROWS, &
         ALLOCATE(UNDER_COST_LEVELS(MAX_UNDER_TABLE_ROWS, &
        ALLOCATE(LAST_RESOURCE_ADDED(MAX(INT(1,2),UPPER_TRANS_GROUP)), &
            ALLOCATE(OPTION_NAME(TOTAL_ALL_OPTIONS), &
            ALLOCATE(ResourceIDtoOptionPosPrt(MaxProductionProinter))
         ALLOCATE(SCREEN_SLOPE(TOTAL_ALL_OPTIONS), &
         ALLOCATE(SCREEN_SLOPE(TOTAL_ALL_OPTIONS), &
         ALLOCATE(MULTI_AREA_NAME(0:UPPER_TRANS_GROUP), &
            ALLOCATE(MRX_RPS_MX_CURVE_MARGIN(HO,PA), &
         ALLOCATE(LAST_RESOURCE_ADDED(MAX(INT(1,2),UPPER_TRANS_GROUP)))
            ALLOCATE(OPTION_NAME(TOTAL_ALL_OPTIONS), &
         ALLOCATE(SCREEN_SLOPE(TOTAL_ALL_OPTIONS), &
         ALLOCATE(MULTI_AREA_NAME(0:UPPER_TRANS_GROUP), &
         ALLOCATE(CO2_EMISSIONS_CAP(0:UPPER_TRANS_GROUP), &
    ALLOCATE(RPS_HYDRO_DB(2,400,NUMPMS,0:12))
    allocate(QUALIFYING_GEN_DB(ACTIVE_RPS,0:NUMPMS,2))
	allocate(GRX_QUAL_GEN_DB(ACTIVE_RPS,0:NUMPMS,2))
	allocate(SAVE_GRX_QUAL_GEN_DB(ACTIVE_RPS,0:NUMPMS,2))
     ALLOCATE(DEV_TG_CAP(0:16,0:MAX(1,nr_trans_classes), &
     ALLOCATE (DEV_NEW_TG_CAP(0:21,0:MAX(1,nr_trans_classes), &
     allocate(SAVED_DEV_NEW_TG_CAP(0:21,0:MAX(1, &
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
            ALLOCATE(BC_ASSET_CLASS_POINTER(MAX_BC_CLASS_ID_NUM))
      ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
         ALLOCATE(OL_ASSET_CLASS_POINTER(MAX_OL_CLASS_ID_NUM))
            ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
         ALLOCATE(CATAWBA_REVENUES(0:NUM_OF_ASSET_CLASSES, &
         ALLOCATE(ASSET_CLASS_LIST(AVAIL_DATA_YEARS), &
            ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
         ALLOCATE(ASSET_CLASS_LIST(AVAIL_DATA_YEARS), &
      ALLOCATE(PA_HOURLY_LOADS(HOURS_INCREMENT), &
         ALLOCATE(PA_UNIT_INDEX(NO_PA_RESOURCES), &
            ALLOCATE(ANN_PA_ENERGY(0:NO_PA_RESOURCES+1), &
         ALLOCATE(MONTHLY_PA_LOADS(LOCAL_HOURS))
         ALLOCATE(SUM_CLASS_PEAKS(12,2,FORECAST_GROWTH_YEARS, &
         ALLOCATE(CLASS_ANN_COIN_PEAK(MAX_LOAD_CLASSES, &
            ALLOCATE(SUM_CLASS_PEAKS(12,2,FORECAST_GROWTH_YEARS,1))
         ALLOCATE(S_FUELMX(CL_OPTIONS))
         ALLOCATE(S_PBTUCT(CL_OPTIONS))
         ALLOCATE(S_PFESCR(CL_OPTIONS))
         ALLOCATE(S_SBTUCT(CL_OPTIONS))
         ALLOCATE(S_RPS_PROGRAM_NUMBER(CL_OPTIONS))
         ALLOCATE(S_RPS_PERCENT(CL_OPTIONS))
         ALLOCATE(S_SFESCR(CL_OPTIONS))
         ALLOCATE(S_FUELADJ_IN(CL_OPTIONS))
         ALLOCATE(S_MNRATE(CL_OPTIONS,12))
         ALLOCATE(S_INTER_BLOCKS(CL_OPTIONS,3))
         ALLOCATE(S_FUELADJ(CL_OPTIONS))
         ALLOCATE(S_EFOR(CL_OPTIONS))
         ALLOCATE(S_VCPMWH_IN(CL_OPTIONS))
         ALLOCATE(S_OMESCR(CL_OPTIONS))
         ALLOCATE(S_FIXED_COST_IN(CL_OPTIONS))
         ALLOCATE(S_FIXED_COST_ESCALATOR(CL_OPTIONS))
         ALLOCATE(S_MONTHLY_CAPACITY_POINTER(CL_OPTIONS))
         ALLOCATE(S_HR_FACTOR(CL_OPTIONS))
         ALLOCATE(S_INPUT_MW(2,CL_OPTIONS))
         ALLOCATE(S_CAP_PLANNING_FAC(CL_OPTIONS))
         ALLOCATE(S_COEFF(3,CL_OPTIONS),P_SO2(CL_OPTIONS),P_NOX(CL_OPTIONS),P_PARTICULATES(CL_OPTIONS),P_EMIS_OTH2(CL_OPTIONS), &
         ALLOCATE(AHR(CL_OPTIONS))
         ALLOCATE(PROD_PNTR_BY_CL_UNITS(PROD_PNTR))
         ALLOCATE(S_UNITNM(CL_OPTIONS))
         ALLOCATE(LDTYPE(CL_OPTIONS))
         ALLOCATE(S_ANNUAL_CL_FIXED_COST(CL_OPTIONS))
         ALLOCATE(S_TRANSACTION_GROUP_ID(CL_OPTIONS))
         ALLOCATE(S_EMISSION_MARKET_LINK(CL_OPTIONS))
         ALLOCATE(S_ANNUAL_CL_FIXED_COST_ESC(CL_OPTIONS))
         ALLOCATE(P_FUEL_DELIVERY(CL_OPTIONS))
         ALLOCATE(START_UP_COSTS(CL_OPTIONS))
         ALLOCATE(START_UP_COSTS_ESCALATION(CL_OPTIONS))
         ALLOCATE(MIN_DOWN_TIME(CL_OPTIONS))
         ALLOCATE(MIN_UP_TIME(CL_OPTIONS))
         ALLOCATE(P_FUEL_DELIVERY_2(CL_OPTIONS))
         ALLOCATE(P_FUEL_DELIVERY_3(CL_OPTIONS))
         ALLOCATE(S_FUEL_DELIVERY(CL_OPTIONS))
         ALLOCATE(S_FUEL_DELIVERY_2(CL_OPTIONS))
         ALLOCATE(s_fuel_delivery_3(CL_OPTIONS))
         ALLOCATE(APPLY_NOX_SEASON_DATE(CL_OPTIONS),S_PRIMARY_MOVER(CL_OPTIONS),S_UNIT_GAS_REGION_INDEX(CL_OPTIONS), &
            ALLOCATE(cl_tg_cap(0:max_technology_counters, 0:MaxVariable, STUDY_PERIOD,2))
      ALLOCATE(MAINT_RQ_DA_DEC(N_ACTIVE_UNITS),STAT=I4ST)
      ALLOCATE(MAINT_WEIGHT(N_ACTIVE_UNITS),STAT=I4ST)
      ALLOCATE(ORDER_DEC(N_ACTIVE_UNITS),STAT=I4ST)
      ALLOCATE(OPT_RANGE_OFS(N_ACTIVE_UNITS),STAT=I4ST)
      ALLOCATE(OPT_RANGE_DUR(N_ACTIVE_UNITS),STAT=I4ST)
            ALLOCATE(HrsToState(0:1,12*MAX_FO_PER_MONTH),STAT=I4ST)
      ALLOCATE(   &
      ALLOCATE(SO_BEG_MODA(2,NUNITS),STAT=I4ST)
      ALLOCATE(SO_END_MODA(2,NUNITS),STAT=I4ST)
      ALLOCATE(FO_BEG_HR(MAX_FO_PER_MONTH,12,NUNITS),STAT=I4ST)
      ALLOCATE(FO_END_HR(MAX_FO_PER_MONTH,12,NUNITS),STAT=I4ST)
      ALLOCATE(PD_BEG_HR(MAX_PD_PER_MONTH,12,NUNITS),STAT=I4ST)
      ALLOCATE(PD_END_HR(MAX_PD_PER_MONTH,12,NUNITS),STAT=I4ST)
         ALLOCATE(BC_TABLE_POSITION_FOR(0:MAX_BC_CLASS_NUMBER))
         ALLOCATE(OL_TABLE_POSITION_FOR(0:MAX_OL_CLASS_NUMBER))
            ALLOCATE(   &
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
            ALLOCATE(OPTIONS_BC_ASSET_CLASS_POINTER (MAX_BC_CLASS_ID_NUM))
      ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
         ALLOCATE(OPTIONS_OL_ASSET_CLASS_POINTER (MAX_OL_CLASS_ID_NUM))
         allocate(ESCALATION_VECTOR(FOR_ALL_OPTIONS), STAT=astat)
         ALLOCATE(unit_names(FOR_ALL_OPTIONS),LOADING_TYPE(FOR_ALL_OPTIONS),FILE_SOURCE(FOR_ALL_OPTIONS), &
         ALLOCATE(THRESHOLD_CAPACITY(FOR_ALL_OPTIONS, &
         IF(BASE_OPTIONS > 0) ALLOCATE(BASE_OPTION_LIST(BASE_OPTIONS))
         IF(CYCLE_OPTIONS > 0) ALLOCATE(CYCL_OPTION_LIST(CYCLE_OPTIONS))
         IF(PEAK_OPTIONS > 0) ALLOCATE(PEAK_OPTION_LIST(PEAK_OPTIONS))
         IF(PEAK_REDUC_OPTIONS > 0) ALLOCATE(LOAD_OPTION_LIST(PEAK_REDUC_OPTIONS))
         IF(FILL_OPTIONS > 0) ALLOCATE(FILL_OPTION_LIST(FILL_OPTIONS))
         IF(TOTAL_ACTIVE_OPTIONS > 0) ALLOCATE(ACTIVE_OPTION_LIST(TOTAL_ACTIVE_OPTIONS))
            ALLOCATE(HARD_WIRED_LIST(HARD_WIRED_OPTIONS),HARD_WIRED_ON_LINE_YEAR(HARD_WIRED_OPTIONS))
         ALLOCATE(SAVE_NO_CL_ADDITIONS(MAX_SIMULATION_YEARS))
         ALLOCATE(SAVE_NO_EL_ADDITIONS(MAX_SIMULATION_YEARS))
            ALLOCATE(ADDED_LM_PROGRAMS(DSM_OPTIONS))
            ALLOCATE(ADDED_CONTRACT_PROGRAMS(CONTRACT_OPTIONS))
            ALLOCATE(TARGETS(3,STUDY_PERIOD), &
            ALLOCATE(TARGETS(3,STUDY_PERIOD), &
            ALLOCATE (Supply_Production_By_Year(20,nArray,0:30), &
            ALLOCATE(GenericTransportPtrToTG(0:256,20)) ! TG,1 = paths TG,>1 pointer
               ALLOCATE(GenericPlantPtrByTG(0:256))
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
            ALLOCATE(BC_ASSET_CLASS_POINTER(MAX_BC_CLASS_ID_NUM))
      ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
         ALLOCATE(OL_ASSET_CLASS_POINTER(MAX_OL_CLASS_ID_NUM))
      ALLOCATE(CONTRACT_ADJUSTMENTS_TO_PEAK(STUDY_PERIOD), &
      ALLOCATE(CONTRACT_BUY_CAPACITY(0:MAX_CONTRACT_CLASS_ID_NUM), &
      ALLOCATE(AVAILABLE_SHADOW_CAPACITY(MAX(NUNITS,INT(1,2))))
            ALLOCATE(CL_LOSSES(NUNITS))
            ALLOCATE(CT_LOSSES(NUMBER_OF_CONTRACTS))
         ALLOCATE(SOX_BY_FUEL_TYPE(3,LOCAL_MAX_CL_UNITS), &
      ALLOCATE(FRCLOD(8800),FORECAST_LOADS(24,3,12,SYSTEM_CLASS_NUM))
         ALLOCATE(EXT_RR_AT_LOAD_POINT(800))
         ALLOCATE(PEAK_ADJ_2_OFF_SYSTEM_SALES(STUDY_PERIOD))
      ALLOCATE(ON_LINE_MONTH(MAX_EL_UNITS),ON_LINE_YEAR(MAX_EL_UNITS),OFF_LINE_MONTH(MAX_EL_UNITS),OFF_LINE_YEAR(MAX_EL_UNITS), &
         ALLOCATE(EL_OPTIONS_ID_NUM(EL_OPTIONS),EL_OPTIONS_POINTR(EL_OPTIONS))
      ALLOCATE(PEAK_ADJ_2_OFF_SYSTEM_SALES(STUDY_PERIOD))
         IF(.NOT. ALLOCATED(TEMP_RETIRED_UNIT_NO)) ALLOCATE(TEMP_RETIRED_UNIT_NO(20),TEMP_RETIRED_OFF_LINE(20))
         ALLOCATE(BC_TABLE_POSITION_FOR(0:MAX_BC_CLASS_NUMBER))
      ALLOCATE(OL_TABLE_POSITION_FOR(0:MAX_OL_CLASS_NUMBER))
         ALLOCATE(ENVIR_CLASS_2_TABLE(0:MAX_CLASS_NUM))
         ALLOCATE(CLASS_EPA_EAS(0:MAX_TABLE_NUM),   &
         ALLOCATE(CLASS_NET_ANN_EMIS(NUMBER_OF_EMISSION_TYPES),   &
         ALLOCATE(TRANS_ROR_CAPACITY(0:R_NUMBER_OF_TRANS_GROUPS))
         ALLOCATE(TRANS_PEAK_CAPACITY(0:R_NUMBER_OF_TRANS_GROUPS))
         ALLOCATE(TRANS_PUMP_CAPACITY(0:R_NUMBER_OF_TRANS_GROUPS))
            ALLOCATE( &
            ALLOCATE(MON_MDS_EL_ENERGY(HYDRO_UNITS,2,0:12))
            ALLOCATE(MON_MDS_EL_CAPACITY(HYDRO_UNITS,2,0:12))
            ALLOCATE(MON_MDS_EL_VAR_COST(HYDRO_UNITS,2,0:12))
            ALLOCATE(MON_MDS_EL_FIXED_COST(HYDRO_UNITS,2,0:12))
            ALLOCATE(MON_MDS_EL_SO2_EMIS(HYDRO_UNITS,2,0:12))
            ALLOCATE(MON_MDS_EL_MARKET_REVENUE(HYDRO_UNITS,2,0:12))
            ALLOCATE(ANNUAL_EL_ENERGY(HYDRO_UNITS,2))
            ALLOCATE(ANNUAL_EL_CAPACITY(HYDRO_UNITS,2))
            ALLOCATE(ANNUAL_EL_VAR_COST(HYDRO_UNITS,2))
            ALLOCATE(ANNUAL_EL_FIXED_COST(HYDRO_UNITS,2))
            ALLOCATE(ANNUAL_EL_SO2_EMIS(HYDRO_UNITS,2))
            ALLOCATE(MONTHLY_EL_GROUP_REPORT(0:12,0:MAX_MONTHLY_GROUPS, &
               ALLOCATE(FISCAL_EL_ENERGY(HYDRO_UNITS,2))
               ALLOCATE(FISCAL_EL_CAPACITY(HYDRO_UNITS,2))
               ALLOCATE(FISCAL_EL_VAR_COST(HYDRO_UNITS,2))
               ALLOCATE(FISCAL_EL_FIXED_COST(HYDRO_UNITS,2))
               ALLOCATE(FISCAL_EL_SO2_EMIS(HYDRO_UNITS,2))
               ALLOCATE(FISCAL_EL_MARKET_REVENUE(HYDRO_UNITS,2))
         ALLOCATE(ASSET_CLASS_NUM(MAX_EL_UNITS))
         ALLOCATE(INTRA_COMPANY_CLASS_ID(MAX_EL_UNITS))
         ALLOCATE(ASSET_CLASS_VECTOR(MAX_EL_UNITS))
            ALLOCATE(ASSET_CLASS_POINTER(MAX_HYDRO_CLASS_NUM))
         ALLOCATE(EL_ANN_CLASS_VAR_COST(0:NUM_OF_HYDRO_CLASSES,4))
         ALLOCATE(EL_ANN_CLASS_FIXED_COST(0:NUM_OF_HYDRO_CLASSES,4))
         ALLOCATE(EL_ANN_CLASS_REVENUE(0:NUM_OF_HYDRO_CLASSES,4))
         ALLOCATE(EL_ANN_CLASS_CAPACITY(0:NUM_OF_HYDRO_CLASSES,4))
         ALLOCATE(EL_ANN_CLASS_ENERGY(0:NUM_OF_HYDRO_CLASSES,4))
         ALLOCATE(EL_ANN_CLASS_SELL_CAPACITY(0:NUM_OF_HYDRO_CLASSES,4))
         ALLOCATE(EL_ANN_CLASS_SELL_ENERGY(0:NUM_OF_HYDRO_CLASSES,4))
         ALLOCATE(EL_ANN_CLASS_PURCHASES(0:NUM_OF_HYDRO_CLASSES,4))
         ALLOCATE(EL_ANN_CLASS_SO2(0:NUM_OF_HYDRO_CLASSES))
         ALLOCATE(INTRA_COMPANY_SALES_REVENUE(0:1024))
         ALLOCATE(INTRA_COMPANY_PURCHASE_EXPENSE(0:1024))
         ALLOCATE(EL_ANN_CLASS_MARKET_REVENUES(0:NUM_OF_HYDRO_CLASSES))
         ALLOCATE(EL_ANN_CLASS_MARKET_PURCHASE(0:NUM_OF_HYDRO_CLASSES))
         ALLOCATE(EL_MON_MDS_VAR_COST(0:NUM_OF_HYDRO_CLASSES,4,0:12))
         ALLOCATE(EL_MON_MDS_FIXED_COST(0:NUM_OF_HYDRO_CLASSES,4,0:12))
         ALLOCATE(EL_MON_MDS_REVENUE(0:NUM_OF_HYDRO_CLASSES,4,0:12))
         ALLOCATE(EL_MON_MDS_CAPACITY(0:NUM_OF_HYDRO_CLASSES,4,0:12))
         ALLOCATE(EL_MON_MDS_ENERGY(0:NUM_OF_HYDRO_CLASSES,4,0:12))
         ALLOCATE(EL_MON_MDS_SELL_CAPACITY( &
         ALLOCATE(EL_MON_MDS_SELL_ENERGY(0:NUM_OF_HYDRO_CLASSES,4,0:12))
         ALLOCATE(EL_MON_MDS_PURCHASES(0:NUM_OF_HYDRO_CLASSES,4,0:12))
         ALLOCATE(EL_MON_MDS_SO2(0:NUM_OF_HYDRO_CLASSES,0:12))
         ALLOCATE(MON_MDS_INCO_SALES_REVENUE(0:1024,0:12))
         ALLOCATE(MON_MDS_INCO_PURCHASE_EXPENSE(0:1024,0:12))
         ALLOCATE(MON_MDS_IN_SALES_REVENUE(0:12))
         ALLOCATE(MON_MDS_IN_PURCHASE_EXPENSES(0:12))
         ALLOCATE(MON_MDS_IN_VARIABLE_EXPENSES(0:12))
         ALLOCATE(MON_MDS_IN_FIXED_EXPENSES(0:12))
         ALLOCATE(EL_MON_MDS_MARKET_REVENUES( &
         ALLOCATE(EL_MON_MDS_MARKET_PURCHASE( &
         ALLOCATE(ASSET_CLASS_LIST(AVAIL_DATA_YEARS))
         ALLOCATE(ASSET_ALLOCATION_LIST(AVAIL_DATA_YEARS))
            ALLOCATE(CLASS_NAME(0:MAX_CLASS_NUM))
      ALLOCATE(SORT_POS(LOAD_HOURS_IN_PERIOD))
         ALLOCATE(HOURLY_HYDRO(LOAD_HOURS_IN_PERIOD, &
         ALLOCATE(I4_VECTOR_MAP(-1:MAX_VECTOR_NUM),VECTOR_VALUES(AVAIL_DATA_YEARS+1,-1:MAX_VECTORS),I4_REFERENCE_VECTOR_MAP(0:9), &
         ALLOCATE(ACTIVE_VECTOR_VALUES(-1:MAXIMUM_VECTORS))
        allocate(iOfFacAlgs(nVr),stat=AS)
        allocate(x         (nVr),stat=AS)
        allocate(cOrg      (nVr),stat=AS)
        allocate(cMod      (nVr),stat=AS)
        allocate(GLB       (nVr),stat=AS)
        allocate(LUB       (nVr),stat=AS)
        allocate(Capacity  (nVr),stat=AS)
        allocate(EquivAvail(nVr),stat=AS)
        allocate(UnitOwning(nVr),stat=AS)
        allocate(BlockPos  (nVr),stat=AS)
        allocate(AuxRow    (nVr),stat=AS)
        allocate(AuxCycled (nVr),stat=AS)
        allocate(AuxiCovers(nVr),stat=AS)
        allocate(BlockOfSameUnitAs(nVr,2),stat=AS)
        allocate(VarOfDispRank(nVr),stat=AS)
        allocate(AuxRHS    (nAux),stat=AS)
        allocate(AuxCovers (nAux,nVrAux),stat=AS)
        allocate(AColumn   (nAux,nVrAux),stat=AS) ! data varies 1st across rows
        allocate(PrevState(nVar),stat=AS)
        allocate(VarState(nVar),stat=AS)
        allocate(PrevBDIRow(nVar),stat=AS)
        allocate(BasisDIRow(nVar),stat=AS)
        allocate(PrevBKyVar(nVar),stat=AS)
        allocate(BasisKyVar(nVar),stat=AS)
        allocate(FctOwning(nVar),stat=AS)
        allocate(KeyVar(nVar),stat=AS)
        allocate(d(nVar),stat=AS)
        allocate(Phi(nVar),stat=AS)
        allocate(DualVar(nVar),stat=AS)
        allocate(BkOwns(nVar),stat=AS)
        allocate(BindSetOwns(nVar),stat=AS)
        allocate(TestSetOwns(nVar),stat=AS)
        allocate(WouldBeZero(nVar),stat=AS)
        allocate(VarInFctOrder(nVar),stat=AS)
        allocate(VFOFirstInFct(0:nVar),stat=AS) ! 0 allows room for InvalidFacet
          allocate(BNKinRow(nAux),stat=AS)
          allocate(AuxDualMult(nAux),stat=AS)
          allocate(AuxColumn(nAux),stat=AS)
          allocate(DColumn(nAux,nAux),stat=AS)
          allocate(DOrgRow(nAux,nAux),stat=AS)
          allocate(DInvRow(nAux,nAux),stat=AS)
          allocate(VarCumul(nKappa,-1:nVar),stat=AS)
        allocate(AuxCoeff(nVarUB),stat=AS)
        allocate(CFLB    (nVarUB),stat=AS)
        allocate(CFUB    (nVarUB),stat=AS)
        allocate(BlockDispCost(NUNITS,2),stat=AS)
        allocate(BlockHeatRate(NUNITS,2),stat=AS)
        allocate(ArrayOld(nRows,nRows),stat=AS)
          allocate(jMarginal(LimUnknowns),stat=AS) ! need to count even if FctVoidOfDj
          allocate(GrayOrder(0:SupiGr),stat=AS)
                  allocate(HoldOrder(0:SupiGr),stat=AS)
                  allocate(GrayOrder(0:SupiGr),stat=AS)
            ALLOCATE(FUEL_PRICE(0:AVAIL_DATA_YEARS))
            ALLOCATE(WRITE_FUEL_PRICE(0:AVAIL_DATA_YEARS))
      ALLOCATE(FUEL_PRICE(0:AVAIL_DATA_YEARS))
      ALLOCATE( P_EMIS_REPORT(MAX_EMISSION_REPORT_GROUPS,NUNITS))
      ALLOCATE( S_EMIS_REPORT(MAX_EMISSION_REPORT_GROUPS,NUNITS))
      ALLOCATE( EMISS_FUEL_EMIS_REPORT(MAX_EMISSION_REPORT_GROUPS,NUNITS))
      ALLOCATE(POINTR_RECORD(0:1024),STAT=ERROR) ! SAVE POINTR_RECORD
      ALLOCATE(EMISSION_RATES(0:R_RECORDS,TOTAL_EMISSION_GROUPS)) ! SAVE POINTR_RECORD
            ALLOCATE(FAMILY_NAMES(NUMBER_OF_DEFINITIONS),OVERLAY_FILES_IN_FAMILY(NUMBER_OF_DATA_FILES,NUMBER_OF_DEFINITIONS),   &
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024), &
            ALLOCATE(BC_NUC_FUEL_CLASS_POINTER(MAX_BC_NUC_FUEL_ID_NUM))
      ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024), &
         ALLOCATE(OL_NUC_FUEL_CLASS_POINTER(MAX_OL_NUC_FUEL_ID_NUM))
      ALLOCATE(FIRST_YEARS_VEC(AVAIL_DATA_YEARS), &
      ALLOCATE(NFCE(MAX_FINANCIAL_SIMULATION_YEARS), &
      ALLOCATE(NFIS(FINANCIAL_SIMULATION_YEARS), &
      ALLOCATE(ASSET_CLASS_LIST(AVAIL_DATA_YEARS), &
      ALLOCATE( &
         ALLOCATE(ID_POINTER(0:10000), &
            ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
         ALLOCATE(TNNFV(FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(FUEL_INVENTORY_IS_MONTHLY(0:MAX_FUEL_INV_SERIES))
      ALLOCATE(ANNUAL_FILE_POINTR(0:MAX_FUEL_INV_SERIES))
      ALLOCATE(MONTHLY_FILE_POINTR(0:MAX_FUEL_INV_SERIES))
      ALLOCATE(MMBTU_BALANCE_POINTR(MAXIMUM_FUEL_TYPES))
      ALLOCATE(PREVIOUS_ANNUAL_AMOUNT(0:AVAIL_DATA_YEARS))
      ALLOCATE(ANNUAL_AMOUNT(0:AVAIL_DATA_YEARS))
      ALLOCATE(MONTHLY_AMOUNT(0:AVAIL_DATA_YEARS))
      ALLOCATE(FIRST_TIME_FOR_THIS_MONTHLY(12,0:MAX_FUEL_INV_SERIES))
      ALLOCATE(FUEL_INVENTORY_IS_ANNUAL(0:MAX_FUEL_INV_SERIES))
      ALLOCATE(FIRST_TIME_FOR_THIS(0:MAX_FUEL_PRICE_SERIES),STAT=ERROR)
      ALLOCATE (NEW_FUEL_PRICE &
         ALLOCATE(FUEL_PRICE_POINTR(0:MAX_FUEL_PRICE_SERIES),STAT=ERROR)
      ALLOCATE(FUEL_PRICE(0:FUEL_PRICE_YEARS))
         ALLOCATE(P_BTU_COST_POINTR(NUNITS))
         ALLOCATE(P_BTU_CONTENT(NUNITS))
         ALLOCATE(S_BTU_CONTENT(NUNITS))
         ALLOCATE(E_BTU_CONTENT(NUNITS))
         ALLOCATE(P_SHIPPING_UNITS(NUNITS))
         ALLOCATE(S_SHIPPING_UNITS(NUNITS))
         ALLOCATE(E_SHIPPING_UNITS(NUNITS))
         ALLOCATE(S_BTU_COST_POINTR(NUNITS))
         ALLOCATE(E_BTU_COST_POINTR(NUNITS))
         ALLOCATE(P_BTU_COST_IS_A_POINTR(NUNITS))
         ALLOCATE(S_BTU_COST_IS_A_POINTR(NUNITS))
         ALLOCATE(E_BTU_COST_IS_A_POINTR(NUNITS))
         ALLOCATE(PRIMARY_DELIVERY_COST(R_UNIT))
         ALLOCATE(SECONDARY_DELIVERY_COST(R_UNIT))
               ALLOCATE(SAVED_CL_ANN_CAP(3,STUDY_PERIOD,2))
              ALLOCATE(SAVED_CL_TG_CAP(0:6,&
              ALLOCATE(GRX_BOP_RETROFIT_ACTIVE(MAX_CL_UNITS))
           ALLOCATE(GRX_ITER_CO2_PRICE(0:GRX_MAX_ITERS,0:TG_MAX))
           ALLOCATE(GRX_ITER_TG_CO2_EMISS(0:GRX_MAX_ITERS,0:TG_MAX))
           ALLOCATE(GRX_CO2_EMISS_REDUCT_REQUIRED(0:TG_MAX))
              ALLOCATE(GRX_ITER_CO2_PRICE(0:GRX_MAX_ITERS,0:TG_MAX))
              ALLOCATE(GRX_ITER_TG_CO2_EMISS(0:GRX_MAX_ITERS,0:TG_MAX))
              ALLOCATE(GRX_CO2_EMISS_REDUCT_REQUIRED(0:TG_MAX))
            ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024),SBU_LINKED_COUNTER(1024),BC_CLASS_LINKAGE(0:1024), &
               ALLOCATE(BC_INIT_CLASS_POINTER(MAX_BC_INIT_CLASS_ID_NUM))
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024),SBU_LINKED_COUNTER(1024),OL_CLASS_LINKAGE(0:1024), &
            ALLOCATE(OL_INIT_CLASS_POINTER(MAX_OL_INIT_CLASS_ID_NUM))
        allocate(BMatrix(0:mSup,0:mSup)    ,stat=AS)
        allocate(BMatInv(0:mSup,0:mSup)    ,stat=AS)
        allocate(SwapVector (0:mSup)       ,stat=AS)
        allocate(Phi(0:mSup)               ,stat=AS)
        allocate(yj (0:mSup)               ,stat=AS)
        allocate(yk (0:mSup)               ,stat=AS)
        allocate(z_c(0:nSup)               ,stat=AS)
        allocate(zStar_c(0:nSup)           ,stat=AS)
        allocate(zOrg_c(0:nSup)            ,stat=AS)
        allocate(GMatrix(0:siRank,0:siRank),stat=AS)
        allocate(GMatLUF(0:siRank,0:siRank),stat=AS)
        allocate(UpperBounded(0:nSup)    ,stat=AS)
        allocate(SymmetricLimits(0:nSup) ,stat=AS)
        allocate(LineEnd(0:1,0:siLine)   ,stat=AS)
        allocate(BasisCol(0:mSup)        ,stat=AS)
        allocate(BasisPos(0:nSup)        ,stat=AS)
        allocate(b(0:siCons)             ,stat=AS)
        allocate(c(0:nSup)               ,stat=AS)
        allocate(UB(0:nSup)              ,stat=AS)
        allocate(xB(0:mSup)              ,stat=AS)
        allocate(ConstrtRow(0:nSup)      ,stat=AS)
        allocate(yLine(0:siLine)         ,stat=AS)
        allocate(ej(0:mSup)              ,stat=AS)
        allocate(ConsRHS(0:siCons)       ,stat=AS)
        allocate(SegWeight(0:nSup)       ,stat=AS)
        allocate(CurrLimit(0:1,0:siLine) ,stat=AS)
        allocate(AMatrix(0:siCons,0:nSup),stat=AS)
        allocate(LineName(0:siLine)      ,stat=AS)
        allocate(cB(0:mSup)           ,stat=AS)
        allocate(NodeVoltage(0:siNode),stat=AS)
        allocate(NodeCurrent(0:siNode),stat=AS)
          allocate(BMatLUF(0:mSup,0:mSup),stat=AS)
          allocate(PivotRow      (0:mSup),stat=AS)
          allocate(SupMagInRow   (0:mSup),stat=AS)
               ALLOCATE(CUM_UNIT_UTIL(TRANS_GROUP_POINTS, &
               ALLOCATE(CURRENT_UNIT_UTIL(TRANS_GROUP_POINTS, &
               ALLOCATE(TOT_EMBED_COST_BY_POINT(TRANS_GROUP_POINTS, &
               ALLOCATE(CUM_UNIT_UTIL_zero(TRANS_GROUP_POINTS, &
               ALLOCATE(CURRENT_UNIT_UTIL_zero(TRANS_GROUP_POINTS, &
               ALLOCATE(BlockIncrCost(BLOK_ARRAY_ALLOCATOR))
               ALLOCATE(COST_CURVE_POINTER_BY(0:BLOK_ARRAY_ALLOCATOR, &
               ALLOCATE( &
            ALLOCATE(DEPTH_PRICE(DEPTH_MARKET_INTERVALS,24))
               ALLOCATE(TRANS_DEPTH_PRICE( &
         ALLOCATE ( &
         ALLOCATE(NEW_MARGINAL_DATA_BASE(TRANS_GROUP_POINTS, &
         ALLOCATE(LODDUR_FOR_MC(0:1000,MAX_DATA_BASES))
         ALLOCATE(LPROB_FOR_MC(0:1000,2,MAX_DATA_BASES))
         ALLOCATE(ACTIVE_UNIT(NUNITS))
         ALLOCATE(START_UP_POSITION(NUNITS,SAVE_UPPER_TRANS_GROUP))
         ALLOCATE(SCARCITY_MULT(SAVE_UPPER_TRANS_GROUP,2))
         ALLOCATE(SALES_B4_AFTER(0:TRANS_GROUP_POINTS,2,MAX_DATA_BASES))
         ALLOCATE(WHOLESALE_REV_AND_EXP(TRANS_GROUP_POINTS,2, &
         ALLOCATE(WHOLESALE_SAL_AND_PUR(TRANS_GROUP_POINTS,2, &
         ALLOCATE(RETAIL_REV_AND_EXP(TRANS_GROUP_POINTS,2, &
         ALLOCATE(RETAIL_SAL_AND_PUR(TRANS_GROUP_POINTS,2, &
         ALLOCATE(NEW_POINT_COUNT(TRANS_GROUP_POINTS,MAX_DATA_BASES))
         ALLOCATE(NEW_LODDUR(TRANS_GROUP_POINTS,MAX_DATA_BASES))
         ALLOCATE(EXPECTED_MARGINAL_COST(TRANS_GROUP_POINTS, &
         ALLOCATE(TRANSITION_MARGINAL_COST(TRANS_GROUP_POINTS, &
         ALLOCATE(CAPACITY_GIVEN_MARKET(TRANS_GROUP_POINTS, &
         ALLOCATE(BLOCK_B4_MARKET(TRANS_GROUP_POINTS,MAX_DATA_BASES))
         ALLOCATE(REMAINING_CONTRIBUTION_MW(TRANS_GROUP_POINTS, &
         ALLOCATE( &
         ALLOCATE(CUM_CAP(MAX_DATA_BASES))
         ALLOCATE(LAST_DB_POINT(MAX_DATA_BASES))
         ALLOCATE(CumDbDx(MAX_DATA_BASES))
         ALLOCATE(DB_ADJ_TOTAL_CAP(MAX_DATA_BASES))
         ALLOCATE(DB_CAP_AFTER_OUTAGES(MAX_DATA_BASES))
         ALLOCATE(DB_DX(MAX_DATA_BASES))
         ALLOCATE(PREVIOUS_INTERVAL(MAX_DATA_BASES))
         ALLOCATE(I_CORRECT(MAX_DATA_BASES))
         ALLOCATE(ACTIVE_DATA_BASE(MAX_DATA_BASES))
         ALLOCATE(DETAILED_OUTAGE_DATA_BASE(MAX_DATA_BASES))
         ALLOCATE(CURRENT(MAX_DATA_BASES))
         ALLOCATE(NEXT(MAX_DATA_BASES))
         ALLOCATE(POS(MAX_DATA_BASES))
         ALLOCATE(NATIVE_POS(MAX_DATA_BASES))
         ALLOCATE(CUM_COST(MAX_DATA_BASES))
         ALLOCATE(CUM_PROB(MAX_DATA_BASES))
         ALLOCATE(SAVE_LOAD(MAX_DATA_BASES))
         ALLOCATE(NATIVE_POS_PERCENT(MAX_DATA_BASES))
         ALLOCATE(CUM_SALES_AFTER(MAX_DATA_BASES))
         ALLOCATE(CUM_MUST_RUN_MW(MAX_DATA_BASES))
         ALLOCATE(CUM_MUST_RUN_POSITION(MAX_DATA_BASES))
         ALLOCATE(UNIT_ENERGY_B4_AFTER(BLOK_ARRAY_ALLOCATOR,2, &
      ALLOCATE(UNIT_SAVE(NBLOK2),BLKNO_SAVE(NBLOK2)) ! 11/28/00.
      ALLOCATE(UNIT_DISP_COST(NUNITS,2),BLOCK_DISP_COST(NBLOK2))
      ALLOCATE(SAVE_TRANS_FOR_DATA_BASE(MAX_DATA_BASES))
      ALLOCATE(OUTAGE_UNIT_INDEX(0:DATA_BASIS))
      ALLOCATE(OUTAGE_BLOCK_INDEX(0:DATA_BASIS))
      ALLOCATE(TRANS_BLOCK_CAPACITY(0:DATA_BASIS))
      ALLOCATE(CUM_TC_UNIT_MWH(NUNITS))
      ALLOCATE(FIRST_ECONOMY_COST(MAX_DATA_BASES))
      ALLOCATE(MUST_RUN_COST(MAX_DATA_BASES))
      ALLOCATE(MW_AFTER_OUTAGES(NBLOK2,MAX_DATA_BASES))
      ALLOCATE(MW_DIFF(0:NBLOK2,MAX_DATA_BASES))
      ALLOCATE(START_UP_UNIT_BY_TG(SAVE_UPPER_TRANS_GROUP))
      ALLOCATE(MARGINAL_UNIT_BY_TECH(SAVE_UPPER_TRANS_GROUP, &
      ALLOCATE(OUTAGE_DB_USED(MAX_TRANS_GROUP_NUMBER))
      ALLOCATE(COMMITMENT_DB(MAX_TRANS_GROUP_NUMBER))
                  ALLOCATE(TEMP_TRANSFER_ARRAY1(0:ALLOCATED_DATA_BASES))
                  ALLOCATE(TEMP_TRANSFER_ARRAY2(0:ALLOCATED_DATA_BASES))
                  ALLOCATE(TEMP_TRANSFER_ARRAY3(0:ALLOCATED_DATA_BASES))
                  ALLOCATE( &
                  ALLOCATE( &
                  ALLOCATE( &
      ALLOCATE(OUTAGE_SINGULAR(0:SAVE_OUTAGE_BLOCKS))
      ALLOCATE(ADJUST_BLOCK(0:SAVE_OUTAGE_BLOCKS))
      ALLOCATE(DERATE_BLOCK(0:SAVE_OUTAGE_BLOCKS))
      ALLOCATE(OUTAGE_TYPE(0:SAVE_OUTAGE_BLOCKS))
         ALLOCATE(HOURLY_OUTAGE_STATE(NBLOK2,SAVE_HOURS_IN_MONTH))
         ALLOCATE(HOURLY_OUTAGE_TYPE(NBLOK2,SAVE_HOURS_IN_MONTH))
         ALLOCATE(HOURLY_LAST_STATE(NBLOK2))
         ALLOCATE(HOURLY_LAST_DERATE(NBLOK2))
         ALLOCATE(HOURLY_LAST_TYPE(NBLOK2))
            ALLOCATE(OUTAGE_ENERGY(SAVE_OUTAGE_BLOCKS))
            ALLOCATE(OUTAGE_WHOLESALE_ENERGY(SAVE_OUTAGE_BLOCKS,2))
            ALLOCATE(OUTAGE_WHOLESALE_REVENUE(SAVE_OUTAGE_BLOCKS,2))
      ALLOCATE(SORT_POS(LOAD_HOURS_IN_PERIOD), &
      allocate(a_temp_array(0:nUnique),b_temp_array(0:nUnique))
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
            ALLOCATE(ADDENDUM_BC_ASSET_CLASS_POINTER(MAX_BC_ADDENDUM_CLASS_ID_NUM))
      ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
         ALLOCATE(ADDENDUM_OL_ASSET_CLASS_POINTER(MAX_OL_ADDENDUM_CLASS_ID_NUM))
      ALLOCATE(ESCALATION_RATES(AVAIL_DATA_YEARS),ADDENDUM_VALUES(0:MAX(FINANCIAL_SIMULATION_YEARS,AVAIL_DATA_YEARS)), &
            ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
         ALLOCATE(PAYMENTS(0:12,0:FINANCIAL_SIMULATION_YEARS,-1:NUM_OF_ASSET_CLASSES,LAST_PAYMENT_ITEM), &
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
            ALLOCATE(DEBIT_BC_ASSET_CLASS_POINTER(MAX_BC_DEBIT_CLASS_ID_NUM))
      ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
         ALLOCATE(DEBIT_OL_ASSET_CLASS_POINTER(MAX_OL_DEBIT_CLASS_ID_NUM))
      ALLOCATE(ASSET_CLASS_LIST(AVAIL_DATA_YEARS), &
         ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
      ALLOCATE(TDDB(0:12,0:FINANCIAL_SIMULATION_YEARS,0:NUM_OF_ASSET_CLASSES,0:BAL_SHEET_OPTIONS,UNIQUE_ACCT_TYPE), &
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
            ALLOCATE(BC_EXISTING_ASSET_CLASS_POINTER &
      ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
         ALLOCATE(OL_EXISTING_ASSET_CLASS_POINTER &
      ALLOCATE(BOKDP(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(GPV(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(CUM_BOOK_DEP(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(NPV(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(RETIRE(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(TAXDP(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(BOKTAX(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(ASSET_DEFERRED_TAXES(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(ASSET_DEFERRED_TAX_BASIS(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_BOOK_DEP_VECTOR_ADDER(0:12, &
         ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
      ALLOCATE(TRETIE(0:12,FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(TBOKDP(0:12,FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(TGPV(0:12,FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(CUMULATIVE_BOOK_DEP(0:12,FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(TOTAL_NPV_RATEBASE(0:12,FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(TTAXDP(FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(PROPERTY_TAX_GPV(FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(PROPERTY_TAX_NPV(FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(EATAXBOKDEP(FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(EANORMTAXDP(FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(EA_DEF_TAX(FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(EA_DEF_TAX_BASIS(FINANCIAL_SIMULATION_YEARS, &
      ALLOCATE(TOTAL_DEF_TAX_RATEBASE(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(EA_ACE_DEPRECIATION(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(TOTAL_DEF_TAX_BASIS_RATEBASE(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(ASSET_CLASS_LIST(AVAIL_DATA_YEARS))
      ALLOCATE(ASSET_ALLOCATION_LIST(AVAIL_DATA_YEARS))
      ALLOCATE(READ_EXPEN(0:AVAIL_DATA_YEARS))
      ALLOCATE(EXPENSES(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MIDAS_ANNUAL_CASH(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(ACCOUNT_PAYABLE_VALUES(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(OUTPUT_VALUE(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(ALLOC_EXPEN(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(ALLOC_CASH_EXPEN(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(ASSET_CLASS_LIST(AVAIL_DATA_YEARS))
      ALLOCATE(ASSET_ALLOCATION_LIST(AVAIL_DATA_YEARS))
            ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
         ALLOCATE(EXPENSES_MONTHLY(0:12,0:FINANCIAL_SIMULATION_YEARS, &
         ALLOCATE(BUDGET_EXPENSE(0:12,0:FINANCIAL_SIMULATION_YEARS,10))
         ALLOCATE(REVENUES_MONTHLY(0:12,0:FINANCIAL_SIMULATION_YEARS, &
         ALLOCATE(SECONDARY_SALES_NOT_IN_RATES(0:12, &
         ALLOCATE(OTHER_REVENUES_NOT_IN_RATES(0:12, &
         ALLOCATE(CASH_MONTHLY(0:12, &
         ALLOCATE(CASH_REV_EXP_MONTHLY(0:12, &
         ALLOCATE(ANNUAL_CASH_ROLL_OVER(1:12,CASH_VARS, &
      ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
         ALLOCATE(BC_FA_CLASS_POINTER(MAX_BC_CLASS_ID_NUM))
      ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
         ALLOCATE(OL_FA_CLASS_POINTER(MAX_OL_CLASS_ID_NUM))
         ALLOCATE(CEP(MAX_FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(CE(MAX_FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(ESCALATION_RATES(AVAIL_DATA_YEARS))
         ALLOCATE(CEP(MAX_FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(CE(MAX_FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(ESCALATION_RATES(AVAIL_DATA_YEARS))
            ALLOCATE(TEMP_HOLDING_ARRAY(MAX_FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(CEPTXBOK(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(TOTAL_BKDPTX(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(CURRENT_INTEREST_CAP(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(PCAPINRST(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(TAXDPALT(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(CAPINRST(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(TXPREFDEP(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(BOOK_VALUE(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(ACE_BOOK_DEP(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(TAX_VALUE_BEGINNING_90(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(DUMMY(FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(BOOK_EXPEN(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(CASH_OM_ADDER(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(NON_CASH_OM_ADDER(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(PLANT_2_SERVICE(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(PERCENT_PLANT_2_SERVICE(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_AFUDC_ON_CASH(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_AFUDC_ON_PLANT(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_CWIP(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_AFUDC_IN_CWIP(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_CWIP_IN_RATEBASE(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_CAPITALIZED_INTEREST(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_CURRENT_INTEREST(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(CASH_EXPENDITURES(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_INTEREST_TO_TAX_VALUE(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_TAX_VALUE_OF_ASSET(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(BONUS_DEP_MONTHLY_2001(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_TAX_DEP_PREFERENCE(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_TAX_DEPRECIATION_ALT(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_TAX_BOOK_DEP(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_ACE_BOOK_DEP(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(DUMMY_MONTHLY_ARRAY(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_TAX_DEPRECIATION(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_DEFERRED_TAX_BASIS(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_TAX_EXPENSE(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_CURRENT_INTEREST_CAP(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(MONTHLY_BOOK_DEP(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(CUM_BOOK_DEP(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(GPV(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(NPV(0:12,0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(TEMP_PLANT_2_SERVICE(0:FINANCIAL_SIMULATION_YEARS))
      ALLOCATE(VECTOR_DATA_CASH(AVAIL_DATA_YEARS))
      ALLOCATE(VECTOR_DATA_PLNT(AVAIL_DATA_YEARS))
      ALLOCATE(VECTOR_DATA(AVAIL_DATA_YEARS))
            ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
         ALLOCATE(TCE(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TCEP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(CLASS_GPV(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(CLASS_CUMULATIVE_DEPRECIATION(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(CLASS_AFUDC_IN_CWIP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TTAXDP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TBOKDP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFCDP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFDC1(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFDC2(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TCWIP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TRBCWP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TITCDP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TITCDF(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TTXEXP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TTXDEF(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TDDB(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TRBDDB(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAMRTE(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TEXEXP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFDPA(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TCEPTX(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFCAJ(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TBKDPT(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TITCPY(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFEXP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TBKDPA(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TPCAPINRST(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TTXPREFDEP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TOTAL_ACE_BOOK_DEP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFDCB(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TWODFT(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFDCF(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(PROPERTY_TAX_GPV(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(PROPERTY_TAX_NPV(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(RB_NPV(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RB_TAXDP(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RB_BOKDP(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RB_PCAPINRST(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RBCWIP_AFDC_METH2(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RB_TXEXP(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RB_TXDEF(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RB_TXPREFDEP(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RB_AMRTE(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RB_ITCPY(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RB_ITC(FINANCIAL_SIMULATION_YEARS))
         ALLOCATE(RB_AFDC1(FINANCIAL_SIMULATION_YEARS))
            ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
         ALLOCATE(TCE(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TCEP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(CLASS_GPV(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(CLASS_CUMULATIVE_DEPRECIATION(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(CLASS_AFUDC_IN_CWIP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TTAXDP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TBOKDP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFCDP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFDC1(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFDC2(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TCWIP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TRBCWP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TITCDP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TITCDF(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TTXEXP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TTXDEF(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TDDB(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TRBDDB(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAMRTE(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TEXEXP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFDPA(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TCEPTX(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFCAJ(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TBKDPT(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TITCPY(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFEXP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TBKDPA(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TPCAPINRST(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TTXPREFDEP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TOTAL_ACE_BOOK_DEP(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFDCB(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TWODFT(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(TAFDCF(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(PROPERTY_TAX_GPV(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(PROPERTY_TAX_NPV(FINANCIAL_SIMULATION_YEARS,0:NUM_OF_FA_CLASSES))
         ALLOCATE(RB_NPV(FINANCIAL_SIMULATION_YEARS), &
            ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
            ALLOCATE(TOTAL_MONTHLY_FA_VALUES(0:12, &
         ALLOCATE(TEMP_POINTER(0:10000))
            ALLOCATE(BASE_VECTOR_POINTER(0:MAX_BASE_VECTOR_NUM))
      ALLOCATE(TEMP_POINTER(0:10000))
         ALLOCATE(OVLY_VECTOR_POINTER(0:MAX_OVERLAY_VECTOR_NUM))
         ALLOCATE(TEMP_POINTER(0:10000))
            ALLOCATE(BASE_VECTOR_POINTER(0:MAX_BASE_VECTOR_NUM))
      ALLOCATE(TEMP_POINTER(0:10000))
         ALLOCATE(OVLY_VECTOR_POINTER(0:MAX_OVERLAY_VECTOR_NUM))
         ALLOCATE(FILE_PAYABLE_VALUES(12,5,PAYMENT_VARS, &
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
            ALLOCATE(BC_ASSET_CLASS_POINTER(MAX_BC_CLASS_ID_NUM))
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
            ALLOCATE(OL_ASSET_CLASS_POINTER(MAX_OL_CLASS_ID_NUM))
            ALLOCATE(ASSET_CLASS_LIST(AVAIL_DATA_YEARS), &
               ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
            ALLOCATE(REVENUES_MONTHLY(0:12,-1:NUM_OF_ASSET_CLASSES,LAST_INCOME_LINE), &
            ALLOCATE(ASSET_CLASS_CUSTOMERS(0:12,-1:NUM_OF_ASSET_CLASSES))
            ALLOCATE(ASSET_CLASS_ENERGY(0:12,-1:NUM_OF_ASSET_CLASSES))
            ALLOCATE(STATE_RPS_DB(13,600,0:12), &
               ALLOCATE(ANN_RPS_INTRA_REGION_SURPLUS(0:6,0:RPS_REGION_COUNT))
            ALLOCATE( &
         ALLOCATE(TRANS_GROUP_POSITION(-1:MAX_GAS_GROUP_NUMBER), &
         ALLOCATE(RESOURCES_PER_TYPE(MAX_STATES),RPS_RESOURCES_INDEX(R_RESOURCE_NUM))
         ALLOCATE(RPS_SUPPLY_CURVES( &
         ALLOCATE(RPS_NET_REV(NUM_RPS_RESOURCES), &
            ALLOCATE(CO2_Emission_Cap(YR1_DATA:YR2_DATA),Residential_Emissions(YR1_DATA:YR2_DATA), &
         ALLOCATE(      Initial_Bank(NUM_RPS_PROGRAMS), &
            ALLOCATE(PROGRAM_POSITION(MAX_PROGRAM_NUMBER))
         ALLOCATE(REPORTING_VARIABLES(0:NUM_ACTIVE_VARIABLES))
         ALLOCATE(TRANSFR_FUEL_COST_AMOUNT(0:12,NUMBER_OF_COST_CLASSES))
         ALLOCATE(TRANSFR_VAR_COST_AMOUNT(0:12,NUMBER_OF_COST_CLASSES))
         ALLOCATE(TRANSFR_COST_QUANTITIES(0:12,NUMBER_OF_COST_CLASSES))
         ALLOCATE(TRANSFR_COST_CLASS_POINTR(0:MAX_COST_CLASS_NUMBER+1))
         ALLOCATE(TRANSFR_REV_AMOUNT(0:12,NUMBER_OF_REV_CLASSES),TRANSFR_REV_QUANTITIES(0:12,NUMBER_OF_REV_CLASSES), &
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
            ALLOCATE(BC_ASSET_CLASS_POINTER(MAX_BC_CLASS_ID_NUM))
      ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
         ALLOCATE(OL_ASSET_CLASS_POINTER(MAX_OL_CLASS_ID_NUM))
      ALLOCATE(DATA_VALUES(0:AVAIL_DATA_YEARS),ANNUAL_TAX_VALUES(0:FINANCIAL_SIMULATION_YEARS), &
            ALLOCATE(ASSET_CLASS_POINTER(MAX_CLASS_NUM))
         ALLOCATE(TAX_VALUES(FINANCIAL_SIMULATION_YEARS,0:12,-5:NUM_OF_CLASSES,LAST_TAX_ITEM,3))
         ALLOCATE(TAX_VALUES_NOLS(0:15,0:12,-5:NUM_OF_CLASSES,35:40))
         ALLOCATE(ACTUAL_MONTHLY_TAX_VALUES(0:12,FINANCIAL_SIMULATION_YEARS,-1:NUM_OF_CLASSES,LAST_ACTUAL_TAX_ITEM))
         ALLOCATE(ACTUAL_VALUE_FOUND(-1:NUM_OF_CLASSES,LAST_ACTUAL_TAX_ITEM))
            ALLOCATE(ASSET_CLASS_POINTER(BASE_CASE_MAX_CLASS_NUM))
         ALLOCATE(TAX_VALUES(FINANCIAL_SIMULATION_YEARS,0:12,-5:BASE_CASE_NUM_OF_CLASSES,LAST_TAX_ITEM,3))
         ALLOCATE(TAX_VALUES_NOLS(0:15,0:12,-5:BASE_CASE_NUM_OF_CLASSES,35:40))
         ALLOCATE(ACTUAL_MONTHLY_TAX_VALUES(0:12,FINANCIAL_SIMULATION_YEARS,-1:BASE_CASE_NUM_OF_CLASSES,LAST_ACTUAL_TAX_ITEM))
         ALLOCATE(ACTUAL_VALUE_FOUND(-1:BASE_CASE_NUM_OF_CLASSES,LAST_ACTUAL_TAX_ITEM))
         ALLOCATE(FEDERAL_BOOK_LOSSES(-1:YRS,-1:MAX_CLASS_NUM),SEC_42_CREDITS(-1:YRS,-1:MAX_CLASS_NUM), &
            ALLOCATE(ProSymRevAndExps(0:12,BaseStartYr:BaseEndYr, &
      ALLOCATE(ASSET_CLASS_POINTER(MAX_ASSET_CLASS_NUM))
      ALLOCATE(ProSymRevAndExps(0:12,StartYr:EndYr, &
      ALLOCATE(VALUES(DataVariables,StartYr:EndYr))
         ALLOCATE(ResourceList(ResourcesInFile))     
         ALLOCATE(ResourceListIDs(ResourcesInFile))
         ALLOCATE(OPERATION_TYPE(QUE_STACK_POINTR), &
         ALLOCATE(PARTIAL_OBJFUNC_DES(NUM_OF_VARIABLES), &
         ALLOCATE(BC_TABLE_POSITION_FOR(0:MAX_BC_CLASS_NUMBER))
      ALLOCATE(OL_TABLE_POSITION_FOR(0:MAX_OL_CLASS_NUMBER))
         ALLOCATE(MAX_BLOCKS_PER_TRANS(0:UPPER_TRANS_GROUP)) ! 0 IS THE MAX OF ALL GROUPS
      ALLOCATE(BLOCK_DISP_COST(NUNITS,2),SECOND_DISP_COST(NUNITS,2))
      ALLOCATE(SHADOW_DISPATCH_ADDER(NBLOK))
            ALLOCATE(LAMDA_BLK1(BLK1_DISPATCH),BLKNO_BLK1(BLK1_DISPATCH),INHEAT_BLK1(BLK1_DISPATCH),MWBLOK_BLK1(BLK1_DISPATCH), &
            ALLOCATE(LAMDA_BLK2(BLK2_DISPATCH),BLKNO_BLK2(BLK2_DISPATCH),INHEAT_BLK2(BLK2_DISPATCH),MWBLOK_BLK2(BLK2_DISPATCH), &
            ALLOCATE(LAMDA_MR(MUST_RUN_BLOCKS),BLKNO_MR(MUST_RUN_BLOCKS),INHEAT_MR(MUST_RUN_BLOCKS),MWBLOK_MR(MUST_RUN_BLOCKS), &
         allocate(first_blk_used(MAX_CL_UNITS))
            ALLOCATE(PosBLK0(BLK0))
            ALLOCATE(PosBLK1(BLK1))
            ALLOCATE(LAMDA_TEMP(BLK1_DISPATCH))
            ALLOCATE(LAMDA_TEMP(BLK2_DISPATCH))
            ALLOCATE(PosBLK2(BLK2))
            ALLOCATE(SECOND_BLK_PASSED(BLK2))
      ALLOCATE(BLOCK_DISP_COST(NUNITS,2),SECOND_DISP_COST(NUNITS,2))
      ALLOCATE(SHADOW_DISPATCH_ADDER(NBLOK))
      ALLOCATE(PARTIAL_OBJFUNC_DES(50),GROUP_STRING(50),   &
         ALLOCATE(OPERATOR_STACK(0:256),   &
         ALLOCATE(ENERGY(MAX_SIMULATION_YEARS), &
            ALLOCATE(NOX_SEASON_REGION(MAX_TRANS_GROUP_NUMBER), &
         ALLOCATE(BLENDED_BTU_COST(MAX(NUNITS,INT(1,2))))
         ALLOCATE(ANNUAL_BLENDED_BTU_COST(MAX(NUNITS,INT(1,2))))
         ALLOCATE(ANNUAL_FUEL_BTU_COST(MAX(NUNITS,INT(1,2))))
         ALLOCATE(ANNUAL_DISP_BTU_COST(MAX(NUNITS,INT(1,2))))
            ALLOCATE(FIRST_HYDRO_LOAD_NO(0:NUMBER_OF_HYDRO_LOAD_GROUPS), &
      ALLOCATE (RDI_VARIABLE_NAME(NUMBER_OF_RDI_VARIABLES))
         ALLOCATE(MONTHS_PER_PLANT(MAX_RDI_PLANTS), &
      ALLOCATE (RBC_VARIABLE_NAME(NUMBER_OF_RBC_VARIABLES))
         ALLOCATE(MONTHS_PER_PLANT(MAX_RBC_PLANTS))
      ALLOCATE(SERVICE_ASSET_CLASS_POINTER(1024), &
      ALLOCATE(SERVICE_NAME(NUM_SERVICE_TRANS), &
      ALLOCATE(CAPACITY_CHARGE(SERVICE_TRANS), &
            ALLOCATE(ANNUAL_ST_ENERGY(NUMBER_OF_SERVICES), &
            ALLOCATE(MONTHLY_ST_ENERGY(0:12,NUMBER_OF_SERVICES), &
            ALLOCATE(ANNUAL_ST_ENERGY(NUMBER_OF_SERVICES), &
            ALLOCATE(MONTHLY_ST_ENERGY(0:12,NUMBER_OF_SERVICES), &
         ALLOCATE(ST_ANN_CLASS_ATL_EXPENSE(0:12, &
         ALLOCATE(ASSET_CLASS_LIST(AVAIL_DATA_YEARS), &
               ALLOCATE(ANNUAL_COSTS(6,TOTAL_ANNUAL_RECORDS))
               ALLOCATE(TRANS_NAME(NO_OF_TRANS), &
         ALLOCATE (TEMP_CHRONO_LOAD(TEMP_HOURS))
      ALLOCATE (DATA_RECORD(MIN(HELP,OUT_REC_LENGTH-int(4,4))))
               ALLOCATE(TEMP_TRANS_CLASS_POINTER(0:1023), &
            ALLOCATE(TEMP_TRANS_CLASS_POINTER(0:1023), &
             ALLOCATE( &
            ALLOCATE(CUSTOMER_GROUP(MAX_TRANS_LOAD_TABLES)) ! INT2
            ALLOCATE(CUSTOMER_GROUP_2(MAX_TRANS_LOAD_TABLES))
            ALLOCATE( &
            ALLOCATE(SCENARIO_INDEX(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(TRANSACTION_GROUP(MAX_TRANS_LOAD_TABLES)) ! INT2
            ALLOCATE(REFERENCE_LOAD_NUMBER(MAX_TRANS_LOAD_TABLES)) ! INT2
            ALLOCATE(MARKET_ENERGY_PRICE(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(MONTHLY_ENERGY_PRICE_PATTERN( &
            ALLOCATE(MARKET_DEMAND_PRICE(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(MONTHLY_DEMAND_PRICE_PATTERN( &
            ALLOCATE(MARKET_CUSTOMER_PRICE(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(ASSET_CLASS_ID(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(ASSET_CLASS_REV_ALLOC_VECTOR( &
            ALLOCATE(ANNUAL_ENERGY(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(ANNUAL_PEAK(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(ANNUAL_CUSTOMERS(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(ANNUAL_MULTIPLIER(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(MONTHLY_ENERGY(12,MAX_TRANS_LOAD_TABLES)) ! (12) REAL4
            ALLOCATE(MONTHLY_PEAK(12,MAX_TRANS_LOAD_TABLES)) ! (12) REAL4
            ALLOCATE(MONTHLY_CUSTOMERS(12,MAX_TRANS_LOAD_TABLES)) ! (12) REAL4
            ALLOCATE(DIST_ENERGY_LOSS_FACTOR(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(TRANS_ENERGY_LOSS_FACTOR(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(PEAK_LOSS_FACTOR(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(PEAK_COIN_FACTOR(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(DISTRIBUTION_PRICE(MAX_TRANS_LOAD_TABLES)) ! REAL4
            ALLOCATE(TRANSMISSION_PRICE(MAX_TRANS_LOAD_TABLES)) !REAL4!
            ALLOCATE(CUSTOMER_CLASS_NAME(MAX_TRANS_LOAD_TABLES)) ! CHAR*30
            ALLOCATE(CALCULATION_MODE(MAX_TRANS_LOAD_TABLES)) ! CHAR*1
            ALLOCATE(REFERENCE_LOAD_NAME(MAX_TRANS_LOAD_TABLES)) ! CHAR*5
            ALLOCATE(TRANS_MONTHLY_ENERGY(12,MAX_TRANS_LOAD_TABLES))
            ALLOCATE(WH_TRANS_MONTHLY_ENERGY(12, &
            ALLOCATE(WH_TRANS_MONTHLY_CAPACITY(12, &
            ALLOCATE(TRANS_MONTHLY_PEAK(12,MAX_TRANS_LOAD_TABLES))
            ALLOCATE(TRANS_MONTHLY_CUSTOMERS(12,MAX_TRANS_LOAD_TABLES))
            ALLOCATE(TABLE_ACTIVE(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(BASECASE_MARKET_AREA_ID(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(WD_INDEX(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(BASECASE_TRANS_AREA_ID(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(BASECASE_NERC_SUB_ID(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(MONTHLY_UNITS(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(PRICE_INDEX_ACTIVE(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(THREE_FACTOR_TRANSFORM(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(JURISDICTIONAL_CUSTOMER(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(FUEL_COST_RECOVERY_THROUGH_FAC( &
            ALLOCATE(BASE_COST_OF_FAC_FUEL(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(MINIMUM_MARKET_PRICE(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(MAXIMUM_MARKET_PRICE(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(INDEXED_ENERGY_PRICE(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(TG_COUNTER(MAX_TRANS_GROUPS))
            ALLOCATE(LOAD_DISPATCH_POSITION(MAX_TRANS_LOAD_TABLES, &
            ALLOCATE(LOAD_DISPATCH_INDEX(MAX_TRANS_LOAD_TABLES, &
            ALLOCATE(TRANS_LOAD_GROUPS_INDEX(MAX_TRANS_GROUPS))
            ALLOCATE(CUST_CLASS_GROUPS_INDEX(0:MAX_CLASS_GROUPS))
            ALLOCATE(CUST2_CLASS_GROUPS_INDEX(0:MAX_CLASS2_GROUPS))
            ALLOCATE(ASSET_CLASS_GROUPS_INDEX(0:MAX_ASSET_GROUPS))
            ALLOCATE(ASSET_2_TRANS_INDEX(0:MAX_ASSET_GROUPS, &
            ALLOCATE(NUMBER_ASSET_2_TRANS(MAX_TRANS_GROUPS))
            ALLOCATE(ASSET_TRANSACTION_CROSS_INDEX(0:MAX_ASSET_GROUPS, &
            ALLOCATE(NUMBER_TRANS_PER_AC_TG(0:MAX_ASSET_GROUPS, &
            ALLOCATE(TRANS_WITHIN_AC_TG(0:MAX_ASSET_GROUPS, &
            ALLOCATE(FIRST_AC_TG(0:MAX_ASSET_GROUPS))
            ALLOCATE(FIRST_TABLE_TG(0:MAX_TRANS_GROUPS))
            ALLOCATE(TRANS_LOAD_2_TRANS_GROUPS(MAX_TRANS_GROUPS))
            ALLOCATE(TRANS_LOAD_GROUP_2_TG(MAX_TRANS_GROUPS))
            ALLOCATE(CUST_CLASS_GROUP_2_CG(MAX_CLASS_GROUPS+1))
            ALLOCATE(CUST2_CLASS_GROUP_2_CG(MAX_CLASS_GROUPS+1))
            ALLOCATE(ASSET_CLASS_GROUP_2_AC(0:MAX_ASSET_GROUPS+1))
            ALLOCATE(LAST_TABLE_FOR_TG(MAX_TRANS_GROUPS))
            ALLOCATE(LAST_TABLE_FOR_CG(MAX_CLASS_GROUPS+1))
            ALLOCATE(LAST_TABLE_FOR_CG2(MAX_CLASS_GROUPS+1))
            ALLOCATE(TG_CG_DATABASE(0:12,0:MAX_TRANS_GROUPS, &
            ALLOCATE(TG_CG2_DATABASE(0:12,0:MAX_TRANS_GROUPS, &
            ALLOCATE(TABLE_DAY_SHIFT(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(TF_PLANNING_PEAK(0:MAX_TRANS_GROUPS,12))
            ALLOCATE(PA_PLANNING_PEAK(0:NUMBER_OF_ACTIVE_GROUPS,12))
            ALLOCATE(CM_PLANNING_PEAK(0:NUMBER_OF_ACTIVE_GROUPS,12))
            ALLOCATE(GLOBAL_PA_PEAK(0:NUMBER_OF_ACTIVE_GROUPS))
            ALLOCATE(GLOBAL_CM_PEAK(0:NUMBER_OF_ACTIVE_GROUPS))
            ALLOCATE(GLOBAL_PA_PEAK_MONTH(0:NUMBER_OF_ACTIVE_GROUPS))
            ALLOCATE(GLOBAL_CM_PEAK_MONTH(0:NUMBER_OF_ACTIVE_GROUPS))
            ALLOCATE(TG_2_PLANNING_AREA(MAX_TRANS_GROUPS_FROM_TG))
            ALLOCATE(TG_2_CAPACITY_MARKET(MAX_TRANS_GROUPS_FROM_TG))
            ALLOCATE(REV_CLASS_INDEX(0:MAX_TRANS_LOAD_TABLES,4))
            ALLOCATE(ENERGY_LOSS_MULT(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(REF_LEAP_YEAR_DAY_SHIFT(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(DEMAND_PRICING_METHOD(MAX_TRANS_LOAD_TABLES))
           ALLOCATE(MONTHLY_TABLE_PEAK_SALES(MAX_TRANS_LOAD_TABLES,12))
            ALLOCATE(INTRA_COMPANY_TRANSACTION(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(INTRA_ASSET_CLASS_ID(MAX_TRANS_LOAD_TABLES))
            ALLOCATE(INTRA_ASSET_CLASS_ALLOCATION( &
            ALLOCATE(INTRA_ACCOUNT_CLASSIFICATION( &
            ALLOCATE(INTRA_EXPENSE_COLLECTION(MAX_TRANS_LOAD_TABLES))
         ALLOCATE(MONTHLY_INTERRUPTIBLE_REVENUE( &
            ALLOCATE(LAST_THIS_YR_ENERGY(2,12,0:MAX_TRANS_LOAD_TABLES)) ! 1=LAST_YEAR, 2=THIS YEAR
            ALLOCATE(LAST_THIS_YR_PEAK(2,12,0:MAX_TRANS_LOAD_TABLES))
         ALLOCATE(MONTHLY_AC_COST_AT_MARKET( &
         ALLOCATE(MONTHLY_AC_CONTRACT_REVENUE( &
         ALLOCATE(MONTHLY_AC_CONTRACT_EXPENSE( &
         ALLOCATE(DAY_OF_WEEK(31,0:MAX_TRANS_LOAD_TABLES))
            ALLOCATE( &
            ALLOCATE( &
            ALLOCATE( &
            ALLOCATE( &
            ALLOCATE( &
            ALLOCATE( &
            ALLOCATE( &
            ALLOCATE( &
         ALLOCATE (WH_TRANS_ALLOC(0:MAX_TRANS_LOAD_TABLES, &
         ALLOCATE(TRANS_HOURLY_LOAD( &
         ALLOCATE(WH_LOADS_PER_HOUR( &
         ALLOCATE(HYDRO_HOURLY_LOAD( & !  NEED TO COUNT HYDRO GROUPS
         ALLOCATE(TABLE_HOURLY_LOAD( &
         ALLOCATE(MONTHLY_TRANS_ENERGY(0:MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(MONTHLY_HYDRO_ENERGY(0:NUMBER_OF_HYDRO_GROUPS))
         ALLOCATE(MONTHLY_TRANS_PEAK(0:MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(MONTHLY_TRANS_BASE(0:MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(MONTHLY_HYDRO_PEAK(0:NUMBER_OF_HYDRO_GROUPS))
         ALLOCATE(MONTHLY_HYDRO_BASE(0:NUMBER_OF_HYDRO_GROUPS))
         ALLOCATE(MONTHLY_TABLE_ENERGY(0:MAX_TRANS_LOAD_TABLES))
         ALLOCATE(MONTHLY_TABLE_SALES_ENERGY( &
         ALLOCATE(MONTHLY_TABLE_PEAK(0:MAX_TRANS_LOAD_TABLES))
         ALLOCATE(TABLE_ENERGY_PRICE(MAX_TRANS_LOAD_TABLES))
         ALLOCATE(TABLE_ENERGY_REVENUE(0:MAX_TRANS_LOAD_TABLES))
         ALLOCATE(TABLE_DEMAND_REVENUE(0:MAX_TRANS_LOAD_TABLES))
         ALLOCATE(TABLE_CUSTOMER_REVENUE(0:MAX_TRANS_LOAD_TABLES))
         ALLOCATE(TRANS_ENERGY_REVENUE(0:MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(TRANS_DEMAND_REVENUE(0:MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(TRANS_CUSTOMER_REVENUE(0:MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(CLASS_ENERGY_REVENUE(0:MAX_CUST_CLASS_GROUPS))
         ALLOCATE(TRANS_INDEXED_REVENUE(0:MAX_CUST_CLASS_GROUPS))
         ALLOCATE(CLASS_PEAK_REVENUE(0:MAX_CUST_CLASS_GROUPS))
         ALLOCATE(CLASS_CUSTOMER_REVENUE(0:MAX_CUST_CLASS_GROUPS))
         ALLOCATE(CAP_CUSTOMER_EXPENSE(0:MAX_CUST_CLASS_GROUPS))
         ALLOCATE(TF_TG_CAP_MARKET_MW(0:MAX_TRANS_GROUPS))
         ALLOCATE(TF_TG_CAP_MARKET_COST(0:MAX_TRANS_GROUPS))
         ALLOCATE(MONTHLY_CLASS_ENERGY(0:MAX_CUST_CLASS_GROUPS))
         ALLOCATE(MONTHLY_CLASS_PEAK(0:MAX_CUST_CLASS_GROUPS))
         ALLOCATE(MONTHLY_CLASS_CUSTOMERS(0:MAX_CUST_CLASS_GROUPS))
         ALLOCATE(LOCAL_CUSTOMER_NAME(0:MAX_CUST_CLASS_GROUPS))
         ALLOCATE(ASSET_CLASS_HOURLY_LOAD(MAX_HOURS_IN_MONTH, &
         ALLOCATE(ANN_LOAD_DISPATCH_COST_BY_UNIT(NUNITS+2, &
         ALLOCATE(ANN_LOAD_DISPATCH_REV_BY_UNIT(NUNITS+2, &
         ALLOCATE(ANN_LOAD_DISPATCH_BY_UNIT(NUNITS+2, &
            ALLOCATE(HOURLY_CUST_MARGIN_DB(4,HOURLY_CUST_MARGIN_VAR))
            ALLOCATE(LOAD_DISPATCH_BY_BLOCK( &
            ALLOCATE(LOAD_DISPATCH_COST( &
            ALLOCATE(LOCAL_MUST_RUN_OPTIONS(R_TOTAL_DISPATCH_BLOCKS))
            ALLOCATE(LOAD_DISPATCH_COST_BY_UNIT( &
            ALLOCATE(LOAD_DISPATCH_REV( &
           ALLOCATE(LOAD_DISPATCH_REV_BY_UNIT(NUNITS+2,LOAD_BLOCK_VAR))
            ALLOCATE(LOAD_DISPATCH_BY_UNIT(NUNITS+2,LOAD_BLOCK_VAR))
         ALLOCATE(CUM_BLOCK_GENERATION(LAST_BLOCK,3))
         ALLOCATE(TEMP_CHRONO_LOAD(SAVE_HOURS))
         ALLOCATE(TEMP_CHRONO_LOAD(SAVE_HOURS))
         ALLOCATE(TRANS_GROUP_INDEX(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(TG_SCENARIO_VARIABLE_INDEX(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(HYDRO_GROUP_2_TG(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(TRANS_GROUP_POSITION(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(REPORT_THIS_GROUP(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(TG_2_HYDRO_GROUP(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(TG_2_PLANNING_AREA(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(TG_2_CAPACITY_MARKET(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(HYDRO_AGGREGATION_POSITION(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(HYDRO_AGGREGATION_INDEX(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(PLANNING_AREA_POSITION(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(CAPACITY_MARKET_POSITION(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(PLANNING_AREA_INDEX(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(CAPACITY_MARKET_INDEX(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(ASSET_CLASS_GROUPS_INDEX(0:MAX_ASSET_GROUPS))
         ALLOCATE(ASSET_CLASS_2_TG(0:MAX_ASSET_GROUPS))
         ALLOCATE(ASSET_CLASS_GROUP_2_AC(0:MAX_TRANS_GROUP_INDEX))
         ALLOCATE(GROUP_NAME(0:TRANS_GROUPS_RECORDS))
         ALLOCATE(GROUP_ACTIVE(TRANS_GROUPS_RECORDS))
         ALLOCATE(TRANSACTION_GROUP(TRANS_GROUPS_RECORDS))
         ALLOCATE(TRANS_GROUP_FULL_NAME(TRANS_GROUPS_RECORDS))
         ALLOCATE(TG_BASECASE_MARKET_AREA_ID(TRANS_GROUPS_RECORDS))
         ALLOCATE(BASECASE_MARKET_AREA_ID(TRANS_GROUPS_RECORDS))
         ALLOCATE(BASE_CASE_TRANS_AREA_ID(TRANS_GROUPS_RECORDS))
         ALLOCATE(BASECASE_SUBREGION_ID(TRANS_GROUPS_RECORDS))
         ALLOCATE(SPINNING_UNITS(TRANS_GROUPS_RECORDS))
         ALLOCATE(OFF_PEAK_SPINNING_UNITS(TRANS_GROUPS_RECORDS))
         ALLOCATE(SPINNING_RESERVE(TRANS_GROUPS_RECORDS))
         ALLOCATE(OFF_PEAK_SPINNING_RESERVE(TRANS_GROUPS_RECORDS))
         ALLOCATE(MAX_HOURLY_RAMP_UP(TRANS_GROUPS_RECORDS))
         ALLOCATE(MAX_HOURLY_RAMP_DOWN(TRANS_GROUPS_RECORDS))
         ALLOCATE(FIRST_CAPACITY_VALUE(0:TRANS_GROUPS_RECORDS))
         ALLOCATE(FIRST_CAPACITY_PERCENT(0:TRANS_GROUPS_RECORDS))
         ALLOCATE(SECOND_CAPACITY_VALUE(0:TRANS_GROUPS_RECORDS))
         ALLOCATE(SECOND_CAPACITY_PERCENT(0:TRANS_GROUPS_RECORDS))
         ALLOCATE(THIRD_CAPACITY_VALUE(0:TRANS_GROUPS_RECORDS))
         ALLOCATE(THIRD_CAPACITY_PERCENT(0:TRANS_GROUPS_RECORDS))
         ALLOCATE(ADDITIONAL_CAPACITY_VALUE(0:TRANS_GROUPS_RECORDS,7))
        ALLOCATE(ADDITIONAL_CAPACITY_PERCENT(0:TRANS_GROUPS_RECORDS,7))
         ALLOCATE(RTO_GROUP(TRANS_GROUPS_RECORDS))
         ALLOCATE(NOX_YEAR(TRANS_GROUPS_RECORDS))
         ALLOCATE(END_NOX_YEAR(TRANS_GROUPS_RECORDS))
         ALLOCATE(ST_LHS_FOR_PRICES(TRANS_GROUPS_RECORDS))
         ALLOCATE(MRX_VOLATILITY_MULT(TRANS_GROUPS_RECORDS))
         ALLOCATE(NIGHT_SCARCITY_MULT(TRANS_GROUPS_RECORDS))
         ALLOCATE(WEEKEND_SCARCITY_MULT(TRANS_GROUPS_RECORDS))
         ALLOCATE(PRICE_CAP(TRANS_GROUPS_RECORDS))
         ALLOCATE(PRICE_MINIMUM(TRANS_GROUPS_RECORDS))
         ALLOCATE(REGIONAL_CAPACITY_MARKET(TRANS_GROUPS_RECORDS))
         ALLOCATE(MAX_HOURLY_TG_IMPORT(TRANS_GROUPS_RECORDS))
         ALLOCATE(MAX_HOURLY_TG_EXPORT(TRANS_GROUPS_RECORDS))
         ALLOCATE(HYDRO_LOAD_AGGREGATION(TRANS_GROUPS_RECORDS))
         ALLOCATE(REGIONAL_PLANNING_AREA(TRANS_GROUPS_RECORDS))
         ALLOCATE(REPORT_CL_CAPACITY(TRANS_GROUPS_RECORDS))
         ALLOCATE(ASSET_CLASS_ID(TRANS_GROUPS_RECORDS))
         ALLOCATE(ASSET_CLASS_REV_ALLOC_VECTOR(TRANS_GROUPS_RECORDS))
         ALLOCATE(TIME_ZONE(TRANS_GROUPS_RECORDS))
         ALLOCATE(CAPACITY_ADDER(TRANS_GROUPS_RECORDS))
         ALLOCATE(NOX_SEASON(TRANS_GROUPS_RECORDS))
         ALLOCATE(PURCHASE_POWER_ASSIGN(TRANS_GROUPS_RECORDS))
         ALLOCATE(CREATE_HOURLY_PRICE(TRANS_GROUPS_RECORDS))
         ALLOCATE(CREATE_HOURLY_PRICE_INDEX(TRANS_GROUPS_RECORDS))
         ALLOCATE(CREATE_HOURLY_PRICE_POS(TRANS_GROUPS_RECORDS))
         ALLOCATE(HOURLY_PRICE_NAME(TRANS_GROUPS_RECORDS))
         ALLOCATE(PURCHASE_ASSET_CLASS_ID(TRANS_GROUPS_RECORDS))
         ALLOCATE(PURCHASE_ASSET_ALLOC_VECTOR(TRANS_GROUPS_RECORDS))
         ALLOCATE(PRICE_ESCALATION_RATE(TRANS_GROUPS_RECORDS), &
         ALLOCATE(DEMAND(R_MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(DX(R_MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(PEAK(R_MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(LODDUR(LOAD_POINTS,R_MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(LPROB(LOAD_POINTS,R_MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(DEMAND(R_MAX_HYDRO_LOAD_GROUPS))
         ALLOCATE(DX(R_MAX_HYDRO_LOAD_GROUPS))
         ALLOCATE(PEAK(R_MAX_HYDRO_LOAD_GROUPS))
         ALLOCATE(LODDUR(1000,R_MAX_HYDRO_LOAD_GROUPS))
         ALLOCATE(LPROB(1000,R_MAX_HYDRO_LOAD_GROUPS))
      ALLOCATE(HOURLY_HYDRO(LOAD_HOURS_IN_PERIOD), &
      ALLOCATE(SORT_POS(LOAD_HOURS_IN_PERIOD))
      ALLOCATE(SORT_POS(LOAD_HOURS_IN_PERIOD))
         ALLOCATE(TRANS_LOAD_AFTER_EL( &
         ALLOCATE(TRANS_HOURLY_HYDRO( &
         ALLOCATE(MONTHLY_TRANS_LOAD_MWH(0:MAX_TRANS_LOAD_GROUPS))
        ALLOCATE(MONTHLY_TRANS_LOAD_HYDRO_MWH(0:MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(MONTHLY_TRANS_LOAD_HYDRO_MW(0:MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(MONTHLY_TRANS_PEAK(0:MAX_TRANS_LOAD_GROUPS))
         ALLOCATE(MONTHLY_TRANS_BASE(0:MAX_TRANS_LOAD_GROUPS))
            ALLOCATE(SCENARIO_VARIABLE_ACTIVE(NUM_SCEN_VAR))
            ALLOCATE(SCENARIO_VARIABLE_NAME(NUM_SCEN_VAR))
            ALLOCATE(TIME_FRAME(NUM_SCEN_VAR,AVAIL_DATA_YEARS))
            ALLOCATE(HOURLY_REFERENCE_NAME(NUM_SCEN_VAR, &
            ALLOCATE(HOURLY_REFERENCE_NUMBER(NUM_SCEN_VAR, &
            ALLOCATE(SCEN_MAKER_VARIABLE(NUM_SCEN_VAR,LOCAL_MONTHS, &
         ALLOCATE(unit_names(MAX_OUTAGES), &
         ALLOCATE( BEGIN_MONTH_DAY(MAX_EVENTS_IN_MONTH), &
         ALLOCATE( MONTH_EVENT_COUNTER(MAX_TRANS_GROUPS) )
         ALLOCATE(EVENTS_RECORD_INDEX( &
         ALLOCATE(BEGIN_IN_HOUR_ALAN(MAX_FO_PER_MONTH+1), &
            ALLOCATE(CLM_MAINT_INDEX(TOTAL_INDEXED_OUTAGES))
            ALLOCATE( &
            ALLOCATE( &
         ALLOCATE(MAX_BLOCKS_PER_TRANS(0:UPPER_TRANS_GROUP), &
         ALLOCATE(PRODUCT_GEN_BY_S_U(0:MAX_START_UP_UNITS_BY_TG,3, &
         ALLOCATE(PRODUCT_FUEL_BY_S_U(0:MAX_START_UP_UNITS_BY_TG,3, &
         ALLOCATE ( &
         ALLOCATE ( &
         ALLOCATE ( &
         ALLOCATE ( &
         ALLOCATE ( &
         ALLOCATE (TRANC_DATABASE(1,1,1,1))
       ALLOCATE (GENERATION_BY_SEGMENT(MAX_OUTAGE_BLOCKS,800))
       allocate(DAILY_CUM_DISPATCH_MW(MAX_OUTAGE_BLOCKS,24))
      allocate(DEPTH_HOURLY_DISPATCH_MW(MAX_OUTAGE_BLOCKS))
      allocate(DAILY_CUM_DISPATCH_COST(MAX_OUTAGE_BLOCKS,24))
      allocate(DAILY_GEN_BY_S_U(0:NO_START_UP_UNITS,24))
      allocate(DAILY_FUEL_BY_S_U( &
      allocate(DAILY_SYSTEM_COST_AND_REV(0:2,24))
      allocate(DAILY_COST_BY_S_U(0:NO_START_UP_UNITS,24))
      allocate(DAILY_SPIN_BY_S_U(0:NO_START_UP_UNITS,24))
      allocate(MONTH_MUST_BY_BLOCK(MAX_OUTAGE_BLOCKS,800))
      allocate(DAILY_MUST_RUN_CAPACITY(24))
      allocate(DAILY_EMERGENCY_CAPACITY(24))
      allocate(DAILY_HARD_WIRED_BY_BLOCK(24,MAX_OUTAGE_BLOCKS))
      allocate(INCREMENTAL_FUEL_COST(MAX_OUTAGE_BLOCKS))
      allocate(OPTION_NAME(0:NO_START_UP_UNITS))
      allocate(CONTRIBUTES_TO_SPIN(NO_START_UP_UNITS))
      allocate(MONTH_UNIT_STARTS(NO_START_UP_UNITS))
      allocate(MONTH_UNIT_DOWNS(NO_START_UP_UNITS))
      allocate(IN_MIN_DOWN_TIME_STATE(NO_START_UP_UNITS,800))
      allocate(IN_MIN_UP_TIME_STATE(NO_START_UP_UNITS,800))
      allocate(START_UP_COSTS(NO_START_UP_UNITS))
      allocate(EMERGENCY_CAPACITY(NO_START_UP_UNITS))
      allocate(MIN_SPIN_CAP(NO_START_UP_UNITS))
      allocate(MAX_SPIN_CAP(NO_START_UP_UNITS))
      allocate(HOURLY_EMERGENCY_CAPACITY(NO_START_UP_UNITS))
      allocate(MAX_HOURLY_RAMP_UP(0:MAX_OUTAGE_BLOCKS))
      allocate(MAX_HOURLY_RAMP_DOWN(0:MAX_OUTAGE_BLOCKS))
      allocate(EMERGENCY_HEATRATE(NO_START_UP_UNITS))
      allocate(MONTH_UNIT_START_COST(NO_START_UP_UNITS))
      allocate(MONTH_OPERATING_HOURS(NO_START_UP_UNITS))
      allocate(MUST_RUN_BLOCK(MAX_OUTAGE_BLOCKS))
      allocate(UNIT_IS_UP(NO_START_UP_UNITS))
      allocate(ORIGINAL_VALUE_OF_U(NO_START_UP_UNITS))
      allocate(INCREASING_VALUE_OF_U(NO_START_UP_UNITS))
      allocate(GLOBAL_BLOCK_INDEX(MAX_OUTAGE_BLOCKS))
      allocate(MIN_UP_TIME(NO_START_UP_UNITS))
      allocate(MIN_DOWN_TIME(NO_START_UP_UNITS))
      allocate(RAMP_RATE(NO_START_UP_UNITS))
      allocate(RAMP_DOWN_RATE(NO_START_UP_UNITS))
      allocate(START_UP_COST_PER_MWH(NO_START_UP_UNITS))
      allocate(EMERGENCY_COST_PER_MWH(NO_START_UP_UNITS))
      allocate(MINIMUM_UP_INDEX(NO_START_UP_UNITS))
      allocate(SORTED_OPTIONS(MAX_OUTAGE_BLOCKS))
      allocate(FLOOR_SORTED_OPTIONS(MAX_OUTAGE_BLOCKS))
      allocate(CEILING_SORTED_OPTIONS(MAX_OUTAGE_BLOCKS))
      allocate(MUST_RUN_OPTIONS(MAX_OUTAGE_BLOCKS))
      allocate(UNIT_FOR_OUTAGE_BLOCK(MAX_OUTAGE_BLOCKS))
      allocate(S_U_FOR_OUTAGE_BLOCK(MAX_OUTAGE_BLOCKS))
      allocate(BLOCK_FOR_OUTAGE_BLOCK(MAX_OUTAGE_BLOCKS))
      allocate(DISPATCH_COST_FOR_BLOCK(MAX_OUTAGE_BLOCKS))
      allocate(ALT_DISPATCH_COST_FOR_BLOCK(MAX_OUTAGE_BLOCKS))
      allocate(FLOOR_PRICE_FOR_BLOCK(MAX_OUTAGE_BLOCKS))
      allocate(CEILING_PRICE_FOR_BLOCK(MAX_OUTAGE_BLOCKS))
      allocate(MARKET_FLOOR_UNIT(NO_START_UP_UNITS))
      allocate(MARKET_CEILING_UNIT(NO_START_UP_UNITS))
      allocate(RETAIL_REVENUE_FOR_BLOCK(MAX_OUTAGE_BLOCKS))
      allocate(UNIT_GEN_IN_SYSTEM(2,0:NO_START_UP_UNITS))
      allocate(UNIT_HEAT_PARAM(2,0:NO_START_UP_UNITS))
      allocate(UNIT_SPIN_IN_SYSTEM(2,0:NO_START_UP_UNITS))
      allocate(OUTAGE_BLOCK_BY_SEGMENT(2,NO_START_UP_UNITS))
      allocate(MARKET_RESOURCE_COUNTER(TOTAL_START_UP_UNITS))
      allocate(DAILY_OPTION_STATUS(0:MAX_DAYS,NO_START_UP_UNITS))
      allocate(PRICING_GROUP_SELL_PRICE( &
      allocate(PRICING_GROUP_SELL_NAME(LOCAL_PRICING_GROUPS))
      allocate(PRICING_GROUP_SELL_QUANT(0:LOCAL_PRICING_GROUPS))
      allocate(PRICING_GROUP_SELL_QUANT_AVAIL( &
      allocate(PRICING_GROUP_BUY_QUANT_AVAIL( &
      allocate(PRICING_GROUP_SELL_GEN(0:LOCAL_PRICING_GROUPS,24))
      allocate(PRICING_GROUP_SELL_INDEX(LOCAL_PRICING_GROUPS))
      allocate(PRICING_GROUP_BUY_PRICE( &
      allocate(PRICING_GROUP_BUY_NAME( &
      allocate(PRICING_GROUP_BUY_QUANT(0: &
      allocate(PRICING_GROUP_BUY_INDEX(LOCAL_BUY_PRICING_GROUPS))
      allocate(ALL_RESOURCE_TYPE(ALL_RESOURCE_NUMBER))
      allocate(ALL_RESOURCE_INDEX(ALL_RESOURCE_NUMBER))
      allocate(ALL_DEMAND_TYPE(ALL_DEMAND_NUMBER))
      allocate(ALL_DEMAND_INDEX(ALL_DEMAND_NUMBER))
      allocate(ALL_RESOURCE_PRICE(ALL_RESOURCE_NUMBER))
      allocate(ALL_RESOURCE_QUANTITY(ALL_RESOURCE_NUMBER))
      allocate(ALL_RESOURCE_QUANTITY_USED(ALL_RESOURCE_NUMBER))
      allocate(ALL_DEMAND_SERVED(0:LOCAL_PRICING_GROUPS, &
      allocate(ALL_DEMAND_PRICE(ALL_DEMAND_NUMBER))
      allocate(ALL_DEMAND_QUANTITY(ALL_DEMAND_NUMBER))
      allocate(ALL_DEMAND_NAME(ALL_DEMAND_NUMBER))
      allocate(ALL_DEMAND_BUY_GEN(0:ALL_DEMAND_NUMBER,24))
      allocate(HOURLY_RESOURCES_AND_MARKETS( &
         ALLOCATE(JOINT_DISPATCH_ORDER(MAX_NBLOK,4))
         ALLOCATE(COMBINED_GEN_IN_SYSTEM(2,LOCAL_NUNITS), &
      ALLOCATE(MULTI_AREA_NAME(0:MAX_TRANS_GROUPS))
      ALLOCATE(TRANS_GROUP_LOAD_ACTIVE(MAX_TRANS_GROUP_NUMBER))
      ALLOCATE(REPORT_AREA_ACTIVE(MAX_TRANS_GROUPS))
      ALLOCATE(MONTHLY_MARKET_PRICES(HOURS_IN_MONTH))
         ALLOCATE(ANNUAL_MARKET_PRICES(ANNUAL_HOURS)) 
            ALLOCATE(ANNUAL_MARKET_PRICES(ANNUAL_HOURS)) 
               ALLOCATE( &
               ALLOCATE( &
               ALLOCATE(MAX_USER_W_PRICE(UPPER_TRANS_GROUP))
               ALLOCATE(MIN_USER_W_PRICE(UPPER_TRANS_GROUP))
               ALLOCATE(MONTH_MAX_USER_W_PRICE(12,UPPER_TRANS_GROUP))
               ALLOCATE(MONTH_MIN_USER_W_PRICE(12,UPPER_TRANS_GROUP))
               ALLOCATE(SUM_USER_W_PRICES(UPPER_TRANS_GROUP))
               ALLOCATE(MONTH_SUM_USER_W_PRICES(12,UPPER_TRANS_GROUP))
               ALLOCATE( &
               ALLOCATE(MAX_USER_W_PRICE(UPPER_TRANS_GROUP))
               ALLOCATE(MIN_USER_W_PRICE(UPPER_TRANS_GROUP))
               ALLOCATE(MONTH_MAX_USER_W_PRICE(12,UPPER_TRANS_GROUP))
               ALLOCATE(MONTH_MIN_USER_W_PRICE(12,UPPER_TRANS_GROUP))
               ALLOCATE(SUM_USER_W_PRICES(UPPER_TRANS_GROUP))
               ALLOCATE(MONTH_SUM_USER_W_PRICES(12,UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_PURCHASE_ENERGY(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_PURCHASE_COSTS(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_SALES_ENERGY(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_SALES_REVENUES(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_NATIVE_COST(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_LOAD_B4_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_PRO_COST_B4_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_LOAD_AFTER_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_PRO_COST_AFTER_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_MWH(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_PEAK(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_COIN_PEAK(0:UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_BASE(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_HYDRO_MWH(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_HYDRO_MW(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_HYDRO_ROR(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_SPINNING_MWH(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_EFFECTIVE_CAPACITY(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_UNSERVED_ENERGY(UPPER_TRANS_GROUP,0:12))
            ALLOCATE(ANNUAL_ABOVE_RESOURCES(UPPER_TRANS_GROUP,0:12))
            ALLOCATE(ANNUAL_UNSERVED_ENERGY_COST(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_COST_ABOVE_RESOURCES(UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_PRICE(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_QUANTITY(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_HEATRATE(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_MARGINAL_FUEL(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_FUEL_PRICE(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_HOURS(NUM_PRODUCTS))
            ALLOCATE(SYSTEM_HOURLY_LOADS( &
         ALLOCATE(M_MONTHLY_PRO_COST_AFTER_SALES(UPPER_TRANS_GROUP))
         ALLOCATE(M_MONTHLY_PRO_COST_B4_SALES(UPPER_TRANS_GROUP))
         ALLOCATE(M_MONTHLY_LOAD_B4_SALES(UPPER_TRANS_GROUP))
         ALLOCATE(M_MONTHLY_LOAD_AFTER_SALES(UPPER_TRANS_GROUP))
         ALLOCATE(M_PURCHASE_ENERGY(UPPER_TRANS_GROUP))
         ALLOCATE(M_PURCHASE_COSTS(UPPER_TRANS_GROUP))
         ALLOCATE(MARKET_COST_ABOVE_RESOURCES(UPPER_TRANS_GROUP))
         ALLOCATE(M_SALES_ENERGY(UPPER_TRANS_GROUP))
         ALLOCATE(M_SALES_REVENUES(UPPER_TRANS_GROUP))
         ALLOCATE(M_NATIVE_COST(UPPER_TRANS_GROUP))
         ALLOCATE(M_SPINNING_MWH(UPPER_TRANS_GROUP))
         ALLOCATE(M_UNSERVED_ENERGY(UPPER_TRANS_GROUP))
         ALLOCATE(M_ABOVE_RESOURCES(UPPER_TRANS_GROUP))
         ALLOCATE(M_UNSERVED_ENERGY_COST(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_ROR_CAPACITY(0:UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_DUMP_CAPACITY(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_MUST_CAPACITY(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_SPINNING_CAPACITY(UPPER_TRANS_GROUP))
         ALLOCATE(AREA_PRICE_MULT(UPPER_TRANS_GROUP))
         ALLOCATE(TG_USING_PRICE_DISTN(UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_SPINNING_CAPACITY(UPPER_TRANS_GROUP))
         ALLOCATE(DAILY_PEAK(UPPER_TRANS_GROUP))
         ALLOCATE(OFF_PEAK_SPINNING_CAPACITY(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_RAMP_UP(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_RAMP_DOWN(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_MAX_IMPORT(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_MAX_EXPORT(UPPER_TRANS_GROUP))
         ALLOCATE(LAST_HOUR_SELL(UPPER_TRANS_GROUP))
         ALLOCATE(MONTH_COIN_PEAK(0:UPPER_TRANS_GROUP))
         ALLOCATE(MONTH_NON_COIN_PEAK(0:UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_TRANSACTION(UPPER_TRANS_GROUP))
         ALLOCATE(MAX_HOURLY_IMPORT(UPPER_TRANS_GROUP))
         ALLOCATE(MAX_HOURLY_EXPORT(UPPER_TRANS_GROUP))
         ALLOCATE(SCARCITY_MULT(0:UPPER_TRANS_GROUP))
         ALLOCATE(SYSTEM_STORAGE(0:800,0:UPPER_TRANS_GROUP))
         ALLOCATE(SYSTEM_DERIVATIVES(0:800,UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_PURCHASE_ENERGY(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_PURCHASE_COSTS(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_SALES_ENERGY(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_SALES_REVENUES(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_NATIVE_COST(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_LOAD_B4_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_PRO_COST_B4_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_LOAD_AFTER_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_PRO_COST_AFTER_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_TL_MWH(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_TL_PEAK(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_COIN_PEAK(0:UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_TL_BASE(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_TL_HYDRO_MWH(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_TL_HYDRO_MW(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_TL_HYDRO_ROR(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_SPINNING_MWH(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_EFFECTIVE_CAPACITY(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_UNSERVED_ENERGY(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_ABOVE_RESOURCES(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_UNSERVED_ENERGY_COST(UPPER_TRANS_GROUP))
            ALLOCATE(FISCAL_COST_ABOVE_RESOURCES(UPPER_TRANS_GROUP))
         ALLOCATE(ALL_MONTH_PRICES(R_HOURS_IN_MONTH, &
         ALLOCATE(HOURLY_MARGINAL_COST(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_LAST_PRICE(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(DAILY_PRODUCTS_CAPACITY( &
         ALLOCATE(HOURLY_IN_PRICE(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_MC_AFTER(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(SYSTEM_OUTPUT(DAILY_HOURS))
         ALLOCATE(TIE_FLOW(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_LOAD_B4_SALES(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_TRANSFER_MWH(UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_FORWARDS_4_MONTH(UPPER_TRANS_GROUP, &
         ALLOCATE(DAILY_MARKET_PRICE(DAILY_HOURS))
         ALLOCATE(HOURLY_LOADS(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(TEST_HOURLY_REVENUE(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(MARGINAL_COST_DELTA(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_PRO_COST_AFTER_SALES(0:UPPER_TRANS_GROUP, &
         ALLOCATE(HOURLY_CAPACITY(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_EUE(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_DERIVATIVES(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_PRO_COST_B4_SALES(0:UPPER_TRANS_GROUP, &
         ALLOCATE(HOURLY_INCREMENTAL_COST(0:UPPER_TRANS_GROUP, &
         ALLOCATE(HOURLY_LAMDA(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(PRODUCT_PRICE(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_VOLATILITY(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_QUANTITY(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_HEATRATE(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_MARGINAL_FUEL(0:UPPER_TRANS_GROUP, &
         ALLOCATE(PRODUCT_FUEL_PRICE(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_HOURS(NUM_PRODUCTS))
         ALLOCATE(PRODUCT_MEAN_RETURN(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(SUM_SQUARED_DEVIATIONS( &
         ALLOCATE(PRODUCT_DAILY_RETURN( &
         ALLOCATE(SCARCITY_COST(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(ENERGY_COST(0:UPPER_TRANS_GROUP,DAILY_HOURS))
            ALLOCATE(PRODUCT_LAST_PRICE( &
         ALLOCATE(HOURLY_MARGINAL_COST(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(LAST_TRANS_MC(0:UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_LAST_PRICE(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(M_HOURLY_MC_B4_SALES(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(LAST_BUYER(UPPER_TRANS_GROUP))
         ALLOCATE(LAST_SELLER(UPPER_TRANS_GROUP))
         ALLOCATE(PRICE_ANCHORED(UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_LAMDA(UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(TRANSACTIONS_WITHIN_HOUR(DAILY_HOURS))
         ALLOCATE(BUY_FOR_TRANSACTION(MAX_TRANS_WITHIN_HOUR))
         ALLOCATE(SELL_FOR_TRANSACTION(MAX_TRANS_WITHIN_HOUR))
         ALLOCATE(CUM_REDUNDANT_TRANSACTION(MAX_TRANS_WITHIN_HOUR))
         ALLOCATE(LAST_BUY_FOR_TRANSACTION(MAX_TRANS_WITHIN_HOUR))
         ALLOCATE(LAST_SELL_FOR_TRANSACTION(MAX_TRANS_WITHIN_HOUR))
         ALLOCATE(LONG_PATH_TRANSACTION(MAX_TRANS_WITHIN_HOUR))
         ALLOCATE(MARGIN_FOR_TRANSACTION(MAX_TRANS_WITHIN_HOUR))
         ALLOCATE(MW_FOR_TRANSACTION(MAX_TRANS_WITHIN_HOUR))
         ALLOCATE(LAST_MW_FOR_TRANSACTION(MAX_TRANS_WITHIN_HOUR))
         ALLOCATE(TIE_FLOW(UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(MARGINAL_COST_DELTA(UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(M_HOURLY_LOADS(UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(TEST_HOUR_TIE_LIMIT(UPPER_TRANS_GROUP, &
         ALLOCATE(M_HOURLY_PRO_COST_AFTER_SALES(UPPER_TRANS_GROUP, &
         ALLOCATE(HOURLY_CAPACITY(UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_DERIVATIVES(UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(HOURLY_EUE(UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(M_HOURLY_PRO_COST_B4_SALES(UPPER_TRANS_GROUP, &
         ALLOCATE(M_HOURLY_INCREMENTAL_COST(UPPER_TRANS_GROUP, &
         ALLOCATE(HOURLY_SELL_MWH(TOTAL_BUYER_INDEX,TOTAL_BUYER_INDEX))
         ALLOCATE(MONTHLY_TRANSACTION_MWH(UPPER_TRANS_GROUP, &
         ALLOCATE(TOTAL_DELIVERED_COST(UPPER_TRANS_GROUP, &
         ALLOCATE(SELLERS_LOCAL_CAPACITY(UPPER_TRANS_GROUP, &
         ALLOCATE(M_MONTHLY_PRO_COST_AFTER_SALES(UPPER_TRANS_GROUP))
         ALLOCATE(M_MONTHLY_PRO_COST_B4_SALES(UPPER_TRANS_GROUP))
         ALLOCATE(M_MONTHLY_LOAD_B4_SALES(UPPER_TRANS_GROUP))
         ALLOCATE(M_MONTHLY_LOAD_AFTER_SALES(UPPER_TRANS_GROUP))
         ALLOCATE(M_PURCHASE_ENERGY(UPPER_TRANS_GROUP))
         ALLOCATE(M_PURCHASE_COSTS(UPPER_TRANS_GROUP))
         ALLOCATE(MARKET_COST_ABOVE_RESOURCES(UPPER_TRANS_GROUP))
         ALLOCATE(M_SALES_ENERGY(UPPER_TRANS_GROUP))
         ALLOCATE(M_SALES_REVENUES(UPPER_TRANS_GROUP))
         ALLOCATE(M_NATIVE_COST(UPPER_TRANS_GROUP))
         ALLOCATE(M_SPINNING_MWH(UPPER_TRANS_GROUP))
         ALLOCATE(ALLOWED_TRANSACTION_PAIR(UPPER_TRANS_GROUP, &
         ALLOCATE(TRANSACTIONS_PER_HOUR(UPPER_TRANS_GROUP, &
         ALLOCATE(LONG_PATH_TRANSACTION_PAIR(UPPER_TRANS_GROUP, &
         ALLOCATE(M_UNSERVED_ENERGY(UPPER_TRANS_GROUP))
         ALLOCATE(M_ABOVE_RESOURCES(UPPER_TRANS_GROUP))
         ALLOCATE(CAPPED_PRICE(UPPER_TRANS_GROUP))
         ALLOCATE(PRICE_MINIMUM(UPPER_TRANS_GROUP))
         ALLOCATE(M_UNSERVED_ENERGY_COST(UPPER_TRANS_GROUP))
         ALLOCATE(NET_MARGIN(UPPER_TRANS_GROUP))
         ALLOCATE(BEST_PRICE_TO_BUYER(UPPER_TRANS_GROUP,2))
         ALLOCATE(M_HOURLY_LOAD_B4_SALES( &
         ALLOCATE(TRANS_ROR_CAPACITY(0:UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_DUMP_CAPACITY(UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_DUMP_BEFORE(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_MUST_CAPACITY(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_SPINNING_CAPACITY(UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_SPINNING_CAPACITY(UPPER_TRANS_GROUP))
         ALLOCATE(DAILY_PEAK(UPPER_TRANS_GROUP))
         ALLOCATE(OFF_PEAK_SPINNING_CAPACITY(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_RAMP_UP(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_RAMP_DOWN(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_MAX_IMPORT(UPPER_TRANS_GROUP))
         ALLOCATE(TRANS_MAX_EXPORT(UPPER_TRANS_GROUP))
         ALLOCATE(LAST_HOUR_SELL(UPPER_TRANS_GROUP))
         ALLOCATE(MONTH_COIN_PEAK(0:UPPER_TRANS_GROUP))
         ALLOCATE(MONTH_NON_COIN_PEAK(0:UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_TRANSACTION(UPPER_TRANS_GROUP))
         ALLOCATE(MAX_HOURLY_IMPORT(UPPER_TRANS_GROUP))
         ALLOCATE(MAX_HOURLY_EXPORT(UPPER_TRANS_GROUP))
         ALLOCATE(SCARCITY_MULT(0:UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_TRANS_GROUP_LOAD_ACTIVE(UPPER_TRANS_GROUP))
         ALLOCATE(HOURLY_TRANS_GROUP_GEN_ACTIVE(UPPER_TRANS_GROUP))
         ALLOCATE(PRODUCT_PRICE(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_VOLATILITY(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_QUANTITY(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_HEATRATE(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_MARGINAL_FUEL( &
         ALLOCATE(PRODUCT_FUEL_PRICE(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_HOURS(NUM_PRODUCTS))
         ALLOCATE(PRODUCT_MEAN_RETURN(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(PRODUCT_SCARCITY(0:UPPER_TRANS_GROUP,NUM_PRODUCTS))
         ALLOCATE(SUM_SQUARED_DEVIATIONS( &
         ALLOCATE(SCARCITY_COST(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(ENERGY_COST(0:UPPER_TRANS_GROUP,DAILY_HOURS))
         ALLOCATE(PRODUCT_DAILY_RETURN(0:UPPER_TRANS_GROUP, &
            ALLOCATE( &
            ALLOCATE(M_ANNUAL_PURCHASE_ENERGY(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_PURCHASE_COSTS(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_SALES_ENERGY(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_SALES_REVENUES(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_NATIVE_COST(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_LOAD_B4_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_PRO_COST_B4_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_LOAD_AFTER_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(M_ANNUAL_PRO_COST_AFTER_SALES(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_MWH(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_PEAK(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_COIN_PEAK(0:UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_BASE(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_HYDRO_MWH(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_HYDRO_MW(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_TL_HYDRO_ROR(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_SPINNING_MWH(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_EFFECTIVE_CAPACITY(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_UNSERVED_ENERGY(UPPER_TRANS_GROUP,0:12))
            ALLOCATE(ANNUAL_ABOVE_RESOURCES(UPPER_TRANS_GROUP,0:12))
            ALLOCATE(ANNUAL_UNSERVED_ENERGY_COST(UPPER_TRANS_GROUP))
            ALLOCATE(ANNUAL_COST_ABOVE_RESOURCES(UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_TRANSACTION_MWH(UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_PRICE(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_SCARCITY(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_QUANTITY(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_HEATRATE(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_MARGINAL_FUEL(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_FUEL_PRICE(0:UPPER_TRANS_GROUP, &
            ALLOCATE(ANNUAL_PRODUCT_HOURS(NUM_PRODUCTS))
         ALLOCATE(HOURLY_TRANS_REVENUE(MAX_TIE_GROUPS,DAILY_HOURS))
      ALLOCATE(TRANS_CLASS_POINTER(0:1023), &
            ALLOCATE(TRANSACTION_NAME(NUM_TRANSACTIONS))
            ALLOCATE(MONTHLY_USER_CF(NUM_TRANSACTIONS))
            ALLOCATE(MONTHLY_USER_CF_COUNTER(NUM_TRANSACTIONS))
            ALLOCATE(MONTHLY_CF_TRANS(NUM_TRANSACTIONS))
            ALLOCATE(USER_CF(NUM_TRANSACTIONS))
            ALLOCATE(COUNTERPARTY_NAME(NUM_TRANSACTIONS))
            ALLOCATE(TRANSACTION_ID(NUM_TRANSACTIONS))
            ALLOCATE(TRANSACTION_GROUP(NUM_TRANSACTIONS))
            ALLOCATE(TRANSACTION_TYPE(NUM_TRANSACTIONS))
            ALLOCATE(DERIVATIVE_TYPE(NUM_TRANSACTIONS))
            ALLOCATE(PRODUCT_INDEX(NUM_TRANSACTIONS))
            ALLOCATE(TRANSACTION_CLASS(NUM_TRANSACTIONS))
            ALLOCATE(PRODUCT_TYPE(NUM_TRANSACTIONS))
            ALLOCATE(OPTION_POSITION(NUM_TRANSACTIONS))
            ALLOCATE(PRODUCT_ACTIVE(NUM_TRANSACTIONS))
            ALLOCATE(STRIKE_FREQUENCY(NUM_TRANSACTIONS))
            ALLOCATE(REPORT_PRODUCT(NUM_TRANSACTIONS))
            ALLOCATE(UNIT_CONTINGENCY(NUM_TRANSACTIONS))
            ALLOCATE(UNIT_CONTINGENT_LINK(NUM_TRANSACTIONS))
            ALLOCATE(ENERGY_MULTIPLIER(NUM_TRANSACTIONS))
            ALLOCATE(TRANS_ACTIVE_IN_ENDPOINT(NUM_TRANSACTIONS))
            ALLOCATE(HEAT_RATE_FOR_SPREAD(NUM_TRANSACTIONS))
            ALLOCATE(USER_DAY_TYPES_ID(NUM_TRANSACTIONS))
            ALLOCATE(PUMPING_CAPACITY(NUM_TRANSACTIONS))
            ALLOCATE(PUMPING_STORAGE_EFFICIENCY(NUM_TRANSACTIONS))
            ALLOCATE(DAILY_PUMPING_MULT(NUM_TRANSACTIONS))
            ALLOCATE(FUEL_TYPE(NUM_TRANSACTIONS))
            ALLOCATE(FUEL_PRICE_TYPE(NUM_TRANSACTIONS))
            ALLOCATE(FUEL_PRICE(NUM_TRANSACTIONS))
            ALLOCATE(TRANSPORTATION_BASIS_TYPE(NUM_TRANSACTIONS))
            ALLOCATE(TRANSPORTATION_BASIS(NUM_TRANSACTIONS))
            ALLOCATE(DELIVERY_ADDER(NUM_TRANSACTIONS))
            ALLOCATE(COUNTERPARTY_BOND_RATING(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_MWH(NUM_TRANSACTIONS))
            ALLOCATE(WVPA_RATE_TRACKER(NUM_TRANSACTIONS))
            ALLOCATE(WVPA_MEM_TRACKER(NUM_TRANSACTIONS), &
            ALLOCATE(Tax_Credit_Begin_Date(NUM_TRANSACTIONS), &
            ALLOCATE(GRX_RPS_CAPACITY(NUM_TRANSACTIONS,30))
            ALLOCATE(SAVE_GRX_RPS_CAPACITY(NUM_TRANSACTIONS,30))
            ALLOCATE(GRX_STORAGE_PATTERN(NUM_OF_TRANS_CLASSES,8760))
            ALLOCATE(GRX_INDEP_PATTERN(NUM_OF_TRANS_CLASSES,8760))
            ALLOCATE(SAVE_GRX_STORAGE_PATTERN &
            ALLOCATE(ENERGY_PRICE_MULTIPLIER(NUM_TRANSACTIONS))
            ALLOCATE(MAX_QUANTITY_OF_PRODUCT(NUM_TRANSACTIONS))
            ALLOCATE(MONTHLY_ENERGY_MULT(NUM_TRANSACTIONS))
            ALLOCATE(CONTRACT_DATE(NUM_TRANSACTIONS))
            ALLOCATE(DISTINGUISHING(NUM_TRANSACTIONS))
            ALLOCATE(REPORTING_GENERATION_GROUP(NUM_TRANSACTIONS))
            ALLOCATE(EXPENSE_ASSIGNMENT(NUM_TRANSACTIONS))
            ALLOCATE(EXPENSE_COLLECTION(NUM_TRANSACTIONS))
            ALLOCATE(ASSET_CLASS_ID(NUM_TRANSACTIONS))
            ALLOCATE(ASSET_ALLOCATION_VECTOR(NUM_TRANSACTIONS))
            ALLOCATE(QUANTITY_OF_PRODUCT(NUM_TRANSACTIONS))
            ALLOCATE(PROPOSED_QUANT_OF_PRODUCT(NUM_TRANSACTIONS))
            ALLOCATE(SAVED_QUANT_OF_PRODUCT(NUM_TRANSACTIONS))
            ALLOCATE(HOURLY_QUANTITY(NUM_TRANSACTIONS))
            ALLOCATE(ENERGY_PRICE(NUM_TRANSACTIONS))
            ALLOCATE(MONTHLY_ENERGY_PRICE(NUM_TRANSACTIONS))
            ALLOCATE(CONTINGENT_CAPACITY(24,NUM_TRANSACTIONS))
            ALLOCATE(MONTHLY_2ND_ENERGY_PRICE(NUM_TRANSACTIONS))
            ALLOCATE(PRICE_TYPE(NUM_TRANSACTIONS))
            ALLOCATE(SECOND_ENERGY_PRICE(NUM_TRANSACTIONS))
            ALLOCATE(MAXIMUM_STRIKES(NUM_TRANSACTIONS))
            ALLOCATE(BILLING_LAG(NUM_TRANSACTIONS))
            ALLOCATE(MINIMUM_STRIKES(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_KW_DAY(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_KW_DAY_ESC(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_KW_MONTH(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_KW_MONTH_ESC(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_KW_YEAR(NUM_TRANSACTIONS))
            ALLOCATE(GRX_DOLLAR_KW_YEAR(NUM_TRANSACTIONS))
            ALLOCATE(GRX_DOLLAR_KW_MONTH(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_KW_YEAR_ESC(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_MONTH(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_MONTH_ESC(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_DEAL(NUM_TRANSACTIONS))
            ALLOCATE(DOLLAR_DEAL_ESC(NUM_TRANSACTIONS))
            ALLOCATE(BEGIN_DAY(NUM_TRANSACTIONS))
            ALLOCATE(BEGIN_DAY_IN_MONTH(NUM_TRANSACTIONS))
            ALLOCATE(BEGIN_EP(NUM_TRANSACTIONS))
            ALLOCATE(END_DAY(NUM_TRANSACTIONS))
            ALLOCATE(END_DAY_IN_MONTH(NUM_TRANSACTIONS))
            ALLOCATE(END_EP(NUM_TRANSACTIONS))
            ALLOCATE(ACTIVE_IN_MONTH(NUM_TRANSACTIONS))
            ALLOCATE(TRANS_TO_ACTIVE_MONTH(NUM_TRANSACTIONS))
            ALLOCATE(ACTIVE_IN_YEAR(NUM_TRANSACTIONS))
            ALLOCATE(ACTIVE_IN_YEAR_INDEX(NUM_TRANSACTIONS))
            ALLOCATE(ASSET_CLASS_GROUPS_INDEX(0:MAX_ASSET_GROUPS))
            ALLOCATE(ASSET_2_TRANS_INDEX(0:MAX_ASSET_GROUPS, &
            ALLOCATE(NUMBER_ASSET_2_TRANS(MAX_TRANS_GROUPS))
            ALLOCATE(FIRST_AC_TG(0:MAX_ASSET_GROUPS))
            ALLOCATE(NUM_FORWARDS(NUM_OF_TRANS_CLASSES))
            ALLOCATE(MONTHLY_CONTINGENT_CAPACITY(NUM_OF_TRANS_CLASSES))
            ALLOCATE(ANNUAL_INTERRUPTIBLE_CAPACITY( &
            ALLOCATE(ANNU_PLANNING_INTRPT_CAPACITY( &
            ALLOCATE(ANNUAL_STORAGE_CAPACITY(NUM_OF_TRANS_CLASSES))
            ALLOCATE(ANNUAL_CAPACITY(744,12,NUM_OF_TRANS_CLASSES))
            ALLOCATE(NUM_PUTS(NUM_OF_TRANS_CLASSES))
            ALLOCATE(NUM_STORAGE(NUM_OF_TRANS_CLASSES))
            ALLOCATE(ANN_NUM_STOR(NUM_OF_TRANS_CLASSES))
            ALLOCATE(SCEN_NUM_STOR(NUM_OF_TRANS_CLASSES))
            ALLOCATE(ANN_STOR_POS(NUM_TRANSACTIONS, &
            ALLOCATE(SCEN_STOR_POS(NUM_TRANSACTIONS, &
            ALLOCATE(NUM_LF_PUTS(NUM_OF_TRANS_CLASSES))
            ALLOCATE(NUM_MONTH_PUTS(NUM_OF_TRANS_CLASSES))
            ALLOCATE(NUM_ANNUAL_PUTS(NUM_OF_TRANS_CLASSES))
            ALLOCATE(NUM_INTER_PUTS(NUM_OF_TRANS_CLASSES))
            ALLOCATE(FORWARD_POSITION(NUM_TRANSACTIONS, &
            ALLOCATE(PUT_POSITION(NUM_TRANSACTIONS, &
            ALLOCATE(MONTH_PUT_POSITION(NUM_TRANSACTIONS, &
            ALLOCATE(ANNUAL_PUT_POSITION(NUM_TRANSACTIONS, &
            ALLOCATE(STORAGE_POSITION(NUM_TRANSACTIONS, &
            ALLOCATE(BATTERY_POSITION(NUM_TRANSACTIONS, &
            ALLOCATE(LF_PUT_POSITION(NUM_TRANSACTIONS, &
            ALLOCATE(INTER_PUT_POSITION(NUM_TRANSACTIONS, &
            ALLOCATE(TRANS_E_P_INDEX(MAX_TRANS_GROUP_NUM))
            ALLOCATE(TRANS_EP_2_TRANS_GROUPS(MAX_TRANS_GROUP_NUM))
            ALLOCATE(TRANS_EP_2_TG(MAX_TRANS_GROUP_NUM))
            ALLOCATE(YEARS_BEG_DAY_IN_MO(NUM_TRANSACTIONS,0:12))
            ALLOCATE(YEARS_END_DAY_IN_MO(NUM_TRANSACTIONS,0:12))
            ALLOCATE(RPS_PROGRAM_NUMBER(NUM_TRANSACTIONS), &
            ALLOCATE(FISCAL_ENERGY_COST(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_ENERGY(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_CAPACITY(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_ENERGY_REVENUE(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_TRANS_HOURS(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_PRODUCT_HOURS(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_PRODUCT_DAYS(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_PRODUCT_MONTHS(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_STRIKES(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_ACTIVE_IN_YEAR_INDEX(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_ACTIVE_IN_YEAR(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_TRANSACTION_COST(NUM_TRANSACTIONS))
            ALLOCATE(FISCAL_TRANSACTION_REVENUE(NUM_TRANSACTIONS))
         ALLOCATE(MONTHLY_ENERGY_COST(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_ENERGY(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_CHARGE(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_ENR_FOR_REV(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_ENR_FOR_EXP(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_CAPACITY(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_ENERGY_REVENUE(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_AC_REVENUE(0:MAX_ASSET_CLASS_GROUPS,4,0:12))
         ALLOCATE(MONTHLY_AC_REVENUE_ENERGY( &
         ALLOCATE(MONTHLY_AC_EXPENSE(0:MAX_ASSET_CLASS_GROUPS,4,0:12))
         ALLOCATE(MONTHLY_AC_EXPENSE_ENERGY( &
         ALLOCATE(MONTHLY_TRANS_HOURS(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_PRODUCT_HOURS(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_PRODUCT_DAYS(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_PRODUCT_MONTHS(NUM_TRANSACTIONS))
         ALLOCATE(MONTHLY_STRIKES(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_TRANSACTION_COST(NUM_TRANSACTIONS,0:12))
         ALLOCATE(MONTHLY_TRANSACTION_REVENUE(NUM_TRANSACTIONS,0:12))
         ALLOCATE(STRIKES_AVAILABLE(NUM_TRANSACTIONS))
         ALLOCATE(STRIKES_REQUIRED(NUM_TRANSACTIONS))
            ALLOCATE(MONTHLY_CT_GROUP_REPORT(0:12,0:MAX_MONTHLY_GROUPS, &
         ALLOCATE(HRLY_TG_SCEN_ELECT_MULT(744,12,R_TG))
         ALLOCATE(OBS(PRICE_POINTS,R_MAX_TRANS_GROUPS)) ! DON'T NEED MONTHLY
         ALLOCATE(LPROB(PRICE_POINTS,R_MAX_TRANS_GROUPS)) ! DON'T NEED MONTHLY
         ALLOCATE(LODDUR(PRICE_POINTS,R_MAX_TRANS_GROUPS,13)) !  DONE.
         ALLOCATE(CUM_HOURS(PRICE_POINTS,R_MAX_TRANS_GROUPS,13)) ! DONE.
         ALLOCATE(CUM_REVENUE(PRICE_POINTS,R_MAX_TRANS_GROUPS,13)) ! NEED MONTHLY
         ALLOCATE(ENERGY(PRICE_POINTS,R_MAX_TRANS_GROUPS)) ! DON'T NEED MONTHLY
         ALLOCATE(TRANS_GROUP_POSITION(-1:MAX_TRANS_GROUP_NUMBER))
         ALLOCATE(SELLER_TRANSACTION_GROUP(MAX_PATHS))
         ALLOCATE(LONG_PATH_PATH(MAX_PATHS))
         ALLOCATE(ACTIVE_PATH_FOR_LONG_PATH(MAX_PATHS))
         ALLOCATE(BELONGS_TO_A_LONG_PATH(MAX_PATHS))
         ALLOCATE(BUYER_TRANSACTION_GROUP(MAX_PATHS))
         ALLOCATE(PATH_PERCENT(MAX_PATHS))
         ALLOCATE(WHEEL_PATH(MAX_PATHS,MAX_WHEELS))
         ALLOCATE(PATHS_PER_PAIR(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(LONG_PATH_FOR_PAIR(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(HOUR_LONG_PATH_FOR_PAIR(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(HOUR_PATHS_PER_PAIR(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(HOUR_PATH_FOR_LONG_PATH(MAX_PATHS))
         ALLOCATE(HOUR_WHEEL_PATH(MAX(INT(1,2),MAX_HOURLY_LONG_PATHS), &
         ALLOCATE(PATHS_INDEX(-1:NUM_TRANS_GROUPS,-1:NUM_TRANS_GROUPS, &
         ALLOCATE(HOUR_PATHS_INDEX( &
         ALLOCATE(TIES_PER_PAIR(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(TIE_INDEX(-1:NUM_TRANS_GROUPS,-1:NUM_TRANS_GROUPS, &
         ALLOCATE(TIE_WHEEL_INDEX(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(SEASON_PATH_LIMIT(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(HOUR_PATH_LIMIT(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(HOUR_PATH_MW(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(SAVE_HOUR_PATH_LIMIT(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(HOUR_TIE_LOADING(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(DAILY_TIE_LOADING(MAX_PATHS,24))
         ALLOCATE(DAILY_TIE_CONSTRAINT(MAX_PATHS,24))
         ALLOCATE(PATH_NAME(MAX_PATHS))
         ALLOCATE(LONG_PATH_NAME(MAX_PATHS))
         ALLOCATE(PATH_WHEEL_RATE(MAX_PATHS))
         ALLOCATE(PATH_SPREAD(MAX_PATHS))
         ALLOCATE(PATH_OWNER(MAX_PATHS))
         ALLOCATE(PATH_KV_RATING(MAX_PATHS))
         ALLOCATE(PATH_INDUCTANCE(MAX_PATHS))
         ALLOCATE(PATH_WHEEL_MULT(MAX_PATHS))
         ALLOCATE(PATH_SPREAD_MULT(MAX_PATHS))
         ALLOCATE(PATH_SPREAD_OFF_MULT(MAX_PATHS))
         ALLOCATE(PATH_WHEEL_OFF_MULT(MAX_PATHS))
         ALLOCATE(MARKET_PRICE_ID(MAX_PATHS))
         ALLOCATE(SCENARIO_NUM(MAX_PATHS))
         ALLOCATE(MARKET_PRICE_DELTA(MAX_PATHS))
         ALLOCATE(TRANS_LINE_CONSTRAINT(MAX_PATHS))
         ALLOCATE(PEAK_PRICE_DELTA_MULT(MAX_PATHS))
         ALLOCATE(OFF_PEAK_PRICE_DELTA_MULT(MAX_PATHS))
         ALLOCATE(TRANS_LINE_INDEX(MAX_PATHS))
         ALLOCATE(GRX_ID(MAX_PATHS))
         ALLOCATE(TG_USED_IN_PATH(-1:MAX_TRANS_GROUP_NUMBER))
         ALLOCATE(REVERSE_PATH(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(MULTI_AREA_MONTH_PRICE(R_HOURS_IN_MONTH,TEMP_I2))
         ALLOCATE(SELL_BEG_FO_HR_TL(ACTIVE_PATH_NUMBER))
         ALLOCATE(SELL_END_FO_HR_TL(ACTIVE_PATH_NUMBER))
         ALLOCATE(MULTI_AREA_BUY_MONTH_PRICE(R_HOURS_IN_MONTH,TEMP_I2))
         ALLOCATE(BUY_BEG_FO_HR_TL(ACTIVE_PATH_NUMBER))
         ALLOCATE(BUY_END_FO_HR_TL(ACTIVE_PATH_NUMBER))
         ALLOCATE(TRANS_GROUP_POSITION(-1:MAX_TRANS_GROUP_NUMBER))
         ALLOCATE(CONSTRAINT_ID(MAX_CONSTRAINTS))
         ALLOCATE(SEASON(MAX_CONSTRAINTS))
         ALLOCATE(MW_LIMIT(MAX_CONSTRAINTS))
         ALLOCATE(FROM_AREA(MAX_CONSTRAINTS,MAX_CONSTRAINT_AREAS))
         ALLOCATE(TO_AREA(MAX_CONSTRAINTS,MAX_CONSTRAINT_AREAS))
         ALLOCATE(PEAK_MULT(MAX_CONSTRAINTS))
         ALLOCATE(OFF_PEAK_MULT(MAX_CONSTRAINTS))
         ALLOCATE(FORCED_OUTAGE_RATE(MAX_CONSTRAINTS))
         ALLOCATE(FORCED_OUTAGE_DERATE_MW(MAX_CONSTRAINTS))
         ALLOCATE(TRANS_LINE_POSITION(0:MAX_TRANS_LINE_INDEX))
         ALLOCATE(CONSTRAINT_PERCENT(MAX_CONSTRAINTS))
         ALLOCATE(CapTransMultiplier(0:NUM_TRANS_GROUPS, &
         ALLOCATE(CONSTRAINTS_PER_PAIR( &
         ALLOCATE(LOCAL_SEASON(MAX_CONSTRAINTS))
         ALLOCATE(CONSTRAINTS_INDEX( &
         ALLOCATE(TIES_PER_PAIR(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(TIE_INDEX(-1:NUM_TRANS_GROUPS,-1:NUM_TRANS_GROUPS, &
         ALLOCATE(TIE_WHEEL_INDEX(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(SEASON_CONSTRAINT_LIMIT( &
         ALLOCATE(HOUR_CONSTRAINT_LIMIT( &
         ALLOCATE(HOUR_TIE_LOADING(-1:NUM_TRANS_GROUPS, &
         ALLOCATE(VECTOR_VALUES(ACTIVE_VECTORS,AVAIL_DATA_YEARS), &
         ALLOCATE(   TEMP_TRANS_CLASS_POINTER(0:1023), &
      ALLOCATE(TEMP_TRANS_CLASS_POINTER(0:1023), &
            ALLOCATE( &
      allocate(z(nCases))
      allocate(OrgOrder(nCases))
      allocate(OrgOrder(nCases))
         ALLOCATE(   TEMP_TRANS_CLASS_POINTER(0:1023), &
      ALLOCATE(TEMP_TRANS_CLASS_POINTER(0:1023), &
            ALLOCATE( &
            ALLOCATE( &
         ALLOCATE( &
      ALLOCATE(CAPACITY_ADDER(0:TRANS_GROUPS_RECORDS), &
            ALLOCATE( &
         ALLOCATE (USER_DAY_DATA(HOURS_PER_DAY,USER_DAYS_IN_MONTH, &
         ALLOCATE(CF_USER_DAY_DATA(24,7,R_MAX_USER_ID))
      allocate( &
            ALLOCATE( DEPTH_PRICE(DEPTH_MARKET_INTERVALS, &
         ALLOCATE(   TEMP_TRANS_CLASS_POINTER(0:1023), &
      ALLOCATE(   TEMP_TRANS_CLASS_POINTER(0:1023), &
            ALLOCATE(TRANSACTION_NAME(NUM_TRANSACTIONS), &
            ALLOCATE(CONTRACT_BEGIN_DATE(NUM_TRANSACTIONS), &
            ALLOCATE(TRANSPORTATION_BASIS(NUM_TRANSACTIONS), &
            ALLOCATE(BEGIN_DAY_IN_MONTH(NUM_TRANSACTIONS), &
         ALLOCATE( &
            ALLOCATE( &
            ALLOCATE(REGIONAL_VARIABLE_ACTIVE(NUM_SCEN_VAR), &
            ALLOCATE( &
         ALLOCATE(REPORT_DATA(0:MAX_COMP_ID,0:MAX_ACCOUNTS_TRACKED,0:15,0:12,0:30), &               
         ALLOCATE(OUT_RECORD(0:MAX_ACCOUNTS_TRACKED,PLANT_BAL_REPT_COLS))
         ALLOCATE(RATE_CODE_LIST(0:NUM_RATE_TABLES), &
         ALLOCATE(TEMP_ASSET_CLASS_POINTER(1024))
            ALLOCATE(BC_ASSET_CLASS_POINTER(MAX_BC_CLASS_ID_NUM))
         ALLOCATE(WVPA_TRACKED_EXPENSES(0:12,30,0:4), &
            ALLOCATE(ACTUAL_VALUES(12,7,200), &
