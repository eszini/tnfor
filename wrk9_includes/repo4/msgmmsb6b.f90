!******************************************************************
!     MSGMMSB6B.FOR
!     Copyright(c)  2000
!
!     Created: 8/5/2003 3:21:35 PM
!     Author : MARK S GERBER
!     Last change: MSG 1/9/2012 2:44:35 PM
!     ******************************************************************
!***********************************************************************
      SUBROUTINE TALLY_RESULTS_INFO(R_VARIABLE_NUMBER,VARIABLES_IN,VARIABLES_OUT)
!***********************************************************************
!
      INTEGER (KIND=2) :: R_VARIABLE_NUMBER
      REAL (KIND=4) :: VARIABLES_IN(0:R_VARIABLE_NUMBER),VARIABLES_OUT(0:R_VARIABLE_NUMBER)
      INTEGER (KIND=2) :: I
!
         VARIABLES_OUT = VARIABLES_OUT + VARIABLES_IN

      RETURN
!***********************************************************************
      ENTRY INTRA_COMPANY_ADJUSTMENT(R_VARIABLE_NUMBER,VARIABLES_IN,VARIABLES_OUT)
!***********************************************************************
         VARIABLES_OUT = VARIABLES_OUT - VARIABLES_IN

      RETURN
!***********************************************************************
      ENTRY SUB_CONSOLIDATING_ADJUSTMENTS(R_VARIABLE_NUMBER,VARIABLES_IN,VARIABLES_OUT)
!***********************************************************************
         VARIABLES_OUT = VARIABLES_OUT - VARIABLES_IN

      RETURN
!***********************************************************************
      ENTRY PASS_LEVEL_2_VARS(R_VARIABLE_NUMBER,VARIABLES_IN,VARIABLES_OUT)
!***********************************************************************
         VARIABLES_OUT = VARIABLES_IN
         VARIABLES_IN = 0.

      RETURN
!***********************************************************************
      ENTRY PASS_PARENT_2_SBU_TOTALS(R_VARIABLE_NUMBER,VARIABLES_IN,VARIABLES_OUT)
!***********************************************************************
         VARIABLES_OUT = VARIABLES_IN

      RETURN
      END
!***********************************************************************
      FUNCTION LOAD_MASTER_CLASS_LIST(MAX_CLASS_NUM,TEMP_LIST,MASTER_CLASS_LIST)
!***********************************************************************
!
      INTEGER (KIND=2) :: LOAD_MASTER_CLASS_LIST,I
      INTEGER (KIND=2) :: MAX_CLASS_NUM,TEMP_LIST(MAX_CLASS_NUM),MASTER_CLASS_LIST(0:MAX_CLASS_NUM)
!
         LOAD_MASTER_CLASS_LIST = 0
         DO I = 1, MAX_CLASS_NUM 
            IF(TEMP_LIST(I) /= 0) THEN
               MASTER_CLASS_LIST(I) = 1
               LOAD_MASTER_CLASS_LIST = LOAD_MASTER_CLASS_LIST + 1
            ENDIF
         ENDDO
      RETURN
      END
!***********************************************************************
      SUBROUTINE SET_NOT_AVAILABLE_VALUES(VARIABLE)
!***********************************************************************
!           
      REAL (KIND=4) :: VARIABLE(0:*)
      REAL (KIND=4) :: NOT_AVAIL
      PARAMETER(NOT_AVAIL=-999999.)
!      
! CONSOLIDATING AND INTRA NA
!
!        VARIABLE(59) = NOT_AVAIL ! Average Equity
         VARIABLE(62) = NOT_AVAIL ! ASSET_CLASS_RATE_BASE
         VARIABLE(141) = NOT_AVAIL ! STATE_TAX_RATE*100. 
         VARIABLE(213) = NOT_AVAIL ! FEDERAL_TAX_RATE*100.  
      ENTRY SET_SUBSIDARY_TOTALS_NA(VARIABLE)
         VARIABLE(58) = NOT_AVAIL ! Return on Equity
         VARIABLE(59) = NOT_AVAIL ! Average Equity
         VARIABLE(57) = NOT_AVAIL ! Dividend Payout (%)
         VARIABLE(61) = NOT_AVAIL ! RETURN_ON_RATEBASE
         VARIABLE(342) = NOT_AVAIL ! FED_TAX_CREDIT_PASSED_UP
         VARIABLE(371) = NOT_AVAIL ! SEC_29_CREDITS_PASSED_UP
         VARIABLE(372) = NOT_AVAIL ! SEC_42_CREDITS_PASSED_UP
         VARIABLE(375) = NOT_AVAIL ! UNUSED_FED_TAX_CREDIT
         VARIABLE(347) = NOT_AVAIL ! STATE_TAX_CREDIT_PASSED_UP
         VARIABLE(223) = NOT_AVAIL ! EMBED_COST_CAPITAL_W_STD
         VARIABLE(224) = NOT_AVAIL ! EMBED_COST_CAPITAL_WO_STD
         VARIABLE(396) = NOT_AVAIL ! NET_TAX_EMBED_COST_CAPTL_W_STD
         VARIABLE(397) = NOT_AVAIL ! NET_TAX_EMBED_COST_CAPTL_WO_STD
         VARIABLE(226) = NOT_AVAIL ! ANNUALIZED_EQUITY_COST

      ENTRY SET_SUBSIDARY_NA(VARIABLE)
         VARIABLE(51) = NOT_AVAIL ! Book Value Per Share
         VARIABLE(52) = NOT_AVAIL ! Year-end Market Price Per Share
         VARIABLE(303) = NOT_AVAIL ! Average Share Price
         VARIABLE(53) = NOT_AVAIL ! Average Shares Outstanding
         VARIABLE(299) = NOT_AVAIL ! Year-end Shares Outstanding
         VARIABLE(54) = NOT_AVAIL ! Market to Book Ratio
         VARIABLE(55) = NOT_AVAIL ! Earnings per Share ($)
         VARIABLE(56) = NOT_AVAIL ! Dividends per Share ($)
!
      ENTRY SET_SUBSIDARY_VALUES_AND_NA(VARIABLE)
         IF(VARIABLE(53) == 0.) THEN
            VARIABLE(51) = NOT_AVAIL ! Book Value Per Share
            VARIABLE(52) = NOT_AVAIL ! Year-end Market Price Per Share
            VARIABLE(303) = NOT_AVAIL ! Average Share Price
            VARIABLE(55) = NOT_AVAIL ! Earnings per Share ($)
            VARIABLE(56) = NOT_AVAIL ! Dividends per Share ($)
         ENDIF

!
      RETURN
      END
!***********************************************************************
      SUBROUTINE ADD_SBU_REVENUES_AND_EXPENSES(SBU_VARIABLES,VARIABLE)
!***********************************************************************
!
      INTEGER (KIND=2) :: I
      REAL (KIND=4) :: VARIABLE(0:*),SBU_VARIABLES(0:*)
!
! INCOME STATEMENT VARIABLES
!
         VARIABLE(0:20) = SBU_VARIABLES(0:20) + VARIABLE(0:20)
         VARIABLE(470) = SBU_VARIABLES(470) + VARIABLE(470)  ! TRANSACT_MARKET_PURCHASE
         VARIABLE(471) = SBU_VARIABLES(471) + VARIABLE(471)  ! TRANSACT_MARKET_REVENUES
         VARIABLE(472) = SBU_VARIABLES(472) + VARIABLE(472)  ! OTHER_PURCHASE_POWER_EXPENSE
         VARIABLE(563) = SBU_VARIABLES(563) + VARIABLE(563)  ! COMPETITIVE_SALES_REVENUE
         VARIABLE(564) = SBU_VARIABLES(564) + VARIABLE(564)  ! UTILITY_SALES_REVENUE
         VARIABLE(631) = SBU_VARIABLES(631) + VARIABLE(631)  ! ICAP REVENUES
         VARIABLE(671:676) = SBU_VARIABLES(671:676) + VARIABLE(671:676)  ! NON_REG_REVENUES-10-15
         DO I = 155, 208
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I)
         ENDDO
         DO I = 321, 338
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! EXPENSES & REVENUES
         ENDDO
         DO I = 421, 426
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! UI adds
         ENDDO
         DO I = 449, 458
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! Power Derivatives
         ENDDO
         DO I = 497, 501
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! Amortization variables
         ENDDO
         DO I = 502, 510
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! Ameren varialbes
         ENDDO
         DO I = 561, 562
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! Ameren varialbes
         ENDDO
         DO I = 511, 560
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! FE Report Variables
         ENDDO
         DO I = 581, 625
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! FE Report Variables
         ENDDO
         DO I = 644, 654
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! FE Report Variables
         ENDDO
         DO I = 655, 658
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! Fed and State DR taxes
         ENDDO
         DO I = 660, 667
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! Fed and State DR taxes
         ENDDO

         DO I = 692, 703
            VARIABLE(I) = SBU_VARIABLES(I) + VARIABLE(I) ! Fuel Derivatives
         ENDDO
!
!
! VARIABLES 626-COMMON SHARES ISSUED THIS PERIOD; AND 627-STD INTEREST RATES DO NOT
! GET SUMMED
!
         VARIABLE(758) = SBU_VARIABLES(758) + VARIABLE(758)  ! wvpa_prop_txs_n_pwr_cstS
         VARIABLE(380) = SBU_VARIABLES(380) + VARIABLE(380)  ! CAPACITY_SALES_REVENUE
         VARIABLE(382) = SBU_VARIABLES(382) + VARIABLE(382)  ! GOVERNMENT_SALES_REVENUE
         VARIABLE(474) = SBU_VARIABLES(474) + VARIABLE(474)  ! PGA Revenues
         VARIABLE(32) = SBU_VARIABLES(32) + VARIABLE(32)     ! +Deferred Revenues
         VARIABLE(33) = SBU_VARIABLES(33) + VARIABLE(33)     ! +Other Income
         VARIABLE(35) = SBU_VARIABLES(35) + VARIABLE(35)     ! -BTL Expenses
         VARIABLE(37) = SBU_VARIABLES(37) + VARIABLE(37)     ! +AFUDC Equity
         VARIABLE(41) = SBU_VARIABLES(41) + VARIABLE(41)     ! +AFUDC Borrowed 
         VARIABLE(43) = SBU_VARIABLES(43) + VARIABLE(43)     ! +Subsidiary Income
         VARIABLE(44) = SBU_VARIABLES(44) + VARIABLE(44)     ! -Extraordinary Items
         VARIABLE(50) = SBU_VARIABLES(50) + VARIABLE(50)     ! ITC Amortized
         VARIABLE(60) = SBU_VARIABLES(60) + VARIABLE(60)     ! -Lease Expenses
         VARIABLE(393) = SBU_VARIABLES(393) + VARIABLE(393)  ! DEFERRED_FUEL_EXPENSE
         VARIABLE(219) = SBU_VARIABLES(219) + VARIABLE(219)  ! OWNED_NF_BURN),
         VARIABLE(227) = SBU_VARIABLES(227) + VARIABLE(227)  ! NF_TAX_EXPENSE),
         VARIABLE(229) = SBU_VARIABLES(229) + VARIABLE(229)  ! NUC_FUEL_OWNED_BURN),
         VARIABLE(230) = SBU_VARIABLES(230) + VARIABLE(230)  ! NUC_FUEL_LEASED_BURN)
         VARIABLE(359) = SBU_VARIABLES(359) + VARIABLE(359)  ! NUCLEAR_FUEL_LEASE_PAYMENTS
         VARIABLE(231) = SBU_VARIABLES(231) + VARIABLE(231)  ! NF_NON_CASH_EXPENSE),
         VARIABLE(232) = SBU_VARIABLES(232) + VARIABLE(232)  ! -DOE Disposal
         VARIABLE(233) = SBU_VARIABLES(233) + VARIABLE(233)  ! -Decommissioning
         VARIABLE(234) = SBU_VARIABLES(234) + VARIABLE(234)  ! NUC_FUEL_TOTAL_BURN),
         VARIABLE(235) = SBU_VARIABLES(235) + VARIABLE(235)  ! NET_OF_TAX_NUCL_FUND_RETURN),
         VARIABLE(236) = SBU_VARIABLES(236) + VARIABLE(236)  ! NF_SL_DEF_TAX_DEP),
         VARIABLE(237) = SBU_VARIABLES(237) + VARIABLE(237)  ! NF_CASH_EXPENSE),
         VARIABLE(238) = SBU_VARIABLES(238) + VARIABLE(238)  ! NF_DEFERRED_TAX_BASIS),
         VARIABLE(296) = SBU_VARIABLES(296) + VARIABLE(296)  ! NF_CAPITIALIZED_INTEREST),
         VARIABLE(297) = SBU_VARIABLES(297) + VARIABLE(297)  ! NF_ATL_AMORTIZATION),
         VARIABLE(298) = SBU_VARIABLES(298) + VARIABLE(298)  ! NF_AFUDC_ON_CASH),
         VARIABLE(252) = SBU_VARIABLES(252) + VARIABLE(252)  ! Base Revenues
         VARIABLE(253) = SBU_VARIABLES(253) + VARIABLE(253)  ! Operating Method Adjustment
         VARIABLE(379) = SBU_VARIABLES(379) + VARIABLE(379)  ! Operating Method Adjustment
         VARIABLE(260) = SBU_VARIABLES(260) + VARIABLE(260)  ! Post Retirement Medical Fund Payment
         VARIABLE(239) = SBU_VARIABLES(239) + VARIABLE(239)  ! CAWTABA & CP&L REVENUE
         VARIABLE(307) = SBU_VARIABLES(307) + VARIABLE(307)  ! GAS REVENUES

!
! CASH STUFF
!
         VARIABLE(110) = SBU_VARIABLES(110) + VARIABLE(110)  ! FA_CASH
         VARIABLE(111) = SBU_VARIABLES(111) + VARIABLE(111)  ! NF_CASH
         VARIABLE(112) = SBU_VARIABLES(112) + VARIABLE(112)  ! INVESTMENT_SALVAGE_OTHER
         VARIABLE(114) = SBU_VARIABLES(114) + VARIABLE(114)  ! CAPITIALIZED_LEASE_ADDITIONS
         VARIABLE(394) = SBU_VARIABLES(394) + VARIABLE(394)  ! CASH_ADDITIONS_2_FUEL_INVENTORY
         VARIABLE(395) = SBU_VARIABLES(395) + VARIABLE(395)  ! EXPENSING_FUEL_INVENTORY
         VARIABLE(717) = SBU_VARIABLES(717) + VARIABLE(717)  ! CASH_ADDS_2_MATRIALS_INVENTORY
         VARIABLE(718) = SBU_VARIABLES(718) + VARIABLE(718)  ! EXPENSING_MATRIALS_INVENTORY
         VARIABLE(719) = SBU_VARIABLES(719) + VARIABLE(719)  ! CASH_ADDS_2_GAS_INVENTORY
         VARIABLE(720) = SBU_VARIABLES(720) + VARIABLE(720)  ! EXPENSING_GAS_INVENTORY
         VARIABLE(116) = SBU_VARIABLES(116) + VARIABLE(116)  ! LEASED_NF_BURN
         VARIABLE(117) = SBU_VARIABLES(117) + VARIABLE(117)  ! NUCL_DECOM_FUND
         VARIABLE(126) = SBU_VARIABLES(126) + VARIABLE(126)  ! NEW_SUBSIDIARY_INVESTMENT
         VARIABLE(399) = SBU_VARIABLES(399) + VARIABLE(399)  ! NEW_SUB_INVESTMENT
         VARIABLE(486) = SBU_VARIABLES(486) + VARIABLE(486)  ! GOODWILL_OF_NEW_SUB_INVESTMENT
         VARIABLE(487) = SBU_VARIABLES(487) + VARIABLE(487)  ! TOTAL_ACQUISION_COST

         VARIABLE(127) = SBU_VARIABLES(127) + VARIABLE(127)  ! DEFERRED_EXPENSE_CASH
         VARIABLE(220) = SBU_VARIABLES(220) + VARIABLE(220)  ! SL_TAX_DEPRECIATION
         VARIABLE(228) = SBU_VARIABLES(228) + VARIABLE(228)  ! CONSTRUCTION_TAX_EXPENSE
         VARIABLE(249) = SBU_VARIABLES(249) + VARIABLE(249)  ! NF_TAX_DEPRECIATION
         VARIABLE(250) = SBU_VARIABLES(250) + VARIABLE(250)  ! NF_ENTERING_SERVICE
         VARIABLE(356) = SBU_VARIABLES(356) + VARIABLE(356)  ! salvage TRANSACTIONS
         VARIABLE(290) = SBU_VARIABLES(290) + VARIABLE(290)  ! RETIREMENT_MEDICAL_PAYMENTS
         VARIABLE(357) = SBU_VARIABLES(357) + VARIABLE(357)  ! OTHER_INCOME_NET_OF_TAX
         VARIABLE(125) = SBU_VARIABLES(125) + VARIABLE(125)  ! CUSTOMER_DEPOSITS
!
! TAX STUFF
!
         VARIABLE(129) = SBU_VARIABLES(129) + VARIABLE(129)  ! CAPITIALIZED_INTEREST
         VARIABLE(130) = SBU_VARIABLES(130) + VARIABLE(130)  ! INCOME_TAX_DEPRECIATION
         VARIABLE(210) = SBU_VARIABLES(210) + VARIABLE(210)  ! TAX_DEDUCTIBLE_EXPENSES_BOOK
         VARIABLE(342) = SBU_VARIABLES(342) + VARIABLE(342)  ! FED_TAX_CREDIT_PASSED_UP
         VARIABLE(371) = SBU_VARIABLES(371) + VARIABLE(371)  ! SEC 29 FED_TAX_CREDIT_PASSED_UP
         VARIABLE(372) = SBU_VARIABLES(372) + VARIABLE(372)  ! SEC 42 FED_TAX_CREDIT_PASSED_UP
         VARIABLE(347) = SBU_VARIABLES(347) + VARIABLE(347)  ! FED_TAX_CREDIT_PASSED_UP
! 
         VARIABLE(83) = SBU_VARIABLES(83) + VARIABLE(83)  ! OTHER_LT_LIABILITY_BAL 1/18/98
         VARIABLE(637) = SBU_VARIABLES(637) + VARIABLE(637)  ! FASB143_ARO_LIABLILITY_BAL
!
! RATE BASE
!
         VARIABLE(145) = SBU_VARIABLES(145) + VARIABLE(145)  ! RATE_BASE_DEFERRED_DEBITS),
         VARIABLE(147) = SBU_VARIABLES(147) + VARIABLE(147)  ! RATE_BASE_NUC_FUEL),
      RETURN
!
!
      ENTRY ADD_SBU_BALANCE_SHEET_RB(SBU_VARIABLES,VARIABLE)
! BALANCE SHEET-ASSETS
!         
         VARIABLE(63) = SBU_VARIABLES(63) + VARIABLE(63)  ! GROSS_PLANT_VALUE),
         VARIABLE(64) = SBU_VARIABLES(64) + VARIABLE(64)  ! CWIP),
         VARIABLE(65) = SBU_VARIABLES(65) + VARIABLE(65)  ! GROSS_PLANT_VALUE_PLUS_CWIP),
         VARIABLE(66) = SBU_VARIABLES(66) + VARIABLE(66)  ! CUMULATIVE_DEPRECIATION),
         VARIABLE(67) = SBU_VARIABLES(67) + VARIABLE(67)  ! NET_NF_VALUE),
         VARIABLE(68) = SBU_VARIABLES(68) + VARIABLE(68)  ! UTILITY_PLANT_NET),
         VARIABLE(69) = SBU_VARIABLES(69) + VARIABLE(69)  ! ASSETS_OTHER),
         VARIABLE(91) = SBU_VARIABLES(91) + VARIABLE(91)  ! SUBSIDIARY_INVESTMENT),
         VARIABLE(92) = SBU_VARIABLES(92) + VARIABLE(92)  ! LEASES_CAPITIALZIED),
         VARIABLE(70) = SBU_VARIABLES(70) + VARIABLE(70)  ! DECOMMISIONING_FUND_BAL),
         VARIABLE(71) = SBU_VARIABLES(71) + VARIABLE(71)  ! DD_BALANCE_NET),
         VARIABLE(72) = SBU_VARIABLES(72) + VARIABLE(72)  ! DEFERRED_REVENUES_CUM),
         VARIABLE(73) = SBU_VARIABLES(73) + VARIABLE(73)  ! DEFERRED_TAXES_DR_BAL),
         VARIABLE(462) = SBU_VARIABLES(462) + VARIABLE(462)  ! GOODWILL
         VARIABLE(463) = SBU_VARIABLES(463) + VARIABLE(463)  ! CLASS_REGULATORY_ASSETS
         VARIABLE(464) = SBU_VARIABLES(464) + VARIABLE(464)  ! FASB_109
         VARIABLE(465) = SBU_VARIABLES(465) + VARIABLE(465)  ! FASB_133
         VARIABLE(628) = SBU_VARIABLES(628) + VARIABLE(628)  ! debt interest expense
         VARIABLE(629) = SBU_VARIABLES(629) + VARIABLE(629)  ! debit interest expense
         VARIABLE(466) = SBU_VARIABLES(466) + VARIABLE(466)  ! OTHER_NET_DEFERRALS
         VARIABLE(390) = SBU_VARIABLES(390) + VARIABLE(390)  ! CLASS_ACCOUNTS_RECEIVABLE
         VARIABLE(391) = SBU_VARIABLES(391) + VARIABLE(391)  ! CLASS_FUEL_INVENTORY
         VARIABLE(467) = SBU_VARIABLES(467) + VARIABLE(467)  ! DEFERRED_PURCHASED_GAS
         VARIABLE(468) = SBU_VARIABLES(468) + VARIABLE(468)  ! GAS_IN_STORAGE
         VARIABLE(469) = SBU_VARIABLES(469) + VARIABLE(469)  ! MATERIALS_N_SUPPLIES
         VARIABLE(392) = SBU_VARIABLES(392) + VARIABLE(392)  ! CLASS_DEFERRED_FUEL_BALANCE
         VARIABLE(394) = SBU_VARIABLES(394) + VARIABLE(394)  ! CASH_ADDITIONS_2_FUEL_INVENTORY
         VARIABLE(395) = SBU_VARIABLES(395) + VARIABLE(395)  ! EXPENSING_FUEL_INVENTORY
         VARIABLE(717) = SBU_VARIABLES(717) + VARIABLE(717)  ! CASH_ADDS_2_MATRIALS_INVENTORY
         VARIABLE(718) = SBU_VARIABLES(718) + VARIABLE(718)  ! EXPENSING_MATRIALS_INVENTORY
         VARIABLE(719) = SBU_VARIABLES(719) + VARIABLE(719)  ! CASH_ADDS_2_GAS_INVENTORY
         VARIABLE(720) = SBU_VARIABLES(720) + VARIABLE(720)  ! EXPENSING_GAS_INVENTORY

!
! BALANCE SHEET-LIABILITIES
!         

         VARIABLE(83)  = SBU_VARIABLES(83) + VARIABLE(83)    ! OTHER_LT_LIABILITY_BAL
         VARIABLE(85)  = SBU_VARIABLES(85) + VARIABLE(85)    ! CUSTOMER_DEPOSITS_BALANCE)
         VARIABLE(86)  = SBU_VARIABLES(86) + VARIABLE(86)    ! CIAC_BAL),
         VARIABLE(87)  = SBU_VARIABLES(87) + VARIABLE(87)    ! DEF_TAX_CR_BAL),
         VARIABLE(88)  = SBU_VARIABLES(88) + VARIABLE(88)    ! DEF_ITC_BAL),
         VARIABLE(411) = SBU_VARIABLES(411) + VARIABLE(411)  ! Accrued Pension
         VARIABLE(412) = SBU_VARIABLES(412) + VARIABLE(412)  ! Deferred Gains
         VARIABLE(413) = SBU_VARIABLES(413) + VARIABLE(413)  ! Storm Reserve
         VARIABLE(414) = SBU_VARIABLES(414) + VARIABLE(414)  ! Accrued Vacation Pay
!
! RATE BASE
!
         VARIABLE(143) = SBU_VARIABLES(143) + VARIABLE(143)  ! RATE_BASE_PLANT_IN_SERVICE
         VARIABLE(144) = SBU_VARIABLES(144) + VARIABLE(144)  ! RATE_BASE_DEF_TAXES
         VARIABLE(146) = SBU_VARIABLES(146) + VARIABLE(146)  ! RATE_BASE_DEFERRED_DEBITS),
         VARIABLE(147) = SBU_VARIABLES(147) + VARIABLE(147)  ! RATE_BASE_NUC_FUEL),
         VARIABLE(148) = SBU_VARIABLES(148) + VARIABLE(148)  ! RATE_BASE_CWIP),
         VARIABLE(149) = SBU_VARIABLES(149) + VARIABLE(149)  ! RATE_BASE_DEF_ITC),
         VARIABLE(150) = SBU_VARIABLES(150) + VARIABLE(150)  ! RATE_BASE_NUC_DECOM),
         VARIABLE(151) = SBU_VARIABLES(151) + VARIABLE(151)  ! RATE_BASE_CIAC),
         VARIABLE(152) = SBU_VARIABLES(152) + VARIABLE(152)  ! RATE_BASE_ASSET_NEC),
         VARIABLE(153) = SBU_VARIABLES(153) + VARIABLE(153)  ! RATE_BASE_CAPITIALIZED_LEASES)
         VARIABLE(415) = SBU_VARIABLES(415) + VARIABLE(415)  ! INCLUDED Deferred Taxes (Dr)
         VARIABLE(416) = SBU_VARIABLES(416) + VARIABLE(416)  ! INCLUDED Deferred Revenues
         VARIABLE(417) = SBU_VARIABLES(417) + VARIABLE(417)  ! EXCLUDED Pensions ($M)
         VARIABLE(418) = SBU_VARIABLES(418) + VARIABLE(418)  ! EXCLUDED Deferred Gains ($M)
         VARIABLE(419) = SBU_VARIABLES(419) + VARIABLE(419)  ! EXCLUDED Storm Reserve ($M)
         VARIABLE(420) = SBU_VARIABLES(420) + VARIABLE(420)  ! EXCLUDED Vacation Pay ($M)
      RETURN         
      END
!***********************************************************************
      FUNCTION ASSET_CLASS_LINKAGES(ASSET_CLASS,R_ASSET_CLASS_LIST,ASSET_CLASS_VECTOR,R_ASSET_ALLOCATION_LIST)
!***********************************************************************
!
      use SpinDriftLib
      use prod_arrays_dimensions
      USE SIZECOM
      SAVE
      
      INTEGER (KIND=2) :: CLASS_POINTER,VECTOR_POINTER,ASSET_CLASS,LINKED_CLASS,ASSET_CLASS_VECTOR,I
      REAL (KIND=4) :: VECTOR_ASSET_CLASSES(AVAIL_DATA_YEARS),VECTOR_CLASS_ALLOCATIONS(AVAIL_DATA_YEARS), &
             ASSET_CLASS_LIST(1024),ASSET_ALLOCATION_LIST(1024),R_ASSET_CLASS_LIST(*),R_ASSET_ALLOCATION_LIST(*)
      REAL (KIND=4) :: ASSET_ALLOCATOR
      CHARACTER (LEN=1) :: DUMMY_TYPE
      LOGICAL (KIND=1) :: ASSET_CLASS_LINKAGES,RETURN_ASSET_CLASS_LISTS
!
         ASSET_CLASS_LIST = -99.
         ASSET_ALLOCATION_LIST = 0.
         CLASS_POINTER = 1
         IF(ASSET_CLASS < 0) THEN
            CALL GET_ASSET_VAR(ABS(ASSET_CLASS),DUMMY_TYPE,VECTOR_ASSET_CLASSES)
            CALL GET_ASSET_VAR(ABS(ASSET_CLASS_VECTOR),DUMMY_TYPE ,VECTOR_CLASS_ALLOCATIONS)
            VECTOR_POINTER = 1
            DO
               ASSET_CLASS = VECTOR_ASSET_CLASSES(VECTOR_POINTER)
               ASSET_CLASS_LIST(CLASS_POINTER) = ASSET_CLASS
               ASSET_ALLOCATOR=VECTOR_CLASS_ALLOCATIONS(VECTOR_POINTER)
               ASSET_ALLOCATION_LIST(CLASS_POINTER) = ASSET_ALLOCATOR
               DO
                  CLASS_POINTER = CLASS_POINTER + 1
                  CALL GET_DEBT_LINKED_CLASS(ASSET_CLASS,LINKED_CLASS)
                  IF(LINKED_CLASS < 0 .OR. CLASS_POINTER > 1000) EXIT
                  ASSET_CLASS_LIST(CLASS_POINTER) = LINKED_CLASS
                  ASSET_ALLOCATION_LIST(CLASS_POINTER) = ASSET_ALLOCATOR
                  ASSET_CLASS = LINKED_CLASS
               ENDDO
               VECTOR_POINTER = VECTOR_POINTER + 1
               IF(VECTOR_POINTER > AVAIL_DATA_YEARS) EXIT
               IF(VECTOR_ASSET_CLASSES(VECTOR_POINTER) == 0 .OR. CLASS_POINTER >= 1000) EXIT ! AVAIL_DATA_YEARS) EXIT
            ENDDO
            ASSET_CLASS_LINKAGES = CLASS_POINTER > VECTOR_POINTER
         ELSE
            ASSET_CLASS_LIST(CLASS_POINTER) = ASSET_CLASS
            IF(ASSET_CLASS_VECTOR /= 0) THEN
               ASSET_ALLOCATOR = -ABS(ASSET_CLASS_VECTOR) ! POINTS TO A TIME VECTOR
            ELSE   
               ASSET_ALLOCATOR = 100.
            ENDIF
            ASSET_ALLOCATION_LIST(CLASS_POINTER) = ASSET_ALLOCATOR
            DO
               CLASS_POINTER = CLASS_POINTER + 1
               CALL GET_DEBT_LINKED_CLASS(ASSET_CLASS,LINKED_CLASS)
               IF(LINKED_CLASS < 0 .OR. CLASS_POINTER >= 1000) EXIT ! AVAIL_DATA_YEARS) EXIT
               ASSET_CLASS_LIST(CLASS_POINTER) = LINKED_CLASS
               ASSET_ALLOCATION_LIST(CLASS_POINTER) = ASSET_ALLOCATOR
               ASSET_CLASS = LINKED_CLASS
            ENDDO
            ASSET_CLASS_LINKAGES = CLASS_POINTER > 2
         ENDIF
         IF(CLASS_POINTER <= AVAIL_DATA_YEARS) THEN
            ASSET_CLASS_LIST(CLASS_POINTER) = -99.
            ASSET_ALLOCATION_LIST(CLASS_POINTER) = 0.
         ENDIF
         DO I = 1, CLASS_POINTER
            R_ASSET_CLASS_LIST(I) = ASSET_CLASS_LIST(I)
            R_ASSET_ALLOCATION_LIST(I) = ASSET_ALLOCATION_LIST(I)
         ENDDO
      RETURN
!***********************************************************************
      ENTRY RETURN_ASSET_CLASS_LISTS(ASSET_CLASS,R_ASSET_CLASS_LIST,ASSET_CLASS_VECTOR,R_ASSET_ALLOCATION_LIST)
!***********************************************************************
!
         VECTOR_ASSET_CLASSES = -99.
         VECTOR_CLASS_ALLOCATIONS = 0.
         CLASS_POINTER = 1
         IF(ASSET_CLASS < 0) THEN
            CALL GET_ASSET_VAR(ABS(ASSET_CLASS),DUMMY_TYPE,VECTOR_ASSET_CLASSES)
            CALL GET_ASSET_VAR(ABS(ASSET_CLASS_VECTOR),DUMMY_TYPE ,VECTOR_CLASS_ALLOCATIONS)
            DO I = 1, AVAIL_DATA_YEARS
               R_ASSET_CLASS_LIST(I) = VECTOR_ASSET_CLASSES(I)
               R_ASSET_ALLOCATION_LIST(I) = VECTOR_CLASS_ALLOCATIONS(I)
            ENDDO
            RETURN_ASSET_CLASS_LISTS = .TRUE.
         ELSE
            R_ASSET_CLASS_LIST(1) = ASSET_CLASS
            R_ASSET_CLASS_LIST(2) = -99
            IF(ASSET_CLASS_VECTOR < 0) THEN
               ASSET_ALLOCATOR = FLOAT(ASSET_CLASS_VECTOR) ! REDUCES ALLOCATION
            ELSEIF(ASSET_CLASS_VECTOR > 0) THEN
               ASSET_ALLOCATOR = -FLOAT(ASSET_CLASS_VECTOR) ! POINTS TO TIME VECTOR
            ELSE
               ASSET_ALLOCATOR = 100.
            ENDIF
            R_ASSET_ALLOCATION_LIST(1) = ASSET_ALLOCATOR
            R_ASSET_ALLOCATION_LIST(2) = 0
            RETURN_ASSET_CLASS_LISTS = .FALSE.
         ENDIF
      RETURN
      END
!***********************************************************************
      FUNCTION CURRENT_COVERAGE_RATIO(R_COVERAGE_RATIO)
!***********************************************************************
!
      SAVE
      LOGICAL (KIND=1) :: CAL_AMT_SWITCH,R_CALCULATE_AMT
      LOGICAL (KIND=1) :: USE_BUDGET_EXPENSES,R_USE_BUDGET_EXPENSES
      LOGICAL (KIND=1) :: CALCULATE_ENVIRONMENTAL_TAX,R_CALC_ENVIRONMENTAL_TAX
      LOGICAL (KIND=1) :: CURRENT_COVERAGE_RATIO
      LOGICAL (KIND=1) :: RETAIN_POST_RETIREMENT_EARNINGS,R_USE_RETAIN_POST_RETRMNT_ERNGS
      INTEGER (KIND=2) :: R_COVERAGE_RATIO
!
         CALL RETURN_CURRENT_COVERAGE_RATIO(R_COVERAGE_RATIO)
         CURRENT_COVERAGE_RATIO = .TRUE. ! R_COVERAGE_RATIO
      RETURN
      ENTRY CAL_AMT_SWITCH()
         CALL RETURN_CAL_AMT_SWITCH(R_CALCULATE_AMT)
         CAL_AMT_SWITCH = R_CALCULATE_AMT
      RETURN
      ENTRY USE_BUDGET_EXPENSES()
         CALL RETURN_USE_BUDGET_EXPENSES(R_USE_BUDGET_EXPENSES)
         USE_BUDGET_EXPENSES = R_USE_BUDGET_EXPENSES
      RETURN
      ENTRY CALCULATE_ENVIRONMENTAL_TAX()
         CALL RETURN_CALC_ENVIRONMENTAL_TAX(R_CALC_ENVIRONMENTAL_TAX)
         CALCULATE_ENVIRONMENTAL_TAX = R_CALC_ENVIRONMENTAL_TAX
      RETURN
      ENTRY RETAIN_POST_RETIREMENT_EARNINGS()
         CALL RTN_RETAIN_POST_RETRMNT_ERNGS(R_USE_RETAIN_POST_RETRMNT_ERNGS)
         RETAIN_POST_RETIREMENT_EARNINGS = R_USE_RETAIN_POST_RETRMNT_ERNGS
      RETURN
      END
!***********************************************************************
      FUNCTION REVENUE_TAX_BASIS()
!***********************************************************************
      CHARACTER (LEN=1) :: REVENUE_TAX_BASIS,R_REVENUE_TAX_BASIS
         CALL RETURN_REVENUE_TAX_BASIS(R_REVENUE_TAX_BASIS)
         REVENUE_TAX_BASIS = R_REVENUE_TAX_BASIS
      RETURN
      END
!***********************************************************************
      SUBROUTINE INIT_REPORTING_VALUE_ARRAY(R_VARIABLE_NUM)
!***********************************************************************
!
      SAVE
      REAL (KIND=4) :: REPORTING_VARIABLES(:),R_VARIABLE_VALUE(0:*)
      ALLOCATABLE :: REPORTING_VARIABLES
      INTEGER (KIND=2) :: I,NUM_ACTIVE_VARIABLES,R_VARIABLE_NUM
      REAL (KIND=4) :: PASS_THROUGH_VALUES(10)
      REAL (KIND=4) :: AI_LAGGED_GPV,AI_CLASS_CASH,AI_ANNUAL_CLASS_DEP,AI_AFUDC_ON_CASH,AI_CLASS_EXPENSE
      REAL (KIND=4) :: OPENING_INVESTMENT_BALANCE
      REAL (KIND=4) :: FA_AFUDC_RATE,NF_AFUDC_RATE,AI_AFUDC_RATE,AFUDC_BORROWED_RATE,AFUDC_ON_CASH
      REAL (KIND=4) :: TOTAL_CAPITAL,LTD_INTEREST_LESS_AFUDC
      INTEGER (KIND=2) :: COVERAGE_RATIO_TYPE
      CHARACTER (LEN=1) :: OPERATING_METHOD
      REAL (KIND=4) :: SRP_RATIO,LEASE_PAYMENTS_IN_TIER
      REAL (KIND=4) :: R_CLASS_MHW_SALES,R_ANNUAL_ECONOMY_SOLD
      REAL (KIND=4) :: NOT_AVAIL
      PARAMETER(NOT_AVAIL=-999999.)
!
! SPR VARIABLES
!
      LOGICAL (KIND=1) :: ECON_SWITCH,ECON_SALES
      REAL (KIND=4) :: SRP_FUNDS_FOR_DEBT_SERVICE,SRP_TOTAL_DEBT_SERVICE,SRP_FUNDS_AFTER_DEBT_SERVICE,SRP_FUNDS_FOR_CORP_USE, &
             SRP_NON_DISPATCH_REV,SRP_DEBT_SERVICE_COVERAGE_RATIO,CAWCD_ENERGY,SRP_TOTAL_SALES,SRP_SALES_COST, &
             SRP_OPERATING_MARGIN,SRP_AVERAGE_SALES_COST,SRP_AVERAGE_MARGIN
      REAL (KIND=8) :: GET_TOTAL_SALES_ENERGY
!
      REAL (KIND=4) :: INTEREST_COVERAGE_WITHOUT_AFDC,INTEREST_COVERAGE_WITH_AFDC,GOPINC,ITC_ITCAMT,TAXES_PAID,INTINC,OTHINC, &
             BTL_TAXES,RTEMP,LTD_STD_INTEREST,LTD_PS_RETIREMENT,COVERAGE_DRIVER_RATIO,LEASE_PAYMENT_LIMIT,DEP_AMORTIZATION, &
             NOPINC,COVERAGE_RATIO_VALUE,FUNDS_FOR_CONSTRUCTION,SUM_OPERATIONS,INTEREST
      REAL (KIND=4) :: NON_CASH_EXPENSE_ADJUSTMENTS,TAX_AND_OTHER_ADJUSTMENTS,OTHER_CASH_SOURCES,CAPITAL_REQUIREMENTS, &
                 TOTAL_CAPITAL_SERVICE_PAYMENTS
! 
      REAL (KIND=4) :: TEMP_SRP_TOTAL_SALES,SRP_OP_FIN_TARGET_D,SRP_OP_FIN_MARGIN_D,SRP_OP_FIN_TARGET_D_MWH, &
             SRP_OP_FIN_MARGIN_D_MWH,SRP_NET_FINANCING_COSTS
      INTEGER (KIND=2) :: R_RUN_YEAR
      REAL (KIND=4) :: AFDC1,INTEREST_PS_DIV
      REAL (KIND=4) :: TIMES_INT_B4_INC_TAXES_W_AFDC
      REAL (KIND=4) :: TIMES_INT_B4_INC_TAXES_WO_AFDC
      REAL (KIND=4) :: TIMES_INT_PS_B4_INC_TAX_W_AFDC
      REAL (KIND=4) :: TIMES_INT_PS_B4_INC_TAX_WO_AFDC
      REAL (KIND=4) :: MORTAGE_INDENTURE
      REAL (KIND=4) ::  ARTICLES_OF_INCORPORATION
      REAL (KIND=4) :: DIVIDEND_YIELD
      REAL (KIND=4) :: TOTAL_INCOME_TAXES
      REAL (KIND=4) :: EFFECTIVE_TAX_RATE
 
      REAL (KIND=4) :: ANNUALIZED_LTD_INTEREST
      REAL (KIND=4) :: ANNUALIZED_PS_DIVIDENDS
      REAL (KIND=4) :: ANNUALIZED_STD_INTEREST
      REAL (KIND=4) :: EMBED_COST_CAPITAL_W_STD
      REAL (KIND=4) :: EMBED_COST_CAPITAL_WO_STD
      REAL (KIND=4) :: MARKET_VALUE,DIVIDENDS_PER_SHARE
      REAL (KIND=4) :: SHARES_OUTSTANDING_YR_END
      REAL (KIND=4) :: GROSS_CASH_2_DEBT,GROSS_CASH_FLOW,TOTAL_DEBT,THE_PERCENT_OF_A_TO_B
      REAL (KIND=4) :: CAPITAL_MULTIPILER,TOTAL_CAPITIAL_BAL,SHORT_TERM_DEBT_BAL,PREFERRED_STOCK_BAL,LONG_TERM_DEBT_BAL, &
             COMMON_EQUITY_BAL,FUNDS_FROM_OPERATIONS,CONSTRUCTION_AND_NET_INVESTMENT

         OPENING_INVESTMENT_BALANCE = 0.
         NUM_ACTIVE_VARIABLES = R_VARIABLE_NUM - 1
         IF(ALLOCATED(REPORTING_VARIABLES)) DEALLOCATE(REPORTING_VARIABLES)
         ALLOCATE(REPORTING_VARIABLES(0:NUM_ACTIVE_VARIABLES))
         REPORTING_VARIABLES = 0.
      RETURN
!
!***********************************************************************
      ENTRY STORE_REPORTING_VALUES(R_VARIABLE_VALUE)
!***********************************************************************
! 

         REPORTING_VARIABLES(0:NUM_ACTIVE_VARIABLES) = R_VARIABLE_VALUE(0:NUM_ACTIVE_VARIABLES)
         CALL RETURN_CLASS_EXTERNALITY_VALUES(PASS_THROUGH_VALUES)
         CALL RETURN_AI_CLASS_VALUES(AI_LAGGED_GPV,AI_CLASS_CASH,AI_ANNUAL_CLASS_DEP,AI_AFUDC_ON_CASH,AI_CLASS_EXPENSE)
!
! ADDED TO PASS BASE AND ADJUSTMENT REVENUE INFORMATION TO COST OF SERVICE
!
         CALL STORE_REVENUE(R_VARIABLE_VALUE(0),R_VARIABLE_VALUE(1))
      RETURN
!***********************************************************************
      ENTRY RETURN_ASSET_CLASS_VALUES(R_VARIABLE_VALUE,COVERAGE_RATIO_TYPE,OPERATING_METHOD,LEASE_PAYMENTS_IN_TIER,SRP_RATIO)
!***********************************************************************
!
! RESERVE MARGIN LEVEIZING COST VARIABLES
!
         R_VARIABLE_VALUE(485) = REPORTING_VARIABLES(725)
         R_VARIABLE_VALUE(486) = REPORTING_VARIABLES(726)
         R_VARIABLE_VALUE(0) = REPORTING_VARIABLES(63) ! GPV(2)+AFDC2C(2)
         R_VARIABLE_VALUE(1) = REPORTING_VARIABLES(64) ! CWIP(2)+AFDC1C(2)-AFDC2C(2)
         R_VARIABLE_VALUE(2) = REPORTING_VARIABLES(65) ! PLANT(2)
         R_VARIABLE_VALUE(3) = REPORTING_VARIABLES(66) ! DEPCUM(2)+AFDCDP(2)
         R_VARIABLE_VALUE(4) = REPORTING_VARIABLES(67) ! NNFV(2)
         R_VARIABLE_VALUE(5) = REPORTING_VARIABLES(68) ! NPV(2)
         R_VARIABLE_VALUE(6) = REPORTING_VARIABLES(69) ! OASSET(2)
         R_VARIABLE_VALUE(576) = REPORTING_VARIABLES(91) ! SUBSIDIARY_INVESTMENT
         R_VARIABLE_VALUE(547) = REPORTING_VARIABLES(92) !  LEASE_BALANCE(2)
         R_VARIABLE_VALUE(25) = REPORTING_VARIABLES(70) ! NUC_DECOM_FUND_BAL(2)
         R_VARIABLE_VALUE(578) = REPORTING_VARIABLES(286) ! POST RETIREMENT MEDICAL FUND
         R_VARIABLE_VALUE(7) = REPORTING_VARIABLES(71) ! DDCUM-DDAMTC(2)
         R_VARIABLE_VALUE(8) = REPORTING_VARIABLES(72) ! CUM_DEF_REVENUES(2)
         R_VARIABLE_VALUE(9) = REPORTING_VARIABLES(73) ! CUMTXNORM(2)
         R_VARIABLE_VALUE(660) = REPORTING_VARIABLES(392) ! DEFERRED FUEL
         R_VARIABLE_VALUE(577) = REPORTING_VARIABLES(289) ! LONG TERM INVESTMENTS
         R_VARIABLE_VALUE(24) = REPORTING_VARIABLES(74) ! INVESTMENTS(2)
         R_VARIABLE_VALUE(661) = REPORTING_VARIABLES(391) ! FUEL INVENTORY
         R_VARIABLE_VALUE(662) = REPORTING_VARIABLES(390) ! ACCOUNTS RECEIVABLE
         R_VARIABLE_VALUE(10) =REPORTING_VARIABLES(75) !  WCCUM(2)+LINEC(2)+ABANDS(2)
         R_VARIABLE_VALUE(11) = REPORTING_VARIABLES(76) ! ASSETS
         R_VARIABLE_VALUE(12) = REPORTING_VARIABLES(77) ! CSCUM(2)
         R_VARIABLE_VALUE(13) = REPORTING_VARIABLES(78) ! REARNC(2)
         R_VARIABLE_VALUE(14) = REPORTING_VARIABLES(79) ! COMEQU(2)
         R_VARIABLE_VALUE(15) = REPORTING_VARIABLES(80) ! PSCUM(2)
         R_VARIABLE_VALUE(16) = REPORTING_VARIABLES(81) ! LTDCUM(2)
         R_VARIABLE_VALUE(17) = REPORTING_VARIABLES(82) ! CAPITL(2)
         R_VARIABLE_VALUE(18) = REPORTING_VARIABLES(83) ! OTHLTL(2)
         R_VARIABLE_VALUE(579) = REPORTING_VARIABLES(288) ! NUC DECOM LIABILITY
         R_VARIABLE_VALUE(19) = REPORTING_VARIABLES(84) ! STDCUM(2)
         R_VARIABLE_VALUE(457) = REPORTING_VARIABLES(85) ! Customer Deposits 
         R_VARIABLE_VALUE(459) = REPORTING_VARIABLES(86) ! Contributions for Construction
         R_VARIABLE_VALUE(20) = REPORTING_VARIABLES(87) ! TXDEFC(2)
         R_VARIABLE_VALUE(21) = REPORTING_VARIABLES(88) ! ITCDFC(2)
         R_VARIABLE_VALUE(580) = REPORTING_VARIABLES(287) ! POST RETIREMENT MEDICAL PAYABLE
         R_VARIABLE_VALUE(663) = REPORTING_VARIABLES(389) ! ACCOUNTS PAYABLE
         R_VARIABLE_VALUE(22) = REPORTING_VARIABLES(89) ! LINEC(2)
         R_VARIABLE_VALUE(23) = REPORTING_VARIABLES(90) ! LIABIL
! INCOME STATEMENT ITEMS
         R_VARIABLE_VALUE(581) = REPORTING_VARIABLES(252) ! BASE_REVENUE FORECAST
         R_VARIABLE_VALUE(582) = REPORTING_VARIABLES(253)+  &   ! OPT METHOD ADJUSTMENT
                                 REPORTING_VARIABLES(379) ! OPT METHOD ADJUSTMENT
         R_VARIABLE_VALUE(26) = REPORTING_VARIABLES(0) ! TOTAL BASE_REVENUE(2)
         R_VARIABLE_VALUE(27) = REPORTING_VARIABLES(1) ! ADJ_CLAUSE_REVENUE(2)
         R_VARIABLE_VALUE(28) = REPORTING_VARIABLES(2) ! INC_SALES_REVENUES
         R_VARIABLE_VALUE(29) = REPORTING_VARIABLES(3) ! OTHER_REVENUE(2)
         R_VARIABLE_VALUE(587) = REPORTING_VARIABLES(239) ! PA&NCEMC REVENUE + CATAWBA
         R_VARIABLE_VALUE(604) = REPORTING_VARIABLES(307) ! Gas Revenues
         R_VARIABLE_VALUE(620) = REPORTING_VARIABLES(326) ! UNBILLED_REVENUES
         R_VARIABLE_VALUE(621) = REPORTING_VARIABLES(327) ! ATL_DEFERRED_REVENUES
         R_VARIABLE_VALUE(622) = REPORTING_VARIABLES(328) ! RELATIONSHIP_REVENUES
         R_VARIABLE_VALUE(623) = REPORTING_VARIABLES(329) ! RESIDENTIAL_REVENUES
         R_VARIABLE_VALUE(624) = REPORTING_VARIABLES(330) ! COMMERCIAL_REVENUES
         R_VARIABLE_VALUE(625) = REPORTING_VARIABLES(331) ! INDUSTRIAL_REVENUES
         R_VARIABLE_VALUE(651) = REPORTING_VARIABLES(382) ! GOVERNMENT REVENUES
         R_VARIABLE_VALUE(626) = REPORTING_VARIABLES(332) ! LIGHTING_REVENUES
         R_VARIABLE_VALUE(627) = REPORTING_VARIABLES(333) ! BULK_POWER_REVENUES
         R_VARIABLE_VALUE(665) = REPORTING_VARIABLES(380) ! Secondary Capacity Sales
         R_VARIABLE_VALUE(628) = REPORTING_VARIABLES(334) ! NON_CASH_ATL_REVENUES
         R_VARIABLE_VALUE(30) = REPORTING_VARIABLES(4) ! OPREV(2)
         R_VARIABLE_VALUE(31) = REPORTING_VARIABLES(5) ! INC_FUEL_EXPENSE
         R_VARIABLE_VALUE(32) = REPORTING_VARIABLES(6) ! INC_PURCHASE_EXPENSE
         R_VARIABLE_VALUE(33) = REPORTING_VARIABLES(363) ! INC_VAROM_EXPENSE
         R_VARIABLE_VALUE(34) = REPORTING_VARIABLES(8) ! INC_FIXEDOM_EXPENSE
         R_VARIABLE_VALUE(397) = REPORTING_VARIABLES(9) ! Service Transaction Expense
         R_VARIABLE_VALUE(35) = REPORTING_VARIABLES(10) ! INC_OTHER1_EXPENSE
         R_VARIABLE_VALUE(36) = REPORTING_VARIABLES(11) ! INC_OTHER2_EXPENSE -
         R_VARIABLE_VALUE(37) = REPORTING_VARIABLES(12) ! INC_OTHER3_EXPENSE-SERVICE_EXPENSES/1000.
         R_VARIABLE_VALUE(38) = REPORTING_VARIABLES(16) ! INC_NUCLEAR_FUEL_EXPENSE
         R_VARIABLE_VALUE(611) = REPORTING_VARIABLES(335) ! TRANSMISSION_OPERATION
         R_VARIABLE_VALUE(612) = REPORTING_VARIABLES(336) ! TRANSMISSION_MAINTENANCE
         R_VARIABLE_VALUE(613) = REPORTING_VARIABLES(337) ! DISTRIBUTION_OPERATION
         R_VARIABLE_VALUE(614) = REPORTING_VARIABLES(338) ! DISTRIBUTION_MAINTENANCE
         R_VARIABLE_VALUE(615) = REPORTING_VARIABLES(321) ! CUSTOMER_ACCOUNTS
         R_VARIABLE_VALUE(616) = REPORTING_VARIABLES(322) ! CUSTOMER_SERVICES
         R_VARIABLE_VALUE(617) = REPORTING_VARIABLES(323) ! SALES_EXPENSE
         R_VARIABLE_VALUE(618) = REPORTING_VARIABLES(324) ! AG_OPERATIONS
         R_VARIABLE_VALUE(619) = REPORTING_VARIABLES(325) ! AG_MAINTENANCE
         R_VARIABLE_VALUE(603) = REPORTING_VARIABLES(290) ! Retirementexpense
         R_VARIABLE_VALUE(583) = REPORTING_VARIABLES(233) ! decommissioning expense
         R_VARIABLE_VALUE(584) = REPORTING_VARIABLES(232) ! DOE Disposal
         R_VARIABLE_VALUE(588) = REPORTING_VARIABLES(240) ! PA&NCEMC EXPENSE + CATAWBA
         R_VARIABLE_VALUE(585) = REPORTING_VARIABLES(60) ! Lease Expenses ADD THIS TO MAIN
         R_VARIABLE_VALUE(269) = REPORTING_VARIABLES(15) ! Emissions Credit Expense 
!                               
! DSM COSTS
!
         R_VARIABLE_VALUE(132) = REPORTING_VARIABLES(13) ! DSM Program Expense
         R_VARIABLE_VALUE(133) = REPORTING_VARIABLES(14) ! DSM Program Rebate Expense
         R_VARIABLE_VALUE(39) = REPORTING_VARIABLES(17) ! BKDPPT+BDPAFC
         R_VARIABLE_VALUE(664) = REPORTING_VARIABLES(351) ! CASH FLOW AMORTIZATION
         R_VARIABLE_VALUE(40) = REPORTING_VARIABLES(18) ! AMTEXP - KEPCO_WC_DEF_MAINT_ENRG_AMORT
         R_VARIABLE_VALUE(110) = REPORTING_VARIABLES(17) + &  ! BKDPPT + BDPAFC +
                                 REPORTING_VARIABLES(18) + &  ! AMTEXP
                                 REPORTING_VARIABLES(314)   ! KEPCO_WC_DEF_MAINT_ENRG_AMORT 
         R_VARIABLE_VALUE(41) = REPORTING_VARIABLES(20) ! OPEXPT
         R_VARIABLE_VALUE(42) = REPORTING_VARIABLES(21) ! TXOPRV
         R_VARIABLE_VALUE(394) = REPORTING_VARIABLES(217) ! TXPROP
         R_VARIABLE_VALUE(395) = REPORTING_VARIABLES(22) ! TXSS+TXOTH+ENVIRONMENTAL_TAX
         R_VARIABLE_VALUE(43) = REPORTING_VARIABLES(22) + & ! TXSS+TXOTH
                                REPORTING_VARIABLES(217) ! TXPROP
         R_VARIABLE_VALUE(607) = REPORTING_VARIABLES(218) ! TXSS + TXOTH
         R_VARIABLE_VALUE(380) = REPORTING_VARIABLES(24) ! STBOKTAX
         R_VARIABLE_VALUE(381) = REPORTING_VARIABLES(26) ! FDTAXPAID
         R_VARIABLE_VALUE(46) = REPORTING_VARIABLES(28) ! TXNORM
         R_VARIABLE_VALUE(47) = REPORTING_VARIABLES(29) ! TXDEFP
         R_VARIABLE_VALUE(48) = REPORTING_VARIABLES(50) ! ITC-ITCAMT
         R_VARIABLE_VALUE(49) = REPORTING_VARIABLES(30) ! OPEXTX
         R_VARIABLE_VALUE(50) = REPORTING_VARIABLES(31) ! GOPINC
         R_VARIABLE_VALUE(51) = REPORTING_VARIABLES(32) ! DEF_REVENUES
         R_VARIABLE_VALUE(52) = REPORTING_VARIABLES(33) ! OTHINC + BTL_EXPENSES
         R_VARIABLE_VALUE(107) = REPORTING_VARIABLES(34) ! INTINC
         R_VARIABLE_VALUE(401) = REPORTING_VARIABLES(35) ! BTL Expenses
         R_VARIABLE_VALUE(386) = REPORTING_VARIABLES(36) ! BTL TAXES
         R_VARIABLE_VALUE(586) = REPORTING_VARIABLES(294) ! BTL Deferred Taxes
         R_VARIABLE_VALUE(53) = REPORTING_VARIABLES(37) ! AFDC1-TAFDCB
         R_VARIABLE_VALUE(54) = REPORTING_VARIABLES(38) ! NOPINC-TAFDCB
         R_VARIABLE_VALUE(109) = REPORTING_VARIABLES(38) + & ! NOPINC-TAFDCB
                                 REPORTING_VARIABLES(41)   ! TAFDCB
         R_VARIABLE_VALUE(602) = REPORTING_VARIABLES(387) ! LTDINT(RUN_YEAR)
         R_VARIABLE_VALUE(55) = REPORTING_VARIABLES(293) ! LTDINT(RUN_YEAR) + LTD_AMORTIZED
         R_VARIABLE_VALUE(56) = REPORTING_VARIABLES(40) ! STDINT(2)
         R_VARIABLE_VALUE(57) = REPORTING_VARIABLES(41) ! TAFDCB
         R_VARIABLE_VALUE(58) = REPORTING_VARIABLES(42) ! NOPINC-LTDINT(RUN_YEAR)-STDINT(2)
         R_VARIABLE_VALUE(59) = REPORTING_VARIABLES(43) ! SUBINC
         R_VARIABLE_VALUE(60) = REPORTING_VARIABLES(44) ! NET_OF_TAX_EXEXP
         R_VARIABLE_VALUE(61) = REPORTING_VARIABLES(45) ! NI
         R_VARIABLE_VALUE(62) = REPORTING_VARIABLES(361) ! PSDIV(RUN_YEAR)
         R_VARIABLE_VALUE(659) = REPORTING_VARIABLES(388) ! PS_DIVIDEND_CASH_PAYMENTS
         R_VARIABLE_VALUE(63) = REPORTING_VARIABLES(47) ! COMMON_EARNINGS
         R_VARIABLE_VALUE(64) = REPORTING_VARIABLES(48) ! CSDIV
         R_VARIABLE_VALUE(658) = REPORTING_VARIABLES(398) ! COMMON_STOCK_CASH_DIVIDENDS
         R_VARIABLE_VALUE(65) = REPORTING_VARIABLES(49) ! REARNP
         R_VARIABLE_VALUE(66) = REPORTING_VARIABLES(61) ! RETURN_ON_RATEBASE
         R_VARIABLE_VALUE(67) = REPORTING_VARIABLES(62) ! TRB
         R_VARIABLE_VALUE(68) = REPORTING_VARIABLES(58) ! ROEQU
         R_VARIABLE_VALUE(69) = REPORTING_VARIABLES(51) ! BOOK_VALUE
         R_VARIABLE_VALUE(70) = REPORTING_VARIABLES(52) ! MARKET_VALUE
         R_VARIABLE_VALUE(71) = REPORTING_VARIABLES(299) ! CSSO(2)
         R_VARIABLE_VALUE(72) = REPORTING_VARIABLES(54) ! MBRATO
         R_VARIABLE_VALUE(73) = REPORTING_VARIABLES(130) ! DEPACC
         R_VARIABLE_VALUE(74) = REPORTING_VARIABLES(220) ! SL_TAX_DEP
         R_VARIABLE_VALUE(75) = REPORTING_VARIABLES(135) ! FDBKINCO
         R_VARIABLE_VALUE(76) = REPORTING_VARIABLES(131) ! STBOKINCO
         R_VARIABLE_VALUE(78) = REPORTING_VARIABLES(55) ! EARNINGS_PER_SHARE
         R_VARIABLE_VALUE(79) = REPORTING_VARIABLES(56) ! DIVIDENDS_PER_SHARE
         R_VARIABLE_VALUE(80) = REPORTING_VARIABLES(57) ! DIVIDEND_PAYOUT
!
! SHAREHOLDER VALUE
!         
         R_VARIABLE_VALUE(501) = REPORTING_VARIABLES(254) ! CASH_REVENUE
         R_VARIABLE_VALUE(502) = REPORTING_VARIABLES(255) ! DEDUCTIBLE_EXPENSES
         R_VARIABLE_VALUE(503) = REPORTING_VARIABLES(256) ! CAPITAL_RECOVERY
         R_VARIABLE_VALUE(504) = REPORTING_VARIABLES(257) ! CASH_INCOME_TAXES
         R_VARIABLE_VALUE(528) = REPORTING_VARIABLES(258) ! ADJUSTMENT_TO_OPERATING_PROFITS
         R_VARIABLE_VALUE(505) = REPORTING_VARIABLES(259) ! OPERATING_PROFITS_AFTER_TAXES
         R_VARIABLE_VALUE(529) = REPORTING_VARIABLES(260) ! OPERATING_ASSETS_YEAR_START
         R_VARIABLE_VALUE(532) = REPORTING_VARIABLES(261) ! R_WORKING_CAP ! WCCUM(2)
         R_VARIABLE_VALUE(506) = REPORTING_VARIABLES(262) ! ADJUSTMENT_2_ECONOMIC_ASSETS
         R_VARIABLE_VALUE(507) = REPORTING_VARIABLES(263) ! OPERATING_ASSETS_YEAR_END
         R_VARIABLE_VALUE(530) = REPORTING_VARIABLES(264) ! (OPERATING_ASSETS_YEAR_START +

         R_VARIABLE_VALUE(508) = REPORTING_VARIABLES(265) ! ROEQU1
         R_VARIABLE_VALUE(509) = REPORTING_VARIABLES(266) ! COST_OF_CAPITAL_RISK_ADJUSTMENT
         R_VARIABLE_VALUE(510) = REPORTING_VARIABLES(267) ! EQRATO
         R_VARIABLE_VALUE(511) = REPORTING_VARIABLES(268) ! EQRATO*(ROEQU1 +

         R_VARIABLE_VALUE(512) = REPORTING_VARIABLES(269) ! 100. * PSRATE
         R_VARIABLE_VALUE(513) = REPORTING_VARIABLES(270) ! PSRATO
         R_VARIABLE_VALUE(514) = REPORTING_VARIABLES(271) ! 100. * PSRATO * PSRATE
         R_VARIABLE_VALUE(515) = REPORTING_VARIABLES(272) ! 100. * LTDRTE
         R_VARIABLE_VALUE(516) = REPORTING_VARIABLES(273) ! (1. - EQRATO - PSRATO)
         R_VARIABLE_VALUE(517) = REPORTING_VARIABLES(274) ! 100. * (1. - EQRATO - PSRATO) * LTDRTE
         R_VARIABLE_VALUE(518) = REPORTING_VARIABLES(275) ! 100. * FDTXR*(1.-STTXR) + STTXR
         R_VARIABLE_VALUE(519) = REPORTING_VARIABLES(276) ! 100. * (1. - EQRATO - PSRATO) * LTDRTE *

         R_VARIABLE_VALUE(520) = REPORTING_VARIABLES(277) ! RISK_ADJUSTED_COST_OF_CAPITAL*100.
         R_VARIABLE_VALUE(521) = REPORTING_VARIABLES(278) ! AFTER_TAX_COST_OF_CAPITAL*100.
         R_VARIABLE_VALUE(522) = REPORTING_VARIABLES(279) ! COST_OF_SHAREHOLDER_CAPATIAL
         R_VARIABLE_VALUE(523) = REPORTING_VARIABLES(280) ! SHAREHOLDER_VALUE_ADDED
         R_VARIABLE_VALUE(531) = REPORTING_VARIABLES(281) ! VALUE_ADDED_WO_INTEREST_INCOME
         R_VARIABLE_VALUE(524) = REPORTING_VARIABLES(282) ! OPERATING_ASSETS_YEAR_END -

         R_VARIABLE_VALUE(525) = REPORTING_VARIABLES(283) ! 100. * ECONOMIC_RETURN_OPENING_BALANCE
         R_VARIABLE_VALUE(526) = REPORTING_VARIABLES(284) ! 100. * ECONOMIC_RETURN_AVERAGE_BALANCE
         R_VARIABLE_VALUE(527) = REPORTING_VARIABLES(285) ! 100. * ECONOMIC_RETURN_CLOSING_BALANCE
!
! TAX REPORT
!
         R_VARIABLE_VALUE(608) = REPORTING_VARIABLES(305) ! Other Taxable Income
         R_VARIABLE_VALUE(106) = REPORTING_VARIABLES(129) ! Capitialzed Interest
         R_VARIABLE_VALUE(553) = REPORTING_VARIABLES(227) ! Tax Nuclear Fuel Expense
         R_VARIABLE_VALUE(605) = REPORTING_VARIABLES(228) ! Construction Tax Expenses ADD
         R_VARIABLE_VALUE(606) = REPORTING_VARIABLES(304) ! CATAWBA_TAX_DEDUCTIBLE_EXPENSE
         R_VARIABLE_VALUE(311) = REPORTING_VARIABLES(133) ! State Tax Deductions
         R_VARIABLE_VALUE(76) = REPORTING_VARIABLES(131) ! State Taxable Income
         R_VARIABLE_VALUE(103) = REPORTING_VARIABLES(132) ! State Taxable Income after NOLs
         R_VARIABLE_VALUE(610) = REPORTING_VARIABLES(308) ! State NOL Generated
         R_VARIABLE_VALUE(104) = REPORTING_VARIABLES(309) ! State NOL Used
         R_VARIABLE_VALUE(384) = REPORTING_VARIABLES(141) ! State Tax Rate 
         R_VARIABLE_VALUE(44) = REPORTING_VARIABLES(212) ! State Taxes Paid
         R_VARIABLE_VALUE(382) = REPORTING_VARIABLES(300) ! State Allocation BTL
         R_VARIABLE_VALUE(383) = REPORTING_VARIABLES(302) ! Federal Allocation BTL
         R_VARIABLE_VALUE(312) = REPORTING_VARIABLES(137) ! Federal Tax Deductions 
         R_VARIABLE_VALUE(105) = REPORTING_VARIABLES(216) ! Environmental Tax  
         R_VARIABLE_VALUE(75) = REPORTING_VARIABLES(135) ! Federal Taxable Income before Credit
         R_VARIABLE_VALUE(92) = REPORTING_VARIABLES(310) ! Federal NOL Generated 
         R_VARIABLE_VALUE(93) = REPORTING_VARIABLES(311) ! Federal NOL Used
         R_VARIABLE_VALUE(609) = REPORTING_VARIABLES(136) ! Federal Taxable Income after NOLs
         R_VARIABLE_VALUE(385) = REPORTING_VARIABLES(213) ! Federal Tax Rate 
         R_VARIABLE_VALUE(91) = 0. !REPORTING_VARIABLES() ! Book ITCs 
         R_VARIABLE_VALUE(90) = REPORTING_VARIABLES(211) ! Federal Book Tax 

         R_VARIABLE_VALUE(77) = 0.  ! REPORTING_VARIABLES() ! ITC USED BOOK OR AMT
         R_VARIABLE_VALUE(45) = REPORTING_VARIABLES(211) ! Federal Income Taxes Paid 

         R_VARIABLE_VALUE(95) = REPORTING_VARIABLES(139) ! AMT Taxable Income

         R_VARIABLE_VALUE(74) = REPORTING_VARIABLES(220) ! SL Tax Depreciation 
!
! END TAX
!
!
! added 1/24/97 Cash Flow Statement
!
         R_VARIABLE_VALUE(108) = REPORTING_VARIABLES(117) ! Nuclear Decommissioning Fund Payments 
         R_VARIABLE_VALUE(115) = REPORTING_VARIABLES(154) ! Preferred Stock Retirements
         R_VARIABLE_VALUE(116) = REPORTING_VARIABLES(119) ! Debt Retirements
         R_VARIABLE_VALUE(475) = REPORTING_VARIABLES(154) & ! Preferred Stock Retirements
                                 + REPORTING_VARIABLES(119) ! Debt Retirements
         R_VARIABLE_VALUE(652) = REPORTING_VARIABLES(385) ! LTD_PS_ISSUE_EXPENSES
         R_VARIABLE_VALUE(118) = REPORTING_VARIABLES(115) ! Total Construction Expenditures and Net Investment
         R_VARIABLE_VALUE(119) = REPORTING_VARIABLES(118) ! Investment in Working Capital
         R_VARIABLE_VALUE(124) = REPORTING_VARIABLES(104) ! Short Term Debt Issued
         R_VARIABLE_VALUE(125) = REPORTING_VARIABLES(101) ! Common Stock Issued
         R_VARIABLE_VALUE(126) = REPORTING_VARIABLES(103) ! Preferred Stock Issued
         R_VARIABLE_VALUE(127) = REPORTING_VARIABLES(102) ! Long Term Debt Issued
         R_VARIABLE_VALUE(128) = REPORTING_VARIABLES(122) ! Lease Receipts
         R_VARIABLE_VALUE(123) = REPORTING_VARIABLES(123) ! EXTERNAL FINANCING PERFORMED
         R_VARIABLE_VALUE(129) = REPORTING_VARIABLES(124) ! CHANGE IN CASH
         R_VARIABLE_VALUE(325) = REPORTING_VARIABLES(112)+ &! Net Investment & Other
                                 REPORTING_VARIABLES(356) ! Salvage
         R_VARIABLE_VALUE(326) = REPORTING_VARIABLES(110) ! New Plant Construction Expenditures
         R_VARIABLE_VALUE(327) = REPORTING_VARIABLES(111) ! Nuclear Fuel Fabrication Expenditure
         R_VARIABLE_VALUE(398) = REPORTING_VARIABLES(127) ! Deferred Expenses
         R_VARIABLE_VALUE(458) = REPORTING_VARIABLES(125) ! Customer Deposits
         R_VARIABLE_VALUE(460) = REPORTING_VARIABLES(113) ! Contributions in Aid of Construction
         R_VARIABLE_VALUE(462) = REPORTING_VARIABLES(19)  ! CIAC Amortization Expense
         R_VARIABLE_VALUE(554) = REPORTING_VARIABLES(231) ! Nuclear Burn Expense 
!
         R_VARIABLE_VALUE(589) = REPORTING_VARIABLES(215) ! Parent Taxes Paid
         R_VARIABLE_VALUE(590) = REPORTING_VARIABLES(108) ! Subsidiary Tax Payments
         R_VARIABLE_VALUE(591) = REPORTING_VARIABLES(214) ! Consolidate Taxes Paid
         R_VARIABLE_VALUE(592) = REPORTING_VARIABLES(106) ! Sale of Assets
         R_VARIABLE_VALUE(593) = REPORTING_VARIABLES(107) ! Subsidiary Dividends
         R_VARIABLE_VALUE(594) = REPORTING_VARIABLES(120) ! Common Stock Buyback
         R_VARIABLE_VALUE(595) = REPORTING_VARIABLES(121) ! funds_change_b4_financing
         R_VARIABLE_VALUE(596) = REPORTING_VARIABLES(105) ! INCOME BEFORE CAPITAL SERVICE
         R_VARIABLE_VALUE(597) = REPORTING_VARIABLES(142) ! Consolidating Adjustments
         R_VARIABLE_VALUE(598) = REPORTING_VARIABLES(109) ! funds_fm_operations
         R_VARIABLE_VALUE(599) = REPORTING_VARIABLES(126) ! Equity to Subsidiaries
         R_VARIABLE_VALUE(666) = REPORTING_VARIABLES(399) ! Acquisions
         R_VARIABLE_VALUE(600) = REPORTING_VARIABLES(114) ! Capitalized Leases
         R_VARIABLE_VALUE(601) = REPORTING_VARIABLES(124) - & ! Change in cash  
                                 REPORTING_VARIABLES(121) ! funds_change_b4_financing
         R_VARIABLE_VALUE(120) = REPORTING_VARIABLES(154) + & ! Preferred Stock Retirements
                                 REPORTING_VARIABLES(119)   ! Debt Retirements

         R_VARIABLE_VALUE(114) = REPORTING_VARIABLES(39) ! + ! INTEREST_ON_LONG_TERM_DEBT

         R_VARIABLE_VALUE(463) = OPENING_INVESTMENT_BALANCE ! INVESTMENTS(1) 
         R_VARIABLE_VALUE(560) = REPORTING_VARIABLES(247) ! CATAWBA_LEVEL_CAP_PAYMENTS)
         OPENING_INVESTMENT_BALANCE = REPORTING_VARIABLES(74) + & ! INVESTMENTS(2)
                                      REPORTING_VARIABLES(289)  ! LT_INVESTMENTS
         R_VARIABLE_VALUE(313) = REPORTING_VARIABLES(209) ! TAXABLE INCOME BEFORE DEDUCTIONS
         R_VARIABLE_VALUE(314) = REPORTING_VARIABLES(210) ! TOTAL DEDUCTIBLE EXPENSES FROM BOOK
         R_VARIABLE_VALUE(315) = REPORTING_VARIABLES(128) ! TAXABLE INCOME 
         R_VARIABLE_VALUE(316) = REPORTING_VARIABLES(149) ! RB DEF ITC
         R_VARIABLE_VALUE(317) = REPORTING_VARIABLES(145) ! RB ADJUSTMENTS
         R_VARIABLE_VALUE(318) = REPORTING_VARIABLES(143) ! RB NET PLANT
         R_VARIABLE_VALUE(319) = REPORTING_VARIABLES(148) ! RB CWIP
         R_VARIABLE_VALUE(320) = REPORTING_VARIABLES(147) ! RB NUC FUEL
         R_VARIABLE_VALUE(321) = REPORTING_VARIABLES(146) ! RB DEF DEBIT
         R_VARIABLE_VALUE(322) = REPORTING_VARIABLES(150) ! RB NUC TRUST FUND
         R_VARIABLE_VALUE(323) = REPORTING_VARIABLES(144) ! RB DEF TAX CR
         R_VARIABLE_VALUE(329) = REPORTING_VARIABLES(25) ! STATE CAPITAL TAX
         R_VARIABLE_VALUE(330) = REPORTING_VARIABLES(27) ! FED CAPITAL TAX

!
! EXTERNALITY VARIABLES
!
         R_VARIABLE_VALUE(270) = PASS_THROUGH_VALUES(1) ! X_PRICE_1
         R_VARIABLE_VALUE(271) = PASS_THROUGH_VALUES(2) ! X_PRICE_2
         R_VARIABLE_VALUE(272) = PASS_THROUGH_VALUES(3) ! X_PRICE_3
         DO I = 1, 7
            R_VARIABLE_VALUE(463+I) = PASS_THROUGH_VALUES(3+I) ! BALANCE OF PASS THROUGH
         ENDDO
!
! AI CLASS OUTPUT
!
         R_VARIABLE_VALUE(387) = AI_LAGGED_GPV
         R_VARIABLE_VALUE(388) = AI_CLASS_CASH
         R_VARIABLE_VALUE(389) = AI_ANNUAL_CLASS_DEP
         R_VARIABLE_VALUE(390) = AI_AFUDC_ON_CASH
         R_VARIABLE_VALUE(391) = AI_CLASS_EXPENSE
         R_VARIABLE_VALUE(392) = FA_AFUDC_RATE()*100.
         R_VARIABLE_VALUE(497) = NF_AFUDC_RATE()*100.
         R_VARIABLE_VALUE(498) = AI_AFUDC_RATE()*100.
         R_VARIABLE_VALUE(393) = AFUDC_BORROWED_RATE()*100.
         AFUDC_ON_CASH = REPORTING_VARIABLES(37) + & ! AFDC1-TAFDCB
                         REPORTING_VARIABLES(41) ! TAFDCB
         IF(REPORTING_VARIABLES(47) /= 0.) THEN ! COMMON_EARNINGS
            R_VARIABLE_VALUE(87) = 100.*AFUDC_ON_CASH/REPORTING_VARIABLES(47) ! AFDC1_TO_COMMON_EARNINGS
         ELSE
            R_VARIABLE_VALUE(87) = 0.
         ENDIF
!
! NOTE TOTAL_CAPITAL IS USED INTEGER*2 THE SRP SECTION
!
         TOTAL_CAPITAL = REPORTING_VARIABLES(82) + & ! CAPITL(2)
                         REPORTING_VARIABLES(84)   ! STDCUM(2)
         IF(TOTAL_CAPITAL /= 0.) THEN
            TOTAL_CAPITAL = 100./TOTAL_CAPITAL
         ELSE
            TOTAL_CAPITAL = 0.
         ENDIF
         R_VARIABLE_VALUE(83) = TOTAL_CAPITAL * REPORTING_VARIABLES(79) ! COMEQU(2)
         R_VARIABLE_VALUE(84) = TOTAL_CAPITAL * REPORTING_VARIABLES(80) ! PSCUM(2)
         R_VARIABLE_VALUE(85) = TOTAL_CAPITAL * REPORTING_VARIABLES(81) ! LTDCUM(2)
         R_VARIABLE_VALUE(86) = TOTAL_CAPITAL * REPORTING_VARIABLES(84) ! STDCUM(2)
!
! STANDARD CALCULATION OF INTEREST COVERAGE WITH AND WITHOUT AFUDC
!
         INTEREST_COVERAGE_WITHOUT_AFDC = NOT_AVAIL
         INTEREST_COVERAGE_WITH_AFDC = NOT_AVAIL
         GOPINC = REPORTING_VARIABLES(31) ! GOPINC
         ITC_ITCAMT = REPORTING_VARIABLES(50) ! ITCAMT
         TAXES_PAID = REPORTING_VARIABLES(211) + & ! FEDERAL TAXES PAID
                      REPORTING_VARIABLES(212)   ! STAET TAXEPAID
         INTINC = REPORTING_VARIABLES(34)
         OTHINC = REPORTING_VARIABLES(33)
         BTL_TAXES = REPORTING_VARIABLES(36)
         DEP_AMORTIZATION = REPORTING_VARIABLES(17) + & ! BKDPPT + BDPAFC +
                            REPORTING_VARIABLES(18)    ! AMTEXP
!
! VARIOUS COVERAGE RATIOS
!
         RTEMP = GOPINC + ITC_ITCAMT + TAXES_PAID
         LTD_STD_INTEREST = REPORTING_VARIABLES(39) + & ! LTDINT(RUN_YEAR)
                            REPORTING_VARIABLES(40)   ! STDINT(2)
         LTD_PS_RETIREMENT = REPORTING_VARIABLES(154) + & ! Preferred Stock Retirements
                             REPORTING_VARIABLES(119)   ! Debt Retirements
         IF(LTD_STD_INTEREST /= 0.) THEN
            INTEREST_COVERAGE_WITHOUT_AFDC = RTEMP/LTD_STD_INTEREST
            INTEREST_COVERAGE_WITH_AFDC = (RTEMP + AFUDC_ON_CASH)/LTD_STD_INTEREST
         ENDIF
!
! COVERAGE RATIOS
!
         COVERAGE_DRIVER_RATIO = NOT_AVAIL
         IF(COVERAGE_RATIO_TYPE == 1) THEN

            IF(LTD_STD_INTEREST /= 0.) COVERAGE_DRIVER_RATIO = GOPINC/LTD_STD_INTEREST
         ELSEIF(COVERAGE_RATIO_TYPE == 11) THEN

            LTD_INTEREST_LESS_AFUDC = REPORTING_VARIABLES(293) &  ! LTD BOOKED INTEREST WITH AMORT
                                      - REPORTING_VARIABLES(41)  ! afudc borrowed
            IF(LTD_INTEREST_LESS_AFUDC /= 0.) COVERAGE_DRIVER_RATIO = (LTD_INTEREST_LESS_AFUDC + REPORTING_VARIABLES(45))/ &
                                           LTD_INTEREST_LESS_AFUDC
         ELSEIF(COVERAGE_RATIO_TYPE == 2 .OR. COVERAGE_RATIO_TYPE == 3) THEN
            RTEMP = GOPINC+ITC_ITCAMT+TAXES_PAID+INTINC+OTHINC-BTL_TAXES - REPORTING_VARIABLES(35)   ! CLASS_BTL_EXPENSES

            IF(COVERAGE_RATIO_TYPE == 2) LTD_STD_INTEREST = LTD_STD_INTEREST - AFUDC_ON_CASH
            IF(LTD_STD_INTEREST /= 0.) COVERAGE_DRIVER_RATIO = RTEMP/LTD_STD_INTEREST
         ELSEIF(COVERAGE_RATIO_TYPE == 8 .OR. COVERAGE_RATIO_TYPE == 9) THEN
            LEASE_PAYMENT_LIMIT = MAX(0.,LEASE_PAYMENTS_IN_TIER - .02*REPORTING_VARIABLES(79))/3. ! COMEQU(2)
            RTEMP = GOPINC+ITC_ITCAMT+TAXES_PAID+INTINC+OTHINC-BTL_TAXES + LEASE_PAYMENT_LIMIT
            INTEREST = LTD_STD_INTEREST - AFUDC_ON_CASH + LEASE_PAYMENT_LIMIT
            IF(COVERAGE_RATIO_TYPE == 9) INTEREST=INTEREST+AFUDC_ON_CASH
            IF(INTEREST /= 0.) COVERAGE_DRIVER_RATIO=RTEMP/INTEREST
            IF(INTEREST+LTD_PS_RETIREMENT /= 0.) THEN
               INTEREST_COVERAGE_WITH_AFDC = (RTEMP + DEP_AMORTIZATION)/(INTEREST+LTD_PS_RETIREMENT)
               INTEREST_COVERAGE_WITHOUT_AFDC = (RTEMP + DEP_AMORTIZATION - AFUDC_ON_CASH)/(INTEREST+LTD_PS_RETIREMENT)
            ENDIF
         ELSEIF(COVERAGE_RATIO_TYPE == 4 .OR. COVERAGE_RATIO_TYPE == 5) THEN
            INTEREST = LTD_STD_INTEREST + LTD_PS_RETIREMENT
            RTEMP = GOPINC + ITC_ITCAMT + OTHINC + INTINC +  DEP_AMORTIZATION + &
                    REPORTING_VARIABLES(29) +  & ! TXDEFP
                    REPORTING_VARIABLES(28)    ! TXNORM
            IF(INTEREST /= 0.) COVERAGE_DRIVER_RATIO=RTEMP/INTEREST
         ELSEIF(COVERAGE_RATIO_TYPE == 6 .OR. COVERAGE_RATIO_TYPE == 7) THEN
               SRP_TOTAL_DEBT_SERVICE = REPORTING_VARIABLES(39) + & ! LTDINT(RUN_YEAR) +
                                        REPORTING_VARIABLES(119) + & ! LTDRET(RUN_YEAR)
                                        REPORTING_VARIABLES(154)   ! PSRED(RUN_YEAR)
! NOTE OTNINC IS NET OF BLT_EXPENSES

               SRP_FUNDS_FOR_DEBT_SERVICE = REPORTING_VARIABLES(31) + & ! GOPINC
                                            REPORTING_VARIABLES(34) - & ! INTINC - 
                                            REPORTING_VARIABLES(40) + & ! STDINT(2) +
                                            REPORTING_VARIABLES(33) + & ! OTHINC +
                                            DEP_AMORTIZATION + &        ! BKDPPT + BDPAFC + AMTEXP
                                            REPORTING_VARIABLES(217)   ! TXPROP +
               IF(SRP_TOTAL_DEBT_SERVICE /= 0.) COVERAGE_DRIVER_RATIO = SRP_FUNDS_FOR_DEBT_SERVICE/SRP_TOTAL_DEBT_SERVICE
               IF(OPERATING_METHOD=='C') COVERAGE_DRIVER_RATIO=SRP_RATIO


         ENDIF
         R_VARIABLE_VALUE(81) = INTEREST_COVERAGE_WITHOUT_AFDC
         R_VARIABLE_VALUE(82) = INTEREST_COVERAGE_WITH_AFDC
         R_VARIABLE_VALUE(396) = COVERAGE_DRIVER_RATIO
         NOPINC  = REPORTING_VARIABLES(38) + & ! NOPINC-TAFDCB
                   REPORTING_VARIABLES(41)   ! TAFDCB
!
!
!
         SUM_OPERATIONS = NOPINC + DEP_AMORTIZATION + ITC_ITCAMT - AFUDC_ON_CASH + REPORTING_VARIABLES(29)  ! TXDEFP
         FUNDS_FOR_CONSTRUCTION = REPORTING_VARIABLES(110) + & ! New Plant Construction Expenditures
                                  REPORTING_VARIABLES(111)   ! Nuclear Fuel Fabrication Expenditure
         IF(FUNDS_FOR_CONSTRUCTION /= 0.) THEN
            FUNDS_FOR_CONSTRUCTION = 100.*(SUM_OPERATIONS - REPORTING_VARIABLES(301))/ & ! TOTAL_CAPITAL_SERVICE
                                           FUNDS_FOR_CONSTRUCTION
         ELSE
            FUNDS_FOR_CONSTRUCTION = 0.
         ENDIF
         COVERAGE_RATIO_VALUE = GOPINC + ITC_ITCAMT + OTHINC + INTINC + DEP_AMORTIZATION + REPORTING_VARIABLES(29) + &  ! TXDEFP
                                                                                           REPORTING_VARIABLES(28)      ! TXNORM
         INTEREST = LTD_STD_INTEREST + LTD_PS_RETIREMENT
         IF(INTEREST /= 0.) THEN
            COVERAGE_RATIO_VALUE = COVERAGE_RATIO_VALUE/INTEREST
         ELSE
            COVERAGE_RATIO_VALUE = 0.
         ENDIF
         R_VARIABLE_VALUE(130) = COVERAGE_RATIO_VALUE
         R_VARIABLE_VALUE(89) = FUNDS_FOR_CONSTRUCTION

         NON_CASH_EXPENSE_ADJUSTMENTS = REPORTING_VARIABLES(231) + & ! Nuclear Burn Expense
                                        REPORTING_VARIABLES(17)  + & ! Depreciation Expense
                                        REPORTING_VARIABLES(18)  + & ! Amortization Expense
                                        REPORTING_VARIABLES(19)  + & ! CIAC Amortization Expense
                                        REPORTING_VARIABLES(142) + & ! Consolidating Adjustments
                                        REPORTING_VARIABLES(314) ! KEPCO_WC_DEF_MAINT_ENRG_AMORT
         TAX_AND_OTHER_ADJUSTMENTS = -REPORTING_VARIABLES(32)  - & ! Deferred Revenues
                                      REPORTING_VARIABLES(334) - & ! Non-cash Revenue
                                      REPORTING_VARIABLES(37)  - & ! AFUDC Equity
                                      REPORTING_VARIABLES(41)  + & ! AFUDC Borrowed
                                      REPORTING_VARIABLES(28)  + & ! Income Tax Deferrals (Dr)
                                      REPORTING_VARIABLES(295) + & ! Income Tax Deferrals (Cr)
                                      REPORTING_VARIABLES(50)  + & ! Investment Tax Credit
                                      REPORTING_VARIABLES(215) + & ! Parent Taxes Paid
                                      REPORTING_VARIABLES(108) - & ! Subsidiary Tax Payments
                                      REPORTING_VARIABLES(214)   ! Consolidate Taxes Paid
         OTHER_CASH_SOURCES = REPORTING_VARIABLES(106) + & ! Sale of Assets
                              REPORTING_VARIABLES(107) + & ! Subsidary Dividends
                              REPORTING_VARIABLES(113) + & ! Contributions in Aid of Construction
                              REPORTING_VARIABLES(125)     ! Customer Deposits
         CAPITAL_REQUIREMENTS =  REPORTING_VARIABLES(115) + & ! Total Construction Expenditures and Net Investment
                                 REPORTING_VARIABLES(117) + & ! Nuclear Decommissioning Fund Payments
                                 REPORTING_VARIABLES(118) + & ! Investment in Working Capital
                                 REPORTING_VARIABLES(119) + & ! Debt Retirements
                                 REPORTING_VARIABLES(154) + & ! Preferred Stock Retirements
                                 REPORTING_VARIABLES(385) + & ! Preferred/Debt Issue Expense
                                 REPORTING_VARIABLES(120) + & ! Common Stock Buyback
                                 REPORTING_VARIABLES(127)   ! Deferred Expenses
         TOTAL_CAPITAL_SERVICE_PAYMENTS = REPORTING_VARIABLES(387) + & ! Interest on Long Term Debt was 39
                                          REPORTING_VARIABLES(40) + & ! Interest on Short Term Debt
                                          REPORTING_VARIABLES(388) + & ! Preferred Dividends was 46
                                          REPORTING_VARIABLES(398)    ! Common Dividends
         R_VARIABLE_VALUE(113) = NON_CASH_EXPENSE_ADJUSTMENTS
         R_VARIABLE_VALUE(117) = CAPITAL_REQUIREMENTS
         R_VARIABLE_VALUE(122) = TOTAL_CAPITAL_SERVICE_PAYMENTS
         R_VARIABLE_VALUE(111) = TAX_AND_OTHER_ADJUSTMENTS
         R_VARIABLE_VALUE(112) = OTHER_CASH_SOURCES
!
! KEPCO STUFF 5/29/97
!
         R_VARIABLE_VALUE(362) = REPORTING_VARIABLES(312) ! KEPCO_WC_CURENT_MAINT_ENRG_COST +

         R_VARIABLE_VALUE(363) = REPORTING_VARIABLES(313) ! KEPCO_WC_CURENT_MAINT_ENRG_COST
         R_VARIABLE_VALUE(364) = REPORTING_VARIABLES(314) ! KEPCO_WC_DEF_MAINT_ENRG_AMORT
      RETURN
!***********************************************************************
!
! CALCULATED SRP OUTPUT VARIALBES
!
      ENTRY SRP_REPORTING_VARIABLES(R_RUN_YEAR,R_VARIABLE_VALUE,R_CLASS_MHW_SALES,R_ANNUAL_ECONOMY_SOLD)
!***********************************************************************
!
!
! SRP VARIABLES
!
         SRP_FUNDS_FOR_DEBT_SERVICE = REPORTING_VARIABLES(31) + & ! GOPINC
                                      REPORTING_VARIABLES(34) - & ! INTINC - 
                                      REPORTING_VARIABLES(40) - & ! STDINT(2) +
                                      REPORTING_VARIABLES(35) + & ! BTL Expense
                                      REPORTING_VARIABLES(33) + & ! OTHINC +
                                      REPORTING_VARIABLES(17) + & ! BKDPPT + BDPAFC +
                                      REPORTING_VARIABLES(217) + & ! TXPROP +
                                      REPORTING_VARIABLES(18)    ! AMTEXP
         SRP_TOTAL_DEBT_SERVICE = REPORTING_VARIABLES(39) + & ! LTDINT(RUN_YEAR) +
                                  REPORTING_VARIABLES(119) + & ! LTDRET(RUN_YEAR)
                                  REPORTING_VARIABLES(154)   ! PSRED(RUN_YEAR)
         SRP_FUNDS_AFTER_DEBT_SERVICE = SRP_FUNDS_FOR_DEBT_SERVICE - SRP_TOTAL_DEBT_SERVICE
         SRP_FUNDS_FOR_CORP_USE = SRP_FUNDS_AFTER_DEBT_SERVICE - REPORTING_VARIABLES(217)   ! TXPROP
         IF(SRP_TOTAL_DEBT_SERVICE /= 0.) THEN
            SRP_DEBT_SERVICE_COVERAGE_RATIO =SRP_FUNDS_FOR_DEBT_SERVICE/SRP_TOTAL_DEBT_SERVICE
         ELSE
            SRP_DEBT_SERVICE_COVERAGE_RATIO = NOT_AVAIL
         ENDIF
         R_VARIABLE_VALUE(474) = SRP_FUNDS_FOR_DEBT_SERVICE

         R_VARIABLE_VALUE(476) = SRP_TOTAL_DEBT_SERVICE
         R_VARIABLE_VALUE(477) = SRP_DEBT_SERVICE_COVERAGE_RATIO
         R_VARIABLE_VALUE(478) = SRP_FUNDS_AFTER_DEBT_SERVICE
         R_VARIABLE_VALUE(479) = SRP_FUNDS_FOR_CORP_USE
         R_VARIABLE_VALUE(480) = TOTAL_CAPITAL*(REPORTING_VARIABLES(81)+ & ! LTDCUM(2)
                                                REPORTING_VARIABLES(84)) ! STDCUM(2)
         CALL RETURN_CAWCD_ENERGY(CAWCD_ENERGY)
         SRP_TOTAL_SALES = (R_CLASS_MHW_SALES+GET_TOTAL_SALES_ENERGY()+R_ANNUAL_ECONOMY_SOLD + CAWCD_ENERGY)/1000.
         CALL RETURN_SRP_TOTAL_SALES(R_RUN_YEAR,TEMP_SRP_TOTAL_SALES)
         IF(TEMP_SRP_TOTAL_SALES > 0.) SRP_TOTAL_SALES = TEMP_SRP_TOTAL_SALES
         SRP_SALES_COST = REPORTING_VARIABLES(30) + & ! OPEXTX
                            REPORTING_VARIABLES(35)   ! BTL_EXPENSES
         SRP_OPERATING_MARGIN = REPORTING_VARIABLES(4)  - & ! OPREV(2)
                                REPORTING_VARIABLES(30) - & ! OPEXTX
                                REPORTING_VARIABLES(35)   ! BTL_EXPENSES  
         R_VARIABLE_VALUE(556) = CAWCD_ENERGY/1000.
         R_VARIABLE_VALUE(557) = SRP_OPERATING_MARGIN
         R_VARIABLE_VALUE(559) = SRP_SALES_COST
         SRP_NET_FINANCING_COSTS = R_VARIABLE_VALUE(55) + R_VARIABLE_VALUE(56) - R_VARIABLE_VALUE(57)
         SRP_OP_FIN_TARGET_D = SRP_SALES_COST + SRP_NET_FINANCING_COSTS - R_VARIABLE_VALUE(107)
         SRP_OP_FIN_MARGIN_D = R_VARIABLE_VALUE(63)
         IF(SRP_TOTAL_SALES /= 0.) THEN
            SRP_AVERAGE_SALES_COST=1000.*SRP_SALES_COST/SRP_TOTAL_SALES
            SRP_AVERAGE_MARGIN = 1000. * SRP_OPERATING_MARGIN/SRP_TOTAL_SALES
            SRP_OP_FIN_MARGIN_D_MWH = 1000. * SRP_OP_FIN_MARGIN_D/SRP_TOTAL_SALES
            SRP_OP_FIN_TARGET_D_MWH = 1000. * SRP_OP_FIN_TARGET_D/SRP_TOTAL_SALES
         ELSE
            SRP_AVERAGE_SALES_COST = NOT_AVAIL
            SRP_AVERAGE_MARGIN = NOT_AVAIL
            SRP_OP_FIN_MARGIN_D_MWH = NOT_AVAIL
            SRP_OP_FIN_TARGET_D_MWH = NOT_AVAIL
         ENDIF
         R_VARIABLE_VALUE(558) = SRP_AVERAGE_MARGIN
         R_VARIABLE_VALUE(551) = SRP_TOTAL_SALES      
         R_VARIABLE_VALUE(552) = SRP_AVERAGE_SALES_COST
! 8/6/98 SRP NEW CALCULATIONS
         R_VARIABLE_VALUE(653) = SRP_OP_FIN_MARGIN_D_MWH
         R_VARIABLE_VALUE(654) = SRP_OP_FIN_TARGET_D_MWH
         R_VARIABLE_VALUE(655) = SRP_NET_FINANCING_COSTS
         R_VARIABLE_VALUE(656) = SRP_OP_FIN_TARGET_D
         R_VARIABLE_VALUE(657) = SRP_OP_FIN_MARGIN_D
         IF(ECON_SWITCH()) THEN
            IF(ECON_SALES()) THEN
               CALL GET_SRP_NON_DISPATCH_REV(SRP_NON_DISPATCH_REV)
            ELSE
               CALL GET_ECON_NON_DISPATCH_REV(SRP_NON_DISPATCH_REV)
            ENDIF
         ELSE
            SRP_NON_DISPATCH_REV = 0.
         ENDIF
         R_VARIABLE_VALUE(555) = SRP_NON_DISPATCH_REV    
!
! END SRP VARIABLES
!
      RETURN
!***********************************************************************
      ENTRY SEC_RATIOS(R_VARIABLE_VALUE)
!***********************************************************************
! 
         ANNUALIZED_LTD_INTEREST = REPORTING_VARIABLES(222)
         ANNUALIZED_PS_DIVIDENDS = REPORTING_VARIABLES(221)
         ANNUALIZED_STD_INTEREST = REPORTING_VARIABLES(225)
         EMBED_COST_CAPITAL_W_STD = REPORTING_VARIABLES(223)
         EMBED_COST_CAPITAL_WO_STD = REPORTING_VARIABLES(224)
         MARKET_VALUE = REPORTING_VARIABLES(52)
         DIVIDENDS_PER_SHARE = REPORTING_VARIABLES(56)
!
         TOTAL_INCOME_TAXES = REPORTING_VARIABLES(26) + & ! ATL Federal Income Taxes Paid
                              REPORTING_VARIABLES(24) + & ! ATL State Income Taxes Paid
                              REPORTING_VARIABLES(50) + & ! ITC Amortized
                              REPORTING_VARIABLES(36) + & ! BTL Federal and State Income Taxes
                              REPORTING_VARIABLES(28) + & ! ATL Deferred Taxes Cr
                              REPORTING_VARIABLES(29) + & ! ATL Deferred Taxes Dr
                              REPORTING_VARIABLES(294)  ! BTL Deferred Taxes
                              
         INTEREST = REPORTING_VARIABLES(39) + & ! LTD Interest
                    REPORTING_VARIABLES(40)     ! STD Interest
         NOPINC = REPORTING_VARIABLES(38) + &  ! Net Operating Income
                  REPORTING_VARIABLES(41)      ! AFDC borrowed
         AFDC1 =  REPORTING_VARIABLES(41) + &  ! AFDC borrowed
                  REPORTING_VARIABLES(37)      ! AFDC equity
!
!    ***** SEC RATIOS *******
! 
! TIMES INTEREST BEFORE INCOME TAXES SEC METHOD INCLUDING AFUDC
! TIMES INTEREST BEFORE INCOME TAXES SEC METHOD WITHOUT AFUDC
!
         IF(INTEREST /= 0.) THEN
            TIMES_INT_B4_INC_TAXES_W_AFDC = (NOPINC+TOTAL_INCOME_TAXES)/INTEREST
            TIMES_INT_B4_INC_TAXES_WO_AFDC = (NOPINC-AFDC1+TOTAL_INCOME_TAXES)/INTEREST
         ELSE   
            TIMES_INT_B4_INC_TAXES_W_AFDC = NOT_AVAIL
            TIMES_INT_B4_INC_TAXES_WO_AFDC = NOT_AVAIL
         ENDIF
!
! TIMES INTEREST & PS DIV BEFORE INCOME TAXES SEC METHOD INCLUDING AFUDC
! TIMES INTEREST & PS DIV BEFORE INCOME TAXES SEC METHOD WITHOUT AFUDC
!
         INTEREST_PS_DIV = INTEREST + REPORTING_VARIABLES(46) ! Preferred Dividends plus interest
         IF(INTEREST_PS_DIV /= 0.) THEN
            TIMES_INT_PS_B4_INC_TAX_W_AFDC = NOPINC/INTEREST_PS_DIV
            TIMES_INT_PS_B4_INC_TAX_WO_AFDC = (NOPINC - AFDC1)/INTEREST_PS_DIV
         ELSE   
            TIMES_INT_PS_B4_INC_TAX_W_AFDC = NOT_AVAIL
            TIMES_INT_PS_B4_INC_TAX_WO_AFDC = NOT_AVAIL
         ENDIF
!
! MORTAGE INDENTURE
!         
         MORTAGE_INDENTURE = REPORTING_VARIABLES(31) + & ! GOPINC
                             TOTAL_INCOME_TAXES + & 
                             MIN(.10*REPORTING_VARIABLES(47), & ! COMMON_EARNINGS
                                  REPORTING_VARIABLES(32) + &   ! Deferred Revenues
                                  REPORTING_VARIABLES(33) + &   ! Other Income
                                  REPORTING_VARIABLES(34) + &   ! Interest Income
                                  AFDC1)                        ! Total AFDUC
         IF(ANNUALIZED_LTD_INTEREST /= 0.) THEN
            MORTAGE_INDENTURE=MORTAGE_INDENTURE/ANNUALIZED_LTD_INTEREST
         ELSE
            MORTAGE_INDENTURE = NOT_AVAIL
         ENDIF
!
! ARTICLES_OF_INCORPORATION
!
         ARTICLES_OF_INCORPORATION= ANNUALIZED_LTD_INTEREST + ANNUALIZED_PS_DIVIDENDS + ANNUALIZED_STD_INTEREST
         IF(ARTICLES_OF_INCORPORATION /= 0.) THEN
            ARTICLES_OF_INCORPORATION=NOPINC/ARTICLES_OF_INCORPORATION
         ELSE
            ARTICLES_OF_INCORPORATION = NOT_AVAIL
         ENDIF
!
! DIVIDEND YIELD
!
         IF(MARKET_VALUE /= 0.) THEN
            DIVIDEND_YIELD = 100.*DIVIDENDS_PER_SHARE/MARKET_VALUE
         ELSE   
            DIVIDEND_YIELD = NOT_AVAIL
         ENDIF
!
! EFFECTIVE TAX RATE
!
         IF(REPORTING_VARIABLES(45)+TOTAL_INCOME_TAXES-REPORTING_VARIABLES(37) /= 0.) THEN
            EFFECTIVE_TAX_RATE = 100.*TOTAL_INCOME_TAXES/(REPORTING_VARIABLES(45)+TOTAL_INCOME_TAXES-REPORTING_VARIABLES(37)) 
                                                                                                                 ! 45 is net income
         ELSE
            EFFECTIVE_TAX_RATE = NOT_AVAIL   
         ENDIF
!
! ASSIGNING VARIABLES
!
         R_VARIABLE_VALUE(533) = TIMES_INT_B4_INC_TAXES_W_AFDC
         R_VARIABLE_VALUE(534) = TIMES_INT_B4_INC_TAXES_WO_AFDC
         R_VARIABLE_VALUE(535) = TIMES_INT_PS_B4_INC_TAX_W_AFDC
         R_VARIABLE_VALUE(536) = TIMES_INT_PS_B4_INC_TAX_WO_AFDC
         R_VARIABLE_VALUE(537) = MORTAGE_INDENTURE
         R_VARIABLE_VALUE(538) = ARTICLES_OF_INCORPORATION
         R_VARIABLE_VALUE(539) = ANNUALIZED_LTD_INTEREST
         R_VARIABLE_VALUE(540) = ANNUALIZED_PS_DIVIDENDS
         R_VARIABLE_VALUE(541) = ANNUALIZED_STD_INTEREST
         R_VARIABLE_VALUE(542) = DIVIDEND_YIELD
         R_VARIABLE_VALUE(543) = TOTAL_INCOME_TAXES
         R_VARIABLE_VALUE(544) = EFFECTIVE_TAX_RATE
         R_VARIABLE_VALUE(545) = EMBED_COST_CAPITAL_W_STD
         R_VARIABLE_VALUE(546) = EMBED_COST_CAPITAL_WO_STD
         
      RETURN
!***********************************************************************
      ENTRY SUB_SEC_RATIOS(R_VARIABLE_VALUE)
!***********************************************************************
! 
         ANNUALIZED_LTD_INTEREST = R_VARIABLE_VALUE(222)
         ANNUALIZED_PS_DIVIDENDS = R_VARIABLE_VALUE(221)
         ANNUALIZED_STD_INTEREST = R_VARIABLE_VALUE(225)
         EMBED_COST_CAPITAL_W_STD = R_VARIABLE_VALUE(223)
         EMBED_COST_CAPITAL_WO_STD = R_VARIABLE_VALUE(224)
         MARKET_VALUE = R_VARIABLE_VALUE(52)
         DIVIDENDS_PER_SHARE = R_VARIABLE_VALUE(56)
         SHARES_OUTSTANDING_YR_END = R_VARIABLE_VALUE(299)
!
         R_VARIABLE_VALUE(29) = R_VARIABLE_VALUE(681) + R_VARIABLE_VALUE(682) + R_VARIABLE_VALUE(733)
         TOTAL_INCOME_TAXES = R_VARIABLE_VALUE(26) + & ! ATL Federal Income Taxes Paid
                              R_VARIABLE_VALUE(24) + & ! ATL State Income Taxes Paid
                              R_VARIABLE_VALUE(50) + & ! ITC Amortized
                              R_VARIABLE_VALUE(36) + & ! BTL Federal and State Income Taxes
                              R_VARIABLE_VALUE(28) + & ! ATL Deferred Taxes Cr
                              R_VARIABLE_VALUE(29) + & ! ATL Deferred Taxes Dr
                              R_VARIABLE_VALUE(294)  ! BTL Deferred Taxes
                              
         INTEREST = R_VARIABLE_VALUE(293) + & ! LTD Interest
                    R_VARIABLE_VALUE(40)   ! STD Interest
         NOPINC = R_VARIABLE_VALUE(38) + & ! Net Operating Income
                  R_VARIABLE_VALUE(41)     ! AFDC borrowed
         AFDC1 =  R_VARIABLE_VALUE(41) + & ! AFDC borrowed
                  R_VARIABLE_VALUE(37)     ! AFDC equity
!
!
! RATIOS
!
         SHORT_TERM_DEBT_BAL = R_VARIABLE_VALUE(84)
         PREFERRED_STOCK_BAL = R_VARIABLE_VALUE(80)
         LONG_TERM_DEBT_BAL = R_VARIABLE_VALUE(81)
         COMMON_EQUITY_BAL = R_VARIABLE_VALUE(79)
         TOTAL_CAPITIAL_BAL = COMMON_EQUITY_BAL + SHORT_TERM_DEBT_BAL + PREFERRED_STOCK_BAL + LONG_TERM_DEBT_BAL &
                              + R_VARIABLE_VALUE(730) ! OCI BALANCE
         
         IF(ABS(TOTAL_CAPITIAL_BAL) > .00001) THEN
            CAPITAL_MULTIPILER = 100./TOTAL_CAPITIAL_BAL
         ELSE
            CAPITAL_MULTIPILER = 0.
         ENDIF
         R_VARIABLE_VALUE(364) = PREFERRED_STOCK_BAL*CAPITAL_MULTIPILER
         R_VARIABLE_VALUE(365) = LONG_TERM_DEBT_BAL * CAPITAL_MULTIPILER
         R_VARIABLE_VALUE(366) = CAPITAL_MULTIPILER * (COMMON_EQUITY_BAL + R_VARIABLE_VALUE(730))                         
         R_VARIABLE_VALUE(367) = SHORT_TERM_DEBT_BAL*CAPITAL_MULTIPILER
!
         FUNDS_FROM_OPERATIONS = R_VARIABLE_VALUE(632) - R_VARIABLE_VALUE(387) - R_VARIABLE_VALUE(405)
         CONSTRUCTION_AND_NET_INVESTMENT = R_VARIABLE_VALUE(110) + R_VARIABLE_VALUE(111)
         IF(CONSTRUCTION_AND_NET_INVESTMENT /= 0.) THEN
            R_VARIABLE_VALUE(368) = FUNDS_FROM_OPERATIONS/CONSTRUCTION_AND_NET_INVESTMENT
         ELSE
            R_VARIABLE_VALUE(368) = 0.
         ENDIF
!    ***** SEC RATIOS *******
! 
! TIMES INTEREST BEFORE INCOME TAXES SEC METHOD INCLUDING AFUDC
! TIMES INTEREST BEFORE INCOME TAXES SEC METHOD WITHOUT AFUDC
!
         IF(ABS(INTEREST) >= 0.0001) THEN
            TIMES_INT_B4_INC_TAXES_W_AFDC = (NOPINC+TOTAL_INCOME_TAXES)/INTEREST
            TIMES_INT_B4_INC_TAXES_WO_AFDC = (NOPINC-AFDC1+TOTAL_INCOME_TAXES)/INTEREST
         ELSE   
            TIMES_INT_B4_INC_TAXES_W_AFDC = NOT_AVAIL
            TIMES_INT_B4_INC_TAXES_WO_AFDC = NOT_AVAIL
         ENDIF
!
! TIMES INTEREST & PS DIV BEFORE INCOME TAXES SEC METHOD INCLUDING AFUDC
! TIMES INTEREST & PS DIV BEFORE INCOME TAXES SEC METHOD WITHOUT AFUDC
!
         INTEREST_PS_DIV = INTEREST + R_VARIABLE_VALUE(46) ! Preferred Dividends plus interest
         IF(ABS(INTEREST_PS_DIV) >= 0.0001) THEN
            TIMES_INT_PS_B4_INC_TAX_W_AFDC = NOPINC/INTEREST_PS_DIV
            TIMES_INT_PS_B4_INC_TAX_WO_AFDC = (NOPINC - AFDC1)/INTEREST_PS_DIV
         ELSE   
            TIMES_INT_PS_B4_INC_TAX_W_AFDC = NOT_AVAIL
            TIMES_INT_PS_B4_INC_TAX_WO_AFDC = NOT_AVAIL
         ENDIF
!
! MORTAGE INDENTURE
!         
         MORTAGE_INDENTURE = R_VARIABLE_VALUE(31) + & ! GOPINC
                             TOTAL_INCOME_TAXES + &
                             MIN(.10*R_VARIABLE_VALUE(47), & ! COMMON_EARNINGS
                                  R_VARIABLE_VALUE(32) + &   ! Deferred Revenues
                                  R_VARIABLE_VALUE(33) + &   ! Other Income
                                  R_VARIABLE_VALUE(34) + &   ! Interest Income
                                  AFDC1)                       ! Total AFDUC
         IF(ANNUALIZED_LTD_INTEREST /= 0.) THEN
            MORTAGE_INDENTURE=MORTAGE_INDENTURE/ANNUALIZED_LTD_INTEREST
         ELSE
            MORTAGE_INDENTURE = NOT_AVAIL
         ENDIF
!
! ARTICLES_OF_INCORPORATION
!
         ARTICLES_OF_INCORPORATION= ANNUALIZED_LTD_INTEREST + ANNUALIZED_PS_DIVIDENDS + ANNUALIZED_STD_INTEREST
         IF(ARTICLES_OF_INCORPORATION /= 0.) THEN
            ARTICLES_OF_INCORPORATION=NOPINC/ARTICLES_OF_INCORPORATION
         ELSE
            ARTICLES_OF_INCORPORATION = NOT_AVAIL
         ENDIF
!
! DIVIDEND YIELD
!
         IF(SHARES_OUTSTANDING_YR_END >= .0001) THEN
            IF(ABS(MARKET_VALUE) >= 0.0001) THEN
               DIVIDEND_YIELD = 100.*DIVIDENDS_PER_SHARE/MARKET_VALUE
            ELSE   
               DIVIDEND_YIELD = NOT_AVAIL
            ENDIF
         ELSE
            IF(ABS(R_VARIABLE_VALUE(79)) >= 0.0001) THEN
               DIVIDEND_YIELD = 100.*R_VARIABLE_VALUE(48)/R_VARIABLE_VALUE(79)
            ELSE
               DIVIDEND_YIELD = NOT_AVAIL
            ENDIF   
         ENDIF
!
! EFFECTIVE TAX RATE
!
         IF(R_VARIABLE_VALUE(45)+TOTAL_INCOME_TAXES-AFDC1 /= 0.) THEN
            EFFECTIVE_TAX_RATE = 100.*TOTAL_INCOME_TAXES/(R_VARIABLE_VALUE(45)+TOTAL_INCOME_TAXES-AFDC1) ! 45 is net income
         ELSE
            EFFECTIVE_TAX_RATE = NOT_AVAIL   
         ENDIF
!
! GROSS CASH FLOW TO TOTAL DEBT=MOODY'S
!
         GROSS_CASH_FLOW = R_VARIABLE_VALUE(632) ! 109 FUNDS_FROM_OPERATIONS

         TOTAL_DEBT =  R_VARIABLE_VALUE(634) ! LONG_TERM_DEBT(2,R_CLASS_POS)

         GROSS_CASH_2_DEBT = THE_PERCENT_OF_A_TO_B(GROSS_CASH_FLOW,TOTAL_DEBT) 
!
! ASSIGNING VARIABLES
!
         R_VARIABLE_VALUE(633) = GROSS_CASH_2_DEBT
         R_VARIABLE_VALUE(565) = TIMES_INT_B4_INC_TAXES_W_AFDC
         R_VARIABLE_VALUE(566) = TIMES_INT_B4_INC_TAXES_WO_AFDC
         R_VARIABLE_VALUE(567) = TIMES_INT_PS_B4_INC_TAX_W_AFDC
         R_VARIABLE_VALUE(568) = TIMES_INT_PS_B4_INC_TAX_WO_AFDC
         R_VARIABLE_VALUE(569) = MORTAGE_INDENTURE
         R_VARIABLE_VALUE(570) = ARTICLES_OF_INCORPORATION
         R_VARIABLE_VALUE(571) = DIVIDEND_YIELD
         R_VARIABLE_VALUE(572) = TOTAL_INCOME_TAXES
         R_VARIABLE_VALUE(573) = EFFECTIVE_TAX_RATE
         R_VARIABLE_VALUE(574) = ANNUALIZED_LTD_INTEREST + ANNUALIZED_PS_DIVIDENDS + ANNUALIZED_STD_INTEREST
         
         IF(ABS(R_VARIABLE_VALUE(47)) >= 0.0001) THEN ! COMMON_EARNINGS
            R_VARIABLE_VALUE(575) = 100.*AFDC1/R_VARIABLE_VALUE(47) ! AFDC1_TO_COMMON_EARNINGS
         ELSE
            R_VARIABLE_VALUE(575) = 0.
         ENDIF
         COVERAGE_RATIO_VALUE = R_VARIABLE_VALUE(31) &   ! GOPINC
                                - R_VARIABLE_VALUE(50) & ! ITCAMT
                                + R_VARIABLE_VALUE(34) & ! INTINC
                                + R_VARIABLE_VALUE(33) & ! OTHINC
                                + R_VARIABLE_VALUE(17) & ! BKDPPT + BDPAFC +
                                + R_VARIABLE_VALUE(18) & ! AMTEXP
                                + R_VARIABLE_VALUE(29) & ! TXDEFP
                                + R_VARIABLE_VALUE(28)   ! TXNORM
         LTD_STD_INTEREST = R_VARIABLE_VALUE(39) + & ! LTDINT(RUN_YEAR) 
                            R_VARIABLE_VALUE(40)     ! STDINT(2)
         LTD_PS_RETIREMENT = R_VARIABLE_VALUE(154) & ! Preferred Stock Retirements
                             + R_VARIABLE_VALUE(119)   ! Debt Retirements
         INTEREST = LTD_STD_INTEREST + R_VARIABLE_VALUE(119)  ! LTD Retirements
         IF(ABS(INTEREST) >= 0.0001) THEN
            COVERAGE_RATIO_VALUE = R_VARIABLE_VALUE(109)/INTEREST
         ELSE
            COVERAGE_RATIO_VALUE = 0.
         ENDIF
         R_VARIABLE_VALUE(576) = COVERAGE_RATIO_VALUE
         IF(R_VARIABLE_VALUE(365) == NOT_AVAIL .OR. R_VARIABLE_VALUE(367) == NOT_AVAIL) THEN
            R_VARIABLE_VALUE(577) = NOT_AVAIL
         ELSE
            R_VARIABLE_VALUE(577) = R_VARIABLE_VALUE(365) + R_VARIABLE_VALUE(367)
         ENDIF
         RETURN
!***********************************************************************
         ENTRY COVERAGE_RATIO_RPT(R_VARIABLE_VALUE,COVERAGE_RATIO_TYPE,OPERATING_METHOD,SRP_RATIO)
!***********************************************************************
!
! VARIOUS COVERAGE RATIOS
!
         GOPINC = R_VARIABLE_VALUE(31)    ! GOPINC
         TAXES_PAID = R_VARIABLE_VALUE(211) + & ! FEDERAL TAXES PAID
                      R_VARIABLE_VALUE(212)     ! STAET TAXEPAID
         ITC_ITCAMT = R_VARIABLE_VALUE(50) ! ITCAMT
         INTINC = R_VARIABLE_VALUE(34)
         OTHINC = R_VARIABLE_VALUE(33)
         BTL_TAXES = R_VARIABLE_VALUE(36)
         DEP_AMORTIZATION = R_VARIABLE_VALUE(17) + & ! BKDPPT + BDPAFC +
                            R_VARIABLE_VALUE(18)     ! AMTEXP
         AFUDC_ON_CASH = R_VARIABLE_VALUE(37) + & ! AFDC1-TAFDCB
                         R_VARIABLE_VALUE(41)     ! TAFDCB
         RTEMP = GOPINC + ITC_ITCAMT + TAXES_PAID
         LTD_STD_INTEREST = R_VARIABLE_VALUE(39) + & ! LTDINT(RUN_YEAR)
                            R_VARIABLE_VALUE(40)     ! STDINT(2)
         LTD_PS_RETIREMENT = R_VARIABLE_VALUE(154) + & ! Preferred Stock Retirements
                             R_VARIABLE_VALUE(119)     ! Debt Retirements
!
! COVERAGE RATIO RESULT FOR THE RATIO CHOOSEN
!
         COVERAGE_DRIVER_RATIO = NOT_AVAIL
         IF(COVERAGE_RATIO_TYPE == 1) THEN
!           LTD_STD_INTEREST = LTDINT(RUN_YEAR) + STDINT(2)
            IF(LTD_STD_INTEREST /= 0.) COVERAGE_DRIVER_RATIO = GOPINC/LTD_STD_INTEREST
         ELSEIF(COVERAGE_RATIO_TYPE == 11) THEN
!           LTD_STD_INTEREST = LTDINT(RUN_YEAR) + STDINT(2)
            LTD_INTEREST_LESS_AFUDC = R_VARIABLE_VALUE(293) &  ! LTD BOOKED INTEREST WITH AMORT
                                      - R_VARIABLE_VALUE(41)   ! afudc borrowed
            IF(LTD_INTEREST_LESS_AFUDC /= 0.) COVERAGE_DRIVER_RATIO = (LTD_INTEREST_LESS_AFUDC + R_VARIABLE_VALUE(45))/ &
                                           LTD_INTEREST_LESS_AFUDC
         ELSEIF(COVERAGE_RATIO_TYPE == 2 .OR. COVERAGE_RATIO_TYPE == 3) THEN
            RTEMP = GOPINC+ITC_ITCAMT+TAXES_PAID+INTINC+OTHINC-BTL_TAXES - R_VARIABLE_VALUE(35)   ! CLASS_BTL_EXPENSES

            IF(COVERAGE_RATIO_TYPE == 2) LTD_STD_INTEREST = LTD_STD_INTEREST - AFUDC_ON_CASH
            IF(LTD_STD_INTEREST /= 0.) COVERAGE_DRIVER_RATIO = RTEMP/LTD_STD_INTEREST
         ELSEIF(COVERAGE_RATIO_TYPE == 8 .OR. COVERAGE_RATIO_TYPE == 9) THEN
            LEASE_PAYMENT_LIMIT = MAX(0.,R_VARIABLE_VALUE(778) - .02*R_VARIABLE_VALUE(79))/3. ! COMEQU(2)
            RTEMP = GOPINC+ITC_ITCAMT+TAXES_PAID+INTINC+OTHINC-BTL_TAXES + LEASE_PAYMENT_LIMIT
            INTEREST = LTD_STD_INTEREST - AFUDC_ON_CASH + LEASE_PAYMENT_LIMIT
            IF(COVERAGE_RATIO_TYPE == 9) INTEREST=INTEREST+AFUDC_ON_CASH
            IF(INTEREST /= 0.) COVERAGE_DRIVER_RATIO=RTEMP/INTEREST
         ELSEIF(COVERAGE_RATIO_TYPE == 4 .OR. COVERAGE_RATIO_TYPE == 5) THEN
            INTEREST = LTD_STD_INTEREST + LTD_PS_RETIREMENT
            RTEMP = GOPINC + ITC_ITCAMT + OTHINC + INTINC + DEP_AMORTIZATION + &
                    R_VARIABLE_VALUE(29) + & ! TXDEFP
                    R_VARIABLE_VALUE(28)     ! TXNORM
            IF(INTEREST /= 0.) COVERAGE_DRIVER_RATIO=RTEMP/INTEREST
         ELSEIF(COVERAGE_RATIO_TYPE == 6 .OR. COVERAGE_RATIO_TYPE == 7) THEN
               SRP_TOTAL_DEBT_SERVICE = R_VARIABLE_VALUE(39) + &  ! LTDINT(RUN_YEAR) +
                                        R_VARIABLE_VALUE(119) + & ! LTDRET(RUN_YEAR)
                                        R_VARIABLE_VALUE(154)     ! PSRED(RUN_YEAR)
! NOTE OTNINC IS NET OF BLT_EXPENSES

               SRP_FUNDS_FOR_DEBT_SERVICE = R_VARIABLE_VALUE(31) + & ! GOPINC
                                            R_VARIABLE_VALUE(34) - & ! INTINC -
                                            R_VARIABLE_VALUE(40) + & ! STDINT(2) +
                                            R_VARIABLE_VALUE(33) + & ! OTHINC +
                                            DEP_AMORTIZATION + &     ! BKDPPT + BDPAFC + AMTEXP
                                            R_VARIABLE_VALUE(217)   ! TXPROP +
               IF(SRP_TOTAL_DEBT_SERVICE /= 0.) COVERAGE_DRIVER_RATIO = SRP_FUNDS_FOR_DEBT_SERVICE/SRP_TOTAL_DEBT_SERVICE
               IF(OPERATING_METHOD=='C') COVERAGE_DRIVER_RATIO=SRP_RATIO

         ENDIF
         R_VARIABLE_VALUE(757) = COVERAGE_DRIVER_RATIO
      RETURN
      END
!***********************************************************************
      SUBROUTINE LAG_CASH_USING_PATTERN_ALL_YRS(R_YRS,R_BOOK_VALUES,R_CASH_LAG_PATTERN,R_CASH_PAYMENTS,R_CASH_VALUES)
!***********************************************************************
!
      INTEGER (KIND=2) :: R_YRS
      REAL (KIND=4) :: R_BOOK_VALUES(0:12,0:R_YRS),R_CASH_LAG_PATTERN(12),R_CASH_PAYMENTS(12),R_CASH_VALUES(0:12,0:R_YRS)
      INTEGER (KIND=2) :: MO,YR,LAG_MO
!
!
         DO YR = 1, R_YRS
            DO MO = 1, 12
! MOVE CASH ACCURRED LAST YEAR TO THIS YEAR
               R_CASH_VALUES(MO,YR) = R_CASH_PAYMENTS(MO)
               R_CASH_PAYMENTS(MO) = 0.
            ENDDO
            DO MO = 1, 12
               DO LAG_MO = 1, 13-MO
                  R_CASH_VALUES(MO+LAG_MO-1,YR) = R_CASH_VALUES(MO+LAG_MO-1,YR) + R_CASH_LAG_PATTERN(LAG_MO) * R_BOOK_VALUES(MO,YR)
               
               ENDDO
               DO LAG_MO = 14-MO, 12
                  R_CASH_PAYMENTS(LAG_MO+MO-13) = R_CASH_LAG_PATTERN(LAG_MO) * R_BOOK_VALUES(MO,YR)
               ENDDO
               R_CASH_VALUES(0,YR) = R_CASH_VALUES(0,YR) + R_CASH_VALUES(MO,YR)
            ENDDO
         ENDDO
      RETURN
      END
!***********************************************************************
      SUBROUTINE CONSOLIDATING_ADJS_NA(R_VARIABLES)
!***********************************************************************
!
      REAL :: R_VARIABLES(0:*),THE_RATIO_OF_A_TO_B
      REAL (KIND=4) :: NOT_AVAIL
      PARAMETER(NOT_AVAIL=-999999.)
!
! VARIABLE IN SEC RATIOS REPORT
!
         R_VARIABLES(565) = NOT_AVAIL  ! TIE Before Taxes with AFUDC,565,
         R_VARIABLES(566) = NOT_AVAIL  ! TIE Before Taxes without AFUDC,566,
         R_VARIABLES(567) = NOT_AVAIL  ! TIE & Preferred Dividends Earned after Taxes with AFUDC,567,
         R_VARIABLES(568) = NOT_AVAIL  ! TIE & Preferred Dividends Earned after Taxes without AFUDC,568,
         R_VARIABLES(569) = NOT_AVAIL  ! Mortgage Indenture,569,
         R_VARIABLES(570) = NOT_AVAIL  ! Article of Incorporation,570,
         R_VARIABLES(571) = NOT_AVAIL  ! Dividend Yield (%),571,
         R_VARIABLES(573) = NOT_AVAIL  ! Effective Income Tax Rate (%),573,
         R_VARIABLES(223) = NOT_AVAIL  ! Embed Cost Capital with STD (%),223,
         R_VARIABLES(224) = NOT_AVAIL  ! Embed Cost Capital without STD (%),224,
         R_VARIABLES(52)  = NOT_AVAIL  ! Market Price Per Share,52,
         R_VARIABLES(56)  = NOT_AVAIL  ! Dividends per Share ($),56,
         R_VARIABLES(222) = NOT_AVAIL  ! Annualized LTD Cost,222,
         R_VARIABLES(221) = NOT_AVAIL  ! Annualized PFS Cost,221,
         R_VARIABLES(225) = NOT_AVAIL  ! Annualized STD Cost,225,
         R_VARIABLES(574) = NOT_AVAIL  ! Total Annualized Cost,574,
         R_VARIABLES(366) = NOT_AVAIL  ! Common Equity (%),366,
         R_VARIABLES(364) = NOT_AVAIL  ! Preferred Stock (%),364,
         R_VARIABLES(365) = NOT_AVAIL  ! Long Term Debt (%),365,
         R_VARIABLES(367) = NOT_AVAIL  ! Short Term Debt (%),367,
         R_VARIABLES(577) = NOT_AVAIL  ! Long Term + Short Term Debt (%),577,
         R_VARIABLES(575) = NOT_AVAIL  ! AFUDC in Earnings (%),575,
         R_VARIABLES(368) = NOT_AVAIL  ! Internal Cash to Construction Expense,368,
         R_VARIABLES(576) = NOT_AVAIL  ! Cash Coverage Ratio,576,
         R_VARIABLES(633) = NOT_AVAIL  ! Gross Cash Flow to Debt (%),633,
         R_VARIABLES(635) = NOT_AVAIL  ! EBITA to Debt (%),635,

      RETURN
      END
!***********************************************************************
      FUNCTION FEDERAL_TAX_TABLE(TAXABLE_INCOME)
!***********************************************************************
!
      REAL (KIND=4) :: FEDERAL_TAX_TABLE,TAXABLE_INCOME
!
         IF(TAXABLE_INCOME > 18.333333) THEN
            FEDERAL_TAX_TABLE = .35*TAXABLE_INCOME
         ELSEIF(TAXABLE_INCOME > 15.) THEN   
            FEDERAL_TAX_TABLE = 5.15 + .38*(TAXABLE_INCOME-15.)
         ELSEIF(TAXABLE_INCOME > 10.) THEN   
            FEDERAL_TAX_TABLE = 3.40 + .35*(TAXABLE_INCOME-10.)
         ELSEIF(TAXABLE_INCOME > .335) THEN   
            FEDERAL_TAX_TABLE = .1139 + .34*(TAXABLE_INCOME-.335)
         ELSEIF(TAXABLE_INCOME > .100) THEN   
            FEDERAL_TAX_TABLE = .02225 + .39*(TAXABLE_INCOME-.100)
         ELSEIF(TAXABLE_INCOME > .075) THEN   
            FEDERAL_TAX_TABLE = .01375 + .34*(TAXABLE_INCOME-.075)
         ELSEIF(TAXABLE_INCOME > .050) THEN   
            FEDERAL_TAX_TABLE = .0075 + .25*(TAXABLE_INCOME-.050)
         ELSE
            FEDERAL_TAX_TABLE = .15*TAXABLE_INCOME
         ENDIF
      RETURN   
      END
!***********************************************************************
      SUBROUTINE GRE_DSC_REPORT(R_VARIABLE)
!***********************************************************************
      REAL (KIND=4) :: R_VARIABLE(0:*),THE_RATIO_OF_A_TO_B,TARGET_DSC,R_TARGET_DSC,PrinIntrPayments,MarginIntExpDep,TwoPercentTest
!
         TARGET_DSC = 1
         R_VARIABLE(761) = & ! GRE_TOTAL_INTEREST_EXPENSE), ! 761
                           R_VARIABLE(760) &  ! GRE_FALKIRK_INTEREST),  ! 760
                           + R_VARIABLE(39) & ! CASH INTEREST EXPENSE
                           + R_VARIABLE(677)  ! LEASE INTEREST EXPENSE
         R_VARIABLE(763) = & ! GRE_TOTAL_DEPRECIATION), ! 763
                           R_VARIABLE(17) &    ! BOOK DEPRECIATION
                           + R_VARIABLE(291) & ! AMORTIZATION
                           + R_VARIABLE(762)   ! GRE_FALKIRK_DEPRECIATION), ! 762
         R_VARIABLE(766) = & ! GRE_TOTAL_PRINCIPAL_PAYMENTS), ! 766
                           R_VARIABLE(777) &   ! LTD AND MGT PRINCIPAL PAYMENTS
                           + R_VARIABLE(680) & ! LEASE PAYMENTS
                           + R_VARIABLE(764) & ! GRE_OTHER_PRINCIPAL_ADJS  ! 764
                           + R_VARIABLE(765)   ! GRE_PRINCIPAL_MANUAL_ADJS ! 765
         R_VARIABLE(768) = & ! GRE_TOTAL_INTEREST_PAYMENTS), ! 768
                           R_VARIABLE(39) & ! INTEREST EXPENSE
                           + R_VARIABLE(767)  ! GRE_INTEREST_PAYMENTS_MANUAL_ADJS), ! 767
         R_VARIABLE(770) = & ! GRE_TOTAL COST OF SERVICE), ! 770
                           R_VARIABLE(20) &    ! TOTAL OPERATING EXPENSES
                           + R_VARIABLE(217) & ! PROPERTY TAXES
                           + R_VARIABLE(39)    ! CASH_INTEREST_EXPENSE
         R_VARIABLE(771) = & ! GRE_OTHER_INCOME), ! 771
                           R_VARIABLE(41) + R_VARIABLE(37) + R_VARIABLE(33) + R_VARIABLE(34)
         R_VARIABLE(772) = & ! GRE_OTHER_REVENUE), ! 772
                           R_VARIABLE(3) ! OTHER REVENUE

         R_VARIABLE(769) = & ! GRE_NET_MARGIN), ! 769
                           R_VARIABLE(0) & ! WAS R_VARIABLE(4)   ! TOTAL revenues
                           - R_VARIABLE(770) + R_VARIABLE(771) & ! was a minus
                           + R_VARIABLE(772)
         PrinIntrPayments = R_VARIABLE(766) & ! GRE_TOTAL_PRINCIPAL_PAYMENTS), ! 766
                            + R_VARIABLE(768) ! GRE_TOTAL_INTEREST_PAYMENTS), ! 768
         MarginIntExpDep = R_VARIABLE(769) &   ! GRE_NET_MARGIN), ! 769
                           + R_VARIABLE(761) & ! GRE_TOTAL_INTEREST_EXPENSE), ! 761
                           + R_VARIABLE(763)   ! GRE_TOTAL_DEPRECIATION), ! 763
         R_VARIABLE(773) = THE_RATIO_OF_A_TO_B(MarginIntExpDep,PrinIntrPayments)! GRE_DSC) ! 773
         R_VARIABLE(776) = R_VARIABLE(770) - R_VARIABLE(771) - R_VARIABLE(772)
         TwoPercentTest = THE_RATIO_OF_A_TO_B(R_VARIABLE(0),R_VARIABLE(776))
         R_VARIABLE(775) = 100.*(TwoPercentTest -1.)
      RETURN
      END
!***********************************************************************
      SUBROUTINE EBITDA_REPORT(R_VARIABLES)
!***********************************************************************
      REAL R_VARIABLES(0:*),THE_RATIO_OF_A_TO_B
      REAL (KIND=4) :: NOT_AVAIL
      PARAMETER(NOT_AVAIL=-999999.)
      REAL (KIND=4) :: TOTAL_OPERATING_EXPENSES,BTL_TOTALS,TOTAL_TAXES_NON_INCOME,TOTAL_DEP_AMORT,EBIT,TOTAL_INTEREST, &
                       TOTAL_INCOME_TAXES,EBITDA,INCOME_AFTER_INTEREST,TOTAL_NON_REGULATED_REVENUES,TIER_INTEREST
      REAL (KIND=4) :: EBITDA_2_DEBT,THE_PERCENT_OF_A_TO_B,TOTAL_DEBT
!
         TOTAL_NON_REGULATED_REVENUES = R_VARIABLES(1) &     ! +Fuel Clause Revenues",V,1
                                        + R_VARIABLES(474) & ! +PGA Revenues",V,474
                                        + R_VARIABLES(563) & ! +Competitive Sales
                                        + R_VARIABLES(564) & ! +Sales to other Utilitiies
                                        + R_VARIABLES(2) &   ! +Secondary Energy Sales",V,2
                                        + R_VARIABLES(380) & ! +Secondary Capacity Sales",V,380
                                        + R_VARIABLES(631) & ! +ICAP Revenues
                                        + R_VARIABLES(333) & ! +Bulk Power Revenues",V,333
                                        + R_VARIABLES(3) &   ! +Other Revenues",V,3
                                        + R_VARIABLES(307) & ! +Gas Revenues",V,307
                                        + R_VARIABLES(328) & ! +RelationshipRevenues",V,328
                                        + R_VARIABLES(239) & ! +Regulatory Credit",V,239
                                        + R_VARIABLES(449) ! +Derivative Revenues
!
         TOTAL_OPERATING_EXPENSES = R_VARIABLES(13) +    R_VARIABLES(5) +        R_VARIABLES(438) +   R_VARIABLES(233) &   
                          !Salaries & Wages,13 Up| - Up| Fossil Fuel Expense,5 - Up| Nuclear Fuel -   Up| Decommissioning
                                    + R_VARIABLES(232)   + R_VARIABLES(461)    + R_VARIABLES(393)   +       R_VARIABLES(8) &
                      !DOE Deposal Up| - !Purchased Power Expense,461 Up| - Up|Deferred Fuel Expense,393 - Up|Fxd O&M Prod Expense,8
                                    + R_VARIABLES(363)   + R_VARIABLES(450)    + R_VARIABLES(421)   + R_VARIABLES(422) &
                !Variable O&M Production Expense,363 Up|-Up|Total Derivative Expense-Up|O&M Vacation,421 Up| O&M Pension,422
                                    + R_VARIABLES(423)   + R_VARIABLES(9)      + R_VARIABLES(440)   + R_VARIABLES(11) &
                                   !O&M storm,423 Up| - Service Transaction Expense,9 Up| - Up| Other O&M,440 - Up|Gas Purchases,11
                                    + R_VARIABLES(12) & !Other Expenses,12
                                    + R_VARIABLES(335) & !Transmission Operation,335
                                    + R_VARIABLES(336) & !Transmission Maintenance,336
                                    + R_VARIABLES(337) & !Distribution Operation,337
                                    + R_VARIABLES(338) & !Distribution Maintenance,338
                                    + R_VARIABLES(321)   + R_VARIABLES(322)    + R_VARIABLES(323) +    R_VARIABLES(324) &
                            !Customer Accounts,321 Up| - Up|CustomerServices,322 - Up|SalesExpense,323 - Up|A&G Operations,324
                                    + R_VARIABLES(325)   + R_VARIABLES(354)    + R_VARIABLES(13)  +    R_VARIABLES(14)  &
                            !A&G Maintenance,325 |Up - Lease Expenses,354 |Up - Up| DSM Program Expense - Up|DSM Program Rebate
                                    + R_VARIABLES(15) & !Emissions Credit Expense,15
                                    + R_VARIABLES(290) & !Retirement Medical Expense,290
                                    + R_VARIABLES(240)  !Special Expenses
         TOTAL_NON_REGULATED_REVENUES = R_VARIABLES(485)

         BTL_TOTALS =  R_VARIABLES(32) &   ! Deferred Revenues,32
                       + R_VARIABLES(33) & ! +Other Income,33
                       + R_VARIABLES(34) & ! +Interest Income,34
                       + R_VARIABLES(37) & ! +AFUDC Equity,37
                       + R_VARIABLES(41) & ! +AFUDC Borrowed,41
                       + R_VARIABLES(43) & ! +Subsidiary Income,43
                       - R_VARIABLES(35) & ! -Expenses,35
                       - R_VARIABLES(44)   ! -Extraordinary Items,44
!
         TOTAL_TAXES_NON_INCOME = R_VARIABLES(21) &  ! -Operating Revenue Tax,21
                                  + R_VARIABLES(22) & ! -Other Taxes,22
                                  + R_VARIABLES(217) & ! -Property Taxes,217
                                  + R_VARIABLES(25) & ! -State Tax on Capital,25
                                  + R_VARIABLES(27)  ! -Federal Tax on Capital,27
!
         EBITDA = R_VARIABLES(4) & ! TOTAL OPERATING REVENUES
                  - TOTAL_OPERATING_EXPENSES + BTL_TOTALS - TOTAL_TAXES_NON_INCOME
!
         TOTAL_DEP_AMORT = R_VARIABLES(17) &   ! -Depreciation Expense,17
                           + R_VARIABLES(291) & ! -Amortization Expense,291
                           + R_VARIABLES(19) &  ! -CIAC Amortization Expense,19
                           + R_VARIABLES(350) & ! -BTL Amortization,350
                           + R_VARIABLES(460) & ! Purpurchased Power Amort
                           + R_VARIABLES(393) & ! Deferred Fuel Expense
                           + R_VARIABLES(362) & ! Variable O&M Amort
                           + R_VARIABLES(439)  ! Other O&M Amort
!
         EBIT = EBITDA - TOTAL_DEP_AMORT
!
         TOTAL_INTEREST = R_VARIABLES(293) & ! -Interest on Long Term Debt,293
                          + R_VARIABLES(40) ! -Interest on Short Term Debt,40
!
         INCOME_AFTER_INTEREST = EBIT - TOTAL_INTEREST
!
         R_VARIABLES(29) = R_VARIABLES(681) + R_VARIABLES(682) + R_VARIABLES(733)
         TOTAL_INCOME_TAXES = R_VARIABLES(24) &  ! -State Income Taxes Paid,24
                              + R_VARIABLES(26) & ! -Federal Income Taxes Paid,26
                              + R_VARIABLES(28) & ! -Income Tax Deferrals (Dr),28
                              + R_VARIABLES(29) & ! -Income Tax Deferrals (Cr),29
                              + R_VARIABLES(50) & ! -Investment Tax Credit,50
                              + R_VARIABLES(36) & ! -BTL Income Taxes,36
                              + R_VARIABLES(294) & ! -BTL Income Tax Deferrals,294
                              - R_VARIABLES(376) ! +Unused Federal Tax Credits,376
!
         TOTAL_DEBT =  R_VARIABLES(634) ! LONG_TERM_DEBT(2,R_CLASS_POS)

         EBITDA_2_DEBT = THE_PERCENT_OF_A_TO_B(EBITDA,TOTAL_DEBT) 

!
         R_VARIABLES(635) = EBITDA_2_DEBT
         R_VARIABLES(476) = TOTAL_OPERATING_EXPENSES
         R_VARIABLES(477) = BTL_TOTALS
         R_VARIABLES(495) = BTL_TOTALS &
                            - R_VARIABLES(43) & ! BTL Totals without Subsidiary Income,43
                            - R_VARIABLES(33) & ! BTL Other Revenue,33
                            - R_VARIABLES(34)   ! Interest Income,34
         R_VARIABLES(478) = TOTAL_TAXES_NON_INCOME
         ! earnings bf interest, taxes, depreciation
         R_VARIABLES(479) = EBITDA
         R_VARIABLES(480) = TOTAL_DEP_AMORT
         R_VARIABLES(481) = EBIT
         R_VARIABLES(482) = TOTAL_INTEREST
         R_VARIABLES(483) = TOTAL_INCOME_TAXES
         R_VARIABLES(484) = INCOME_AFTER_INTEREST
         R_VARIABLES(667) = THE_RATIO_OF_A_TO_B(EBIT,R_VARIABLES(53)) ! EBIT/SHARE

!
! HOOSIER SECTION
!         
! Total Non-member Revenues
         R_VARIABLES(488) = R_VARIABLES(330) & ! WVPA
                            + R_VARIABLES(331) &  ! Troy
                            + R_VARIABLES(332) & ! PECO
                            + R_VARIABLES(382)   ! East Kentucky
! Total O&M Expenses
         R_VARIABLES(489) = R_VARIABLES(5) &   ! Fossil Fuel Expense
                            + R_VARIABLES(8) &  ! Fixed O&M Production Expense
                            + R_VARIABLES(363) & ! Variable O&M Production Expense
                            + R_VARIABLES(15) & ! Emissions Credit Expense
                            + R_VARIABLES(6) &  ! Purchased Power Expense
                            + R_VARIABLES(337) & ! Transmission & Distribution Operation
                            + R_VARIABLES(338) & ! Transmission & Distribution Maintenance
                            + R_VARIABLES(335) & ! Transmission & Distribution - Wheeling
                            + R_VARIABLES(324)   ! Administrative & General
! Total Other Expenses
         R_VARIABLES(490) = R_VARIABLES(17) &   ! Depreciation Expense,17
                            + R_VARIABLES(291) & ! Amortization Expense,291,
                            + R_VARIABLES(440) & ! Fees,440
                            + R_VARIABLES(21) & ! Operating Revenue Tax,21
                            + R_VARIABLES(22) & ! Other Taxes,22
                            + R_VARIABLES(217) & ! Property Taxes,217
                            + R_VARIABLES(29) & ! Income Tax Deferrals (Cr),29
                            + R_VARIABLES(293) & ! Interest on Long Term Debt,293
                            + R_VARIABLES(40) & ! Interest on Short Term Debt,40
                            + R_VARIABLES(12)  ! Property & Liability Insurance,12
! Total Expenses
         R_VARIABLES(491) = R_VARIABLES(489) & ! Total O&M Expenses
                            + R_VARIABLES(490) ! Total Other Expenses
! Operating Margin
         R_VARIABLES(492) = R_VARIABLES(4) &  ! Total Revenues 
                            - R_VARIABLES(491) ! Total Expenses
! Net Margin
         R_VARIABLES(493) = R_VARIABLES(492) & ! Operating Margin
                            + R_VARIABLES(34) ! Non-operating Margin
! TIER
         TIER_INTEREST = R_VARIABLES(293) & ! Interest on Long Term Debt,293
                         + R_VARIABLES(40)  ! Interest on Short Term Debt,40
         IF(TIER_INTEREST /= 0.) THEN 
            R_VARIABLES(494) = (R_VARIABLES(493) + TIER_INTEREST)/TIER_INTEREST
         ELSE
            R_VARIABLES(494) = NOT_AVAIL
         ENDIF
!
! FREE CASH FLOW
!
         R_VARIABLES(779) = R_VARIABLES(479)  & ! EBITDA
                            + R_VARIABLES(118) & ! +Change in Working Capital
                            - R_VARIABLES(115) & ! - Capital Expenditures
                            - R_VARIABLES(425) & ! - Pension Payments
                            - R_VARIABLES(482) & ! - Interest Expense
                            - R_VARIABLES(119) & ! - Debt Retirements
                            - R_VARIABLES(404) & ! - Change in Notes
                            - R_VARIABLES(154) & ! - Preferred Retirements
                            - R_VARIABLES(120) & ! - Common Stock Buyback
                            - R_VARIABLES(211) & ! - Federal Taxes
                            - R_VARIABLES(212) ! - State Taxes
         CALL RATING_AGENCY_RATIOS(R_VARIABLES)
         CALL NEW_COVERAGE_RATIO_RPT(R_VARIABLES)
      RETURN
      END
!***********************************************************************
      SUBROUTINE RATING_AGENCY_RATIOS(R_VARIABLES)
!***********************************************************************
      REAL (KIND=4) :: R_VARIABLES(0:*),THE_RATIO_OF_A_TO_B
      REAL (KIND=4), PARAMETER :: NOT_AVAIL=-999999.
      REAL (KIND=4) :: TotalDebt
!
! FUNDS FROM OPERATIONS
!
         R_VARIABLES(780) =  R_VARIABLES(47) & ! Earnings for Common
                            + R_VARIABLES(17) & ! -Depreciation
                            + R_VARIABLES(351) & ! -Amortization
                            + R_VARIABLES(437) & ! -Nuclear Fuel Amortization
                            + R_VARIABLES(28) & ! -Deferred Tax Dr
                            + R_VARIABLES(295) & ! -Deferred Tax Cr
                            + R_VARIABLES(50) ! -Investment Tax CreditsC
!
! FFO/Total Debt
!
         TotalDebt = R_VARIABLES(81) & ! Total Debt	81
                     - R_VARIABLES(119)! - Debt Retirements	119
         R_VARIABLES(781) = 100.*THE_RATIO_OF_A_TO_B(R_VARIABLES(780),TotalDebt) ! FFO/Total Debt
!
! Pre-Tax Interest Coverage  Var 782
!
         R_VARIABLES(782) = R_VARIABLES(47) &  ! Earnings for Common
                            + R_VARIABLES(482) & !  -Interest Expense
                            + R_VARIABLES(778) & !  - Lease Payment in Tier Calculation as input in Financial Parameters file
                            + R_VARIABLES(361) & !  -Preferred Dividends
                            + R_VARIABLES(572)   ! + Total Taxes
!
! Pre-Tax Interest Coverage
!
         R_VARIABLES(783) = R_VARIABLES(482) & !  Interest Expense
                            + R_VARIABLES(361) & !  +Preferred Dividends
                            + R_VARIABLES(778)   !  +Lease Payment in Tier Calculation
         R_VARIABLES(784) = THE_RATIO_OF_A_TO_B(R_VARIABLES(782), & ! Pre-Tax Interest Coverage
                                                R_VARIABLES(783))
!
! FFO Interest Coverage
!
         R_VARIABLES(785) = THE_RATIO_OF_A_TO_B(R_VARIABLES(780), & ! FFO Interest Coverage
                                                R_VARIABLES(783))
      RETURN
      END
!***********************************************************************
      SUBROUTINE FIRST_ENERGY_PandL_REPORT(CLASS,R_VARIABLES,CL_ANN_CLASS_ENERGY,EXP_FUEL_EXPENSE,EXP_PURCHASE_POWER_EXPENSE, &
                                           EXP_FILE_VARIABLE_EXPENSE,EXP_FILE_FIXED_EXPENSE)
!***********************************************************************

      use SpinDriftLib
      use prod_arrays_dimensions
      use class_run_switchesc
      use class_run_switchesl1
      use class_run_switchesl4


      REAL :: R_VARIABLES(0:*),CL_ANN_CLASS_ENERGY(*)
      INTEGER (KIND=2) :: I,CLASS_NUM
      REAL :: TOTAL_PRODUCTION_COSTS,TOTAL_POWER_SALES
      REAL :: TOTAL_POWER_REVENUES
      REAL :: TOTAL_ENERGY_GENERATION_COSTS,TOTAL_PRODUCTION_COSTS_NON_FUEL
      REAL :: GROSS_MARGIN_DOLLARS,GROSS_MARGIN_PERCENT
      REAL :: TOTAL_FOSSIL_COST,TOTAL_GENERATION,TOTAL_SALES,EXP_FUEL_EXPENSE,EXP_PURCHASE_POWER_EXPENSE, &
              EXP_FILE_VARIABLE_EXPENSE,EXP_FILE_FIXED_EXPENSE,SUM_NON_OPERATING_EXPENSES
!
      LOGICAL (KIND=1) :: RETURN_FE_PNL_EXPENSES,VOID_LOGICAL
      INTEGER (KIND=2) :: FT,CLASS
      REAL :: FUEL_COST(6),PURCHASE_POWER_EXPENSE(11),VARIABLE_EXPENSE(6),FIXED_EXPENSE(6),TOTAL_SALES_REVENUE(6), &
              CL_ANN_TOTAL_CLASS_ENERGY(11),CL_ANN_TOTAL_CAPACITY(11),THE_RATIO_OF_A_TO_B,THE_PERCENT_OF_A_TO_B
      INTEGER (KIND=2) :: Coal,Gas,Oil,Nuclear,Water,Other,EastLake,BayShore,MarketPurchases,MarketSales
      PARAMETER (Coal=1,Gas=2,Oil=3,Nuclear=4,Water=5,Other=6,MarketSales=10,MarketPurchases=11)
      PARAMETER (BayShore=3)
! NOTE: 1 == PRODUCTION FROM RESOURCE TO MEET NATIVE LOAD
!       2 == DEFINED PURCHASE TO MEET NATIVE LOAD
!       3 == ECONOMY PURCHASE TO MEET NATIVE LOAD
!       4 == ECONOMY SALES WHICH INCREASE LOAD
      REAL :: R_EL_MARKET_REVENUES,R_EL_MARKET_PURCHASES
      REAL :: UTILITY_SALES,UTILITY_SALES_QUANT,UTILITY_SALES_LOSSES,COMPETITIVE_SALES,COMPETITIVE_SALES_QUANT, &
              COMPETITIVE_SALES_LOSSES,COMPETITIVE_SALES_CATEGY(1:9),COMPETITIVE_SALES_QUANT_CATEGY(1:9), &
              COMPETITIVE_SALES_LOSSES_CATEGY(1:9),BAY_SHORE_FUEL_EXPENSE,ENRGY_BOUGHT,ENRGY_BOUGHT_COST
      INTEGER (KIND=2) :: RETURN_FE_PNL_REVENUES,VOID_INT2
      INTEGER (KIND=2) :: Annual_Amount_LOC
      PARAMETER (Annual_Amount_LOC = 0) 
!
! EXPENSE
!
         COMPETITIVE_SALES_CATEGY = 0.
         COMPETITIVE_SALES_QUANT_CATEGY = 0.
         COMPETITIVE_SALES_LOSSES_CATEGY = 0.
         FUEL_COST = 0.
         VARIABLE_EXPENSE = 0.  
         FIXED_EXPENSE = 0.
         TOTAL_SALES_REVENUE = 0.
         PURCHASE_POWER_EXPENSE = 0.
         CL_ANN_TOTAL_CLASS_ENERGY = 0.
         CL_ANN_TOTAL_CAPACITY = 0.
         BAY_SHORE_FUEL_EXPENSE = 0.
         ENRGY_BOUGHT = 0.
         ENRGY_BOUGHT_COST = 0.
         UTILITY_SALES = 0.
         UTILITY_SALES_QUANT = 0.
         UTILITY_SALES_LOSSES = 0.
         IF(CLASS >= 0) THEN
            VOID_LOGICAL = RETURN_FE_PNL_EXPENSES(CLASS,FUEL_COST,PURCHASE_POWER_EXPENSE,VARIABLE_EXPENSE,FIXED_EXPENSE, &
                                             TOTAL_SALES_REVENUE,CL_ANN_TOTAL_CLASS_ENERGY,CL_ANN_TOTAL_CAPACITY, &
                                             BAY_SHORE_FUEL_EXPENSE)
            CALL FE_ENRG_LIMITED_INFO(CLASS,PURCHASE_POWER_EXPENSE(Water),VARIABLE_EXPENSE(Water),FIXED_EXPENSE(Water), &
                                TOTAL_SALES_REVENUE(Water),R_EL_MARKET_REVENUES,R_EL_MARKET_PURCHASES, &
                                CL_ANN_TOTAL_CLASS_ENERGY(Water))
            IF(USE_BUDGET_VARIABLE_OM) THEN
               VARIABLE_EXPENSE = 0.
               FIXED_EXPENSE = 0.
               IF(USE_BUDGET_FUEL_PURCHASE) THEN
                  FUEL_COST = 0.
                  PURCHASE_POWER_EXPENSE = 0.
               ENDIF
            ENDIF
            VOID_INT2 = RETURN_FE_PNL_REVENUES(CLASS,UTILITY_SALES,UTILITY_SALES_QUANT,UTILITY_SALES_LOSSES, &
                                       COMPETITIVE_SALES_CATEGY,COMPETITIVE_SALES_QUANT_CATEGY,COMPETITIVE_SALES_LOSSES_CATEGY)
            CALL RETURN_FE_COMPETITIVE_SALE_INFO(CLASS,COMPETITIVE_SALES_CATEGY,COMPETITIVE_SALES_QUANT_CATEGY, &
                                       COMPETITIVE_SALES_LOSSES_CATEGY)
            CLASS_NUM = CLASS-INT(1,2)
            CALL GET_ANN_COST_ABOVE_RESOURCES(ENRGY_BOUGHT,ENRGY_BOUGHT_COST,Annual_Amount_LOC,CLASS_NUM)
!
            R_VARIABLES(526) = UTILITY_SALES + R_VARIABLES(526) 
            R_VARIABLES(538) = UTILITY_SALES_QUANT + R_VARIABLES(538) 
            R_VARIABLES(593) = UTILITY_SALES_LOSSES + R_VARIABLES(593) 
!
            COMPETITIVE_SALES = 0.
            COMPETITIVE_SALES_QUANT = 0.
            COMPETITIVE_SALES_LOSSES = 0.
            DO I = 1, 9
               COMPETITIVE_SALES = COMPETITIVE_SALES + COMPETITIVE_SALES_CATEGY(I)
               R_VARIABLES(595+I) = R_VARIABLES(595+I) + COMPETITIVE_SALES_CATEGY(I)
               COMPETITIVE_SALES_QUANT = COMPETITIVE_SALES_QUANT + COMPETITIVE_SALES_QUANT_CATEGY(I)
               R_VARIABLES(582+I) = R_VARIABLES(582+I) + COMPETITIVE_SALES_QUANT_CATEGY(I)
               COMPETITIVE_SALES_LOSSES = COMPETITIVE_SALES_LOSSES + COMPETITIVE_SALES_LOSSES_CATEGY(I)
            ENDDO

            R_VARIABLES(539) = COMPETITIVE_SALES_QUANT+R_VARIABLES(539) 
            R_VARIABLES(594) = COMPETITIVE_SALES_LOSSES+R_VARIABLES(594) 
            R_VARIABLES(540) = R_VARIABLES(540) + CL_ANN_TOTAL_CLASS_ENERGY(MarketSales)
! PURCHASE POWER QUANTIITIES
            R_VARIABLES(621) = R_VARIABLES(621) & ! mmMWh PURCHASES ABOVE RESOURCES
                               + ENRGY_BOUGHT
            R_VARIABLES(614) = R_VARIABLES(614) & ! mmMWh FIXED PURCHASES 
                               + CL_ANN_CLASS_ENERGY(2)

            R_VARIABLES(615) = R_VARIABLES(615) & ! mmMWh OPPORTUNITY PURCHASES 
                               + CL_ANN_TOTAL_CLASS_ENERGY(MarketPurchases)
!            IF(VOID_LOGICAL) THEN
! FUEL CALCULATIONS
!  Coal
               R_VARIABLES(511) = R_VARIABLES(511) + FUEL_COST(Coal) - BAY_SHORE_FUEL_EXPENSE
!  Gas
               R_VARIABLES(512) = R_VARIABLES(512) + FUEL_COST(Gas)
!  BayShore
               R_VARIABLES(513) = R_VARIABLES(513) + BAY_SHORE_FUEL_EXPENSE
!  Water

!  Other
               R_VARIABLES(515) = R_VARIABLES(515) + FUEL_COST(Other) + FUEL_COST(Oil)
! PURCHASE INFORMATION
! VAR and FIXED O&M CALCULATIONS
!  Coal
               R_VARIABLES(517) = R_VARIABLES(517) + VARIABLE_EXPENSE(Coal) + VARIABLE_EXPENSE(BayShore) + VARIABLE_EXPENSE(Other)
               R_VARIABLES(520) = R_VARIABLES(520) + FIXED_EXPENSE(Coal) + FIXED_EXPENSE(BayShore) + FIXED_EXPENSE(Other)
!  Gas
               R_VARIABLES(518) = R_VARIABLES(518) + VARIABLE_EXPENSE(Gas) + VARIABLE_EXPENSE(Water)
               R_VARIABLES(521) = R_VARIABLES(521) + FIXED_EXPENSE(Gas) + FIXED_EXPENSE(Water)
! Fossil Non-fuel expense
               R_VARIABLES(652) = R_VARIABLES(652) & ! FE_FOSSIL_NON_FUEL_EXP, ! 652
                                  + EXP_FILE_VARIABLE_EXPENSE
               R_VARIABLES(645) = R_VARIABLES(517) &  ! Coal Var
                                  + R_VARIABLES(520) & ! Coal Fixed
                                  + R_VARIABLES(518) & ! Gas Var
                                  + R_VARIABLES(521) & ! Gas Fixes
                                  + R_VARIABLES(652) ! FE_FOSSIL_NON_FUEL_EXP, ! 652
!  Nuclear
               R_VARIABLES(519) = R_VARIABLES(519) + VARIABLE_EXPENSE(Nuclear)
               R_VARIABLES(522) = R_VARIABLES(522) + FIXED_EXPENSE(Nuclear)
! Nuclear Non-fuel expenses
               R_VARIABLES(651) = R_VARIABLES(651) & ! FE_NUC_NON_FUEL_EXP, ! 651
                                  + EXP_FILE_FIXED_EXPENSE
               R_VARIABLES(644) = R_VARIABLES(519) &  ! Nuclear Var
                                  + R_VARIABLES(522) & ! Nuclear Fixed
                                  + R_VARIABLES(232) & ! DOE Disposal
                                  + R_VARIABLES(651) ! FE_NUC_NON_FUEL_EXP, ! 651

! PURCHASE POWER EXPENSE
               R_VARIABLES(616) = R_VARIABLES(616) & ! FIXED PURCHASED POWER EXPENSE
                                 + PURCHASE_POWER_EXPENSE(Coal) + PURCHASE_POWER_EXPENSE(Gas) + PURCHASE_POWER_EXPENSE(BayShore) &
                                 + PURCHASE_POWER_EXPENSE(Nuclear) + PURCHASE_POWER_EXPENSE(Water) + PURCHASE_POWER_EXPENSE(Other)
               R_VARIABLES(617) = R_VARIABLES(617) & ! OPPORTUNITY PURCHASED POWER EXPENSE
                                 + PURCHASE_POWER_EXPENSE(MarketPurchases)
               R_VARIABLES(622) = R_VARIABLES(622) & ! OUT OF RESOURCES PURCHASED POWER EXPENSE
                                 + ENRGY_BOUGHT_COST
! ENERGY INFORMATION
!  Coal
               R_VARIABLES(532) = R_VARIABLES(532) + CL_ANN_TOTAL_CLASS_ENERGY(Coal)
!  Gas
               R_VARIABLES(533) = R_VARIABLES(533) + CL_ANN_TOTAL_CLASS_ENERGY(Gas)
!  All Other 
               R_VARIABLES(534) = R_VARIABLES(534) + CL_ANN_TOTAL_CLASS_ENERGY(Oil) + CL_ANN_TOTAL_CLASS_ENERGY(Water) &
                                  + CL_ANN_TOTAL_CLASS_ENERGY(Other)
!  Nuclear
               R_VARIABLES(531) = R_VARIABLES(531) + CL_ANN_TOTAL_CLASS_ENERGY(Nuclear)
!            ENDIF
         ENDIF ! if class
!
!
! TOTALS FOR PURCHASE POWER
!
         R_VARIABLES(537) = R_VARIABLES(614) & ! mmMWh
                            + R_VARIABLES(615) + R_VARIABLES(621) &
                            + (R_VARIABLES(647) &     ! GWH 02/04/04.
                            + R_VARIABLES(649))*.001 ! GWH 02/04/04.
! KA suggestion MSG 1/6/04
         R_VARIABLES(516) = R_VARIABLES(470) & ! $ MILLIONS
                            + R_VARIABLES(450) ! Derivative purchases

         R_VARIABLES(650) = R_VARIABLES(516) & ! $ MILLIONS
                            + R_VARIABLES(460) & ! Amortization
                            + R_VARIABLES(654) & ! Other Purchases
                            + R_VARIABLES(666) ! Affiliate Purchases
!
         TOTAL_PRODUCTION_COSTS = R_VARIABLES(438) ! ROLLED-UP NUCLEAR FUEL COSTS
         DO I = 511, 522 ! 523-525 AVAILABLE
            TOTAL_PRODUCTION_COSTS = TOTAL_PRODUCTION_COSTS + R_VARIABLES(I)
         ENDDO
         TOTAL_FOSSIL_COST = R_VARIABLES(15) ! Emission Credits            
         R_VARIABLES(515) = R_VARIABLES(515) + EXP_FUEL_EXPENSE
         DO I = 511, 515
            TOTAL_FOSSIL_COST = TOTAL_FOSSIL_COST + R_VARIABLES(I)
         ENDDO
         TOTAL_PRODUCTION_COSTS_NON_FUEL = R_VARIABLES(232) ! DOE Disposal
         DO I = 517, 522 
            TOTAL_PRODUCTION_COSTS_NON_FUEL = TOTAL_PRODUCTION_COSTS_NON_FUEL + R_VARIABLES(I)
         ENDDO

         TOTAL_PRODUCTION_COSTS = R_VARIABLES(438) &  ! NUCLEAR FUEL COSTS
                                  + R_VARIABLES(557) & ! Fossil Fuel
                                  + R_VARIABLES(644) & ! Nuc Non-Fuel
                                  + R_VARIABLES(645) & ! Fossil Non-Fuel
                                  + R_VARIABLES(650) ! Purchases
         TOTAL_ENERGY_GENERATION_COSTS = R_VARIABLES(438) & ! ROLLED-UP NUCLEAR FUEL COSTS
                                         + TOTAL_FOSSIL_COST + TOTAL_PRODUCTION_COSTS_NON_FUEL
!
! REVENUES
!
         R_VARIABLES(528) = R_VARIABLES(2) 
         TOTAL_POWER_REVENUES = R_VARIABLES(449) ! Derivative Sales revenue
         DO I = 526, 528 ! 529 AND 530 FOR NEW REVENUE SOURCES
            TOTAL_POWER_REVENUES = TOTAL_POWER_REVENUES + R_VARIABLES(I)
         ENDDO
         GROSS_MARGIN_DOLLARS = TOTAL_POWER_REVENUES - TOTAL_PRODUCTION_COSTS
         GROSS_MARGIN_PERCENT = THE_PERCENT_OF_A_TO_B(GROSS_MARGIN_DOLLARS,TOTAL_POWER_REVENUES)
         
!
! GENERATION AND SALES
!
         R_VARIABLES(536) = 0.
         DO I = 531, 534 ! 535 ARE AVAIALBE FOR NEW GERNERATIN SOURCES 
            R_VARIABLES(536) = R_VARIABLES(536) + R_VARIABLES(I)
         ENDDO
         TOTAL_GENERATION = R_VARIABLES(536) + R_VARIABLES(537)  ! PURCHASES
         TOTAL_SALES = 0.
         DO I = 538, 540 ! 541 AND 542 ARE AVAIALBE FOR NEW SALES SOURCES 
            TOTAL_SALES = TOTAL_SALES + R_VARIABLES(I)
         ENDDO
!
! CALCULATE RATIOS FOR SALES
!
         DO I = 0, 4  ! VARIABLE 543 TO 547 
            R_VARIABLES(543+I) = THE_RATIO_OF_A_TO_B(R_VARIABLES(526+I),R_VARIABLES(538+I))
         ENDDO
! AVERAGE REVENUE PER SALE         
         R_VARIABLES(548) = THE_RATIO_OF_A_TO_B(TOTAL_POWER_REVENUES,TOTAL_SALES)
! PURCHASE POWER COST-AVERAGEs
         R_VARIABLES(549) = THE_RATIO_OF_A_TO_B(R_VARIABLES(516),R_VARIABLES(537))
         R_VARIABLES(619) = THE_RATIO_OF_A_TO_B(R_VARIABLES(616),R_VARIABLES(614))
         R_VARIABLES(620) = THE_RATIO_OF_A_TO_B(R_VARIABLES(617),R_VARIABLES(615))
         R_VARIABLES(623) = THE_RATIO_OF_A_TO_B(R_VARIABLES(622),R_VARIABLES(621))
         DO I = 1, 9
            R_VARIABLES(604+I) = THE_RATIO_OF_A_TO_B(R_VARIABLES(595+I),R_VARIABLES(582+I))
            
         ENDDO
! AVERAGE TOTAL PRODUCTION COST
         R_VARIABLES(618) = THE_RATIO_OF_A_TO_B(R_VARIABLES(558),R_VARIABLES(554))
! TOTAL MWH SALES, LOSSES AND TOTAL OF BOTH
         R_VARIABLES(592) = R_VARIABLES(538) + R_VARIABLES(539) + R_VARIABLES(540) + (R_VARIABLES(646) + R_VARIABLES(648))*.001 
! 02/04/04.
         R_VARIABLES(595) = R_VARIABLES(592) + R_VARIABLES(593) + R_VARIABLES(594)
!
! ASSIGN CALCUALTED VALUES
!
         R_VARIABLES(560) = GROSS_MARGIN_PERCENT
         R_VARIABLES(559) = GROSS_MARGIN_DOLLARS
         R_VARIABLES(558) = TOTAL_PRODUCTION_COSTS - R_VARIABLES(460)
         R_VARIABLES(653) = TOTAL_PRODUCTION_COSTS
         R_VARIABLES(557) = TOTAL_FOSSIL_COST
         R_VARIABLES(556) = TOTAL_POWER_REVENUES
         R_VARIABLES(555) = TOTAL_SALES
         R_VARIABLES(554) = TOTAL_GENERATION
         R_VARIABLES(624) = TOTAL_ENERGY_GENERATION_COSTS
         R_VARIABLES(625) = THE_RATIO_OF_A_TO_B(TOTAL_ENERGY_GENERATION_COSTS,R_VARIABLES(536))
         R_VARIABLES(659) = R_VARIABLES(644) & ! FE_NUC_NON_FUEL_EXP_WO_DEPOSAL
                            - R_VARIABLES(232)
      RETURN   
      END
!***********************************************************************
      SUBROUTINE SETUP_TRANSACT_TRANSFERS(R_YEAR, &
                                          TOTAL_AMEREN_MARKET_REVENUES, & ! USED BY AMEREN 12/03/01 MSG
                                          TOTAL_AMEREN_FUEL_EXPENSE,TOTAL_AMEREN_VARIABLE_EXPENSE)
!***********************************************************************
!
      use SpinDriftLib
      use prod_arrays_dimensions
      use globecom
      USE SIZECOM

      LOGICAL (KIND=1) :: TRANSFERS_ARE_ACTIVE,R_REV_TRANSFERS_ARE_ACTIVE,R_EXP_TRANSFERS_ARE_ACTIVE,ASSET_ANALYST_ONLY
      INTEGER (KIND=2) :: TRANSFR_COST_CLASS_VECTOR,TRANSFR_COST_ALLOC_VECTOR,TRANSFR_REV_CLASS_VECTOR,TRANSFR_REV_ALLOC_VECTOR
      REAL (KIND=4) :: TOTAL_AMEREN_MARKET_REVENUES, & ! USED BY AMEREN 12/03/01 MSG
                       TOTAL_AMEREN_FUEL_EXPENSE,TOTAL_AMEREN_VARIABLE_EXPENSE
      REAL (KIND=4) :: TRANSFR_MARKET_COSTS(0:12),TRANSFR_MARKET_COSTS_MWH(0:12),TRANSFR_MARKET_REVS(0:12), &
             TRANSFR_MARKET_REVS_MWH(0:12),TRANSFR_MONTHLY_WHOLESALE_COST(0:12), &
             TRANSFR_MONTHLY_WHOLE_FUEL_COST(0:12), & ! R(0:12) SE THIS FOR AMEREN
             TRANSFR_MONTHLY_WHOLE_VOM_COST(0:12) ! R(0:12) USE THIS FOR AMEREN
      SAVE TRANSFERS_ARE_ACTIVE
!
      REAL (KIND=4) :: ASSET_CLASS_LIST(30)
      REAL (KIND=4) :: ASSET_ALLOCATION_LIST(30)
!
      INTEGER (KIND=2) :: YR,MO,ASSET_CLASS,RESULT_PTR
      INTEGER (KIND=2) :: R_YEAR
      REAL (KIND=4) :: ASSET_ALLOCATOR,ALLOCATED_DOLLAR_AMOUNT(0:12),ALLOCATED_QUANT_AMOUNT(0:12), &
                       ALLOCATED_FUEL_DOLLAR_AMOUNT(0:12),ALLOCATED_VOM_DOLLAR_AMOUNT(0:12)
      INTEGER (KIND=2) :: NUMBER_OF_COST_CLASSES,MAX_COST_CLASS_NUMBER
      SAVE MAX_COST_CLASS_NUMBER
      REAL TRANSFR_COST_QUANTITIES,TRANSFR_FUEL_COST_AMOUNT,TRANSFR_VAR_COST_AMOUNT
      INTEGER (KIND=2) :: TRANSFR_COST_CLASS_POINTR
      ALLOCATABLE :: TRANSFR_COST_QUANTITIES(:,:),TRANSFR_COST_CLASS_POINTR(:),TRANSFR_FUEL_COST_AMOUNT(:,:), &
                     TRANSFR_VAR_COST_AMOUNT(:,:)
      SAVE TRANSFR_COST_QUANTITIES,TRANSFR_COST_CLASS_POINTR,TRANSFR_FUEL_COST_AMOUNT,TRANSFR_VAR_COST_AMOUNT
      INTEGER (KIND=2) :: NUMBER_OF_REV_CLASSES,MAX_REV_CLASS_NUMBER
      SAVE MAX_REV_CLASS_NUMBER
      INTEGER (KIND=2) :: TRANSFR_REV_CLASS_POINTR
      REAL :: TRANSFR_REV_AMOUNT,TRANSFR_REV_QUANTITIES
      ALLOCATABLE :: TRANSFR_REV_AMOUNT(:,:),TRANSFR_REV_QUANTITIES(:,:),TRANSFR_REV_CLASS_POINTR(:)
      SAVE TRANSFR_REV_AMOUNT,TRANSFR_REV_QUANTITIES,TRANSFR_REV_CLASS_POINTR
!
      INTEGER (KIND=2) :: ALLOCATION_VECTOR,CLASS_POINTER
      REAL (KIND=4) :: ALLOCATION_VALUE(0:12),ANNUAL_VECTOR_VALUES(0:AVAIL_DATA_YEARS), &
                       VECTOR_MONTHLY_DATA(12,LAST_AVAILABLE_MONTHLY_YEAR)
      CHARACTER (len=1) :: MONTHLY_DATA_UNITS(LAST_AVAILABLE_MONTHLY_YEAR)
      INTEGER (KIND=2) :: MONTH_ENDING(LAST_AVAILABLE_MONTHLY_YEAR)
      CHARACTER (LEN=1) :: DATA_TYPE,VECTOR_TYPE*20,DUMMY_TYPE
      LOGICAL (KIND=1) :: VOID_LOGICAL,RETURN_ASSET_CLASS_LISTS
!
      REAL :: R_CLASS_REVENUES,R_CLASS_REV_QUANITIES,R_CLASS_FUEL_EXPENSES,R_CLASS_VOM_EXPENSES,R_CLASS_EXP_QUANITIES
      INTEGER (KIND=2) :: R_ASSET_CLASS
!
         IF(ASSET_ANALYST_ONLY()) RETURN
         CALL TRANSACT_WHOLESALE_REV_COST(TRANSFERS_ARE_ACTIVE, &
                                        TRANSFR_REV_CLASS_VECTOR, &
                                        TRANSFR_REV_ALLOC_VECTOR, &
                                        TRANSFR_COST_CLASS_VECTOR, &
                                        TRANSFR_COST_ALLOC_VECTOR, &
                                        TRANSFR_MARKET_COSTS, &
                                        TRANSFR_MARKET_COSTS_MWH, &
                                        TRANSFR_MONTHLY_WHOLESALE_COST, &
                                        TRANSFR_MARKET_REVS, &
                                        TRANSFR_MARKET_REVS_MWH, &
                                        TRANSFR_MONTHLY_WHOLE_FUEL_COST, & ! R(0:12) USE THIS FOR AMEREN
                                        TRANSFR_MONTHLY_WHOLE_VOM_COST) ! R(0:12) USE THIS FOR AMEREN
         IF(.NOT. TRANSFERS_ARE_ACTIVE) RETURN
         YR = R_YEAR
!
! GET CLASS USING A VECTOR
! GET ALLOCATION FACTORS
! SETUP ARRAYS TO LATER SEARCH FOR THE AMONTS TO TRANSFER
!         
!
! ALLOCATE TO THE COST VALUES TOTAL COMPANY AND ASSET CLASSES
!
         VOID_LOGICAL = RETURN_ASSET_CLASS_LISTS(TRANSFR_COST_CLASS_VECTOR,ASSET_CLASS_LIST,TRANSFR_COST_ALLOC_VECTOR, &
                                                 ASSET_ALLOCATION_LIST)
         MAX_COST_CLASS_NUMBER = 0
         CLASS_POINTER = 1
         DO 
            MAX_COST_CLASS_NUMBER = MAX(MAX_COST_CLASS_NUMBER,int(ASSET_CLASS_LIST(CLASS_POINTER),2)+INT(1,2))
            
            CLASS_POINTER = CLASS_POINTER + 1
            IF(CLASS_POINTER > AVAIL_DATA_YEARS) EXIT
            IF(ASSET_CLASS_LIST(CLASS_POINTER) == 0. .OR. ASSET_CLASS_LIST(CLASS_POINTER) == -99.) EXIT
         ENDDO
         NUMBER_OF_COST_CLASSES = CLASS_POINTER - 1
         IF(ALLOCATED(TRANSFR_FUEL_COST_AMOUNT)) DEALLOCATE(TRANSFR_FUEL_COST_AMOUNT,TRANSFR_VAR_COST_AMOUNT, &
                          TRANSFR_COST_QUANTITIES,TRANSFR_COST_CLASS_POINTR)
         ALLOCATE(TRANSFR_FUEL_COST_AMOUNT(0:12,NUMBER_OF_COST_CLASSES))
         ALLOCATE(TRANSFR_VAR_COST_AMOUNT(0:12,NUMBER_OF_COST_CLASSES))
         ALLOCATE(TRANSFR_COST_QUANTITIES(0:12,NUMBER_OF_COST_CLASSES))
         ALLOCATE(TRANSFR_COST_CLASS_POINTR(0:MAX_COST_CLASS_NUMBER+1))
         TRANSFR_FUEL_COST_AMOUNT = 0.
         TRANSFR_VAR_COST_AMOUNT = 0.
         TRANSFR_COST_QUANTITIES = 0.
         TRANSFR_COST_CLASS_POINTR = 0.
         CLASS_POINTER = 1
         DO
            ASSET_CLASS = ASSET_CLASS_LIST(CLASS_POINTER)
            ASSET_CLASS = ASSET_CLASS + 1
!
            IF(ASSET_ALLOCATION_LIST(CLASS_POINTER) < 0.) THEN
               ALLOCATION_VECTOR = ABS(ASSET_ALLOCATION_LIST(CLASS_POINTER))
               IF(MONTHLY_MIDAS_ACTIVE) THEN
                  CALL GET_MONTHLY_ANNUAL_VALUES(ALLOCATION_VECTOR,DATA_TYPE,VECTOR_TYPE,ANNUAL_VECTOR_VALUES(1), &
                                               VECTOR_MONTHLY_DATA(1,1),MONTHLY_DATA_UNITS,MONTH_ENDING)
                  CALL RIPPLE_MONTHLY_DATA(ANNUAL_VECTOR_VALUES(1),VECTOR_MONTHLY_DATA)
!
                  ASSET_ALLOCATOR = ANNUAL_VECTOR_VALUES(YR)/100.
                  DO MO = 0, 12
                     IF(MO == 0) THEN
                        ALLOCATION_VALUE(MO) = ANNUAL_VECTOR_VALUES(YR)/100.
                     ELSEIF(YR > LAST_AVAILABLE_MONTHLY_YEAR) THEN
                        ALLOCATION_VALUE(MO) = ANNUAL_VECTOR_VALUES(YR)/100.
                     ELSE
                        ALLOCATION_VALUE(MO) = VECTOR_MONTHLY_DATA(MO,YR)/100.
                     ENDIF
                  ENDDO
               ELSE
                  CALL GET_ASSET_VAR(ALLOCATION_VECTOR,DUMMY_TYPE,ANNUAL_VECTOR_VALUES(1))
!                     
                  ASSET_ALLOCATOR = ANNUAL_VECTOR_VALUES(YR)/100.
                  DO MO = 0, 12
                     ALLOCATION_VALUE(MO) = ASSET_ALLOCATOR 
                  ENDDO
               ENDIF
            ELSE
!                     
               ASSET_ALLOCATOR=ASSET_ALLOCATION_LIST(CLASS_POINTER)/100.
               DO MO = 0, 12
                  ALLOCATION_VALUE(MO) = ASSET_ALLOCATOR
               ENDDO
            ENDIF
            ALLOCATED_FUEL_DOLLAR_AMOUNT(0) = 0.
            ALLOCATED_VOM_DOLLAR_AMOUNT(0) = 0.
            ALLOCATED_QUANT_AMOUNT(0) = 0.
            DO MO = 1, 12
               ALLOCATED_FUEL_DOLLAR_AMOUNT(MO) = ALLOCATION_VALUE(MO) * TRANSFR_MONTHLY_WHOLE_FUEL_COST(MO)
               ALLOCATED_FUEL_DOLLAR_AMOUNT(0) = ALLOCATED_FUEL_DOLLAR_AMOUNT(0) + ALLOCATED_FUEL_DOLLAR_AMOUNT(MO)
               ALLOCATED_VOM_DOLLAR_AMOUNT(MO) = ALLOCATION_VALUE(MO) * TRANSFR_MONTHLY_WHOLE_VOM_COST(MO)
               ALLOCATED_VOM_DOLLAR_AMOUNT(0) = ALLOCATED_VOM_DOLLAR_AMOUNT(0) + ALLOCATED_VOM_DOLLAR_AMOUNT(MO)
               ALLOCATED_QUANT_AMOUNT(MO) = ALLOCATION_VALUE(MO) * TRANSFR_MARKET_COSTS_MWH(MO)
               ALLOCATED_QUANT_AMOUNT(0) = ALLOCATED_QUANT_AMOUNT(0) + ALLOCATED_QUANT_AMOUNT(MO)
            ENDDO
            IF(TRANSFR_COST_CLASS_POINTR(ASSET_CLASS) == 0) THEN
               TRANSFR_COST_CLASS_POINTR(ASSET_CLASS) = CLASS_POINTER
               RESULT_PTR = CLASS_POINTER
            ELSE
               RESULT_PTR = TRANSFR_COST_CLASS_POINTR(ASSET_CLASS)
            ENDIF
            DO MO = 0, 12
               TRANSFR_FUEL_COST_AMOUNT(MO,RESULT_PTR) = ALLOCATED_FUEL_DOLLAR_AMOUNT(MO)
               TRANSFR_VAR_COST_AMOUNT(MO,RESULT_PTR) = ALLOCATED_VOM_DOLLAR_AMOUNT(MO)
               TRANSFR_COST_QUANTITIES(MO,RESULT_PTR) = ALLOCATED_QUANT_AMOUNT(MO)
            ENDDO
            TRANSFR_FUEL_COST_AMOUNT(0,RESULT_PTR) = ALLOCATION_VALUE(0) * TOTAL_AMEREN_FUEL_EXPENSE
            TRANSFR_VAR_COST_AMOUNT(0,RESULT_PTR) = ALLOCATION_VALUE(0) * TOTAL_AMEREN_VARIABLE_EXPENSE
            CLASS_POINTER = CLASS_POINTER + 1
            IF(CLASS_POINTER > AVAIL_DATA_YEARS) EXIT
            IF(ASSET_CLASS_LIST(CLASS_POINTER) == 0. .OR. ASSET_CLASS_LIST(CLASS_POINTER) == -99.) EXIT
         ENDDO ! COST ALLOCATION TO CLASSES
!
! REVENUE ALLOCTION TO CLASSES
!
         VOID_LOGICAL = RETURN_ASSET_CLASS_LISTS(TRANSFR_REV_CLASS_VECTOR,ASSET_CLASS_LIST,TRANSFR_REV_ALLOC_VECTOR, &
                                                 ASSET_ALLOCATION_LIST)
         MAX_REV_CLASS_NUMBER = 0
         CLASS_POINTER = 1
         DO 
            MAX_REV_CLASS_NUMBER = MAX(MAX_REV_CLASS_NUMBER,int(ASSET_CLASS_LIST(CLASS_POINTER),2)+int(1,2))
            
            CLASS_POINTER = CLASS_POINTER + 1
            IF(CLASS_POINTER > AVAIL_DATA_YEARS) EXIT
            IF(ASSET_CLASS_LIST(CLASS_POINTER) == 0. .OR. ASSET_CLASS_LIST(CLASS_POINTER) == -99.) EXIT
         ENDDO
         NUMBER_OF_REV_CLASSES = CLASS_POINTER - 1
         IF(ALLOCATED(TRANSFR_REV_AMOUNT)) DEALLOCATE(TRANSFR_REV_AMOUNT,TRANSFR_REV_QUANTITIES,TRANSFR_REV_CLASS_POINTR)
         ALLOCATE(TRANSFR_REV_AMOUNT(0:12,NUMBER_OF_REV_CLASSES),TRANSFR_REV_QUANTITIES(0:12,NUMBER_OF_REV_CLASSES), &
                  TRANSFR_REV_CLASS_POINTR(0:MAX_REV_CLASS_NUMBER+1))
         TRANSFR_REV_AMOUNT = 0.
         TRANSFR_REV_QUANTITIES = 0.
         TRANSFR_REV_CLASS_POINTR = 0.
         CLASS_POINTER = 1
         DO
            ASSET_CLASS = ASSET_CLASS_LIST(CLASS_POINTER)
            ASSET_CLASS = ASSET_CLASS + 1
!
            IF(ASSET_ALLOCATION_LIST(CLASS_POINTER) < 0.) THEN
               ALLOCATION_VECTOR = ABS(ASSET_ALLOCATION_LIST(CLASS_POINTER))
               IF(MONTHLY_MIDAS_ACTIVE) THEN
                  CALL GET_MONTHLY_ANNUAL_VALUES(ALLOCATION_VECTOR,DATA_TYPE,VECTOR_TYPE,ANNUAL_VECTOR_VALUES(1), &
                                               VECTOR_MONTHLY_DATA(1,1),MONTHLY_DATA_UNITS,MONTH_ENDING)
                  CALL RIPPLE_MONTHLY_DATA(ANNUAL_VECTOR_VALUES(1),VECTOR_MONTHLY_DATA)
!
                  ASSET_ALLOCATOR = ANNUAL_VECTOR_VALUES(YR)/100.
                  DO MO = 0, 12
                     IF(MO == 0) THEN
                        ALLOCATION_VALUE(MO) = ANNUAL_VECTOR_VALUES(YR)/100.
                     ELSEIF(YR > LAST_AVAILABLE_MONTHLY_YEAR) THEN
                        ALLOCATION_VALUE(MO) = ANNUAL_VECTOR_VALUES(YR)/100.
                     ELSE
                        ALLOCATION_VALUE(MO) = VECTOR_MONTHLY_DATA(MO,YR)/100.
                     ENDIF
                  ENDDO
               ELSE
                  CALL GET_ASSET_VAR(ALLOCATION_VECTOR,DUMMY_TYPE,ANNUAL_VECTOR_VALUES(1))
!                     
                  ASSET_ALLOCATOR = ANNUAL_VECTOR_VALUES(YR)/100.
                  DO MO = 0, 12
                     ALLOCATION_VALUE(MO) = ASSET_ALLOCATOR 
                  ENDDO
               ENDIF
            ELSE
!                     
               ASSET_ALLOCATOR=ASSET_ALLOCATION_LIST(CLASS_POINTER)/100.
               DO MO = 0, 12
                  ALLOCATION_VALUE(MO) = ASSET_ALLOCATOR
               ENDDO
            ENDIF
            ALLOCATED_DOLLAR_AMOUNT(0) = 0.
            ALLOCATED_QUANT_AMOUNT(0) = 0.
            DO MO = 1, 12
               ALLOCATED_DOLLAR_AMOUNT(MO) = ALLOCATION_VALUE(MO) * TRANSFR_MARKET_REVS(MO)
               ALLOCATED_DOLLAR_AMOUNT(0) = ALLOCATED_DOLLAR_AMOUNT(0) + ALLOCATED_DOLLAR_AMOUNT(MO)
               ALLOCATED_QUANT_AMOUNT(MO) = ALLOCATION_VALUE(MO) * TRANSFR_MARKET_REVS_MWH(MO)
               ALLOCATED_QUANT_AMOUNT(0) = ALLOCATED_QUANT_AMOUNT(0) + ALLOCATED_QUANT_AMOUNT(MO)
            ENDDO
            IF(TRANSFR_REV_CLASS_POINTR(ASSET_CLASS) == 0) THEN
               TRANSFR_REV_CLASS_POINTR(ASSET_CLASS) = CLASS_POINTER
               RESULT_PTR = CLASS_POINTER
            ELSE
               RESULT_PTR = TRANSFR_REV_CLASS_POINTR(ASSET_CLASS)
            ENDIF
            DO MO = 0, 12
               TRANSFR_REV_AMOUNT(MO,RESULT_PTR) = ALLOCATED_DOLLAR_AMOUNT(MO)
               TRANSFR_REV_QUANTITIES(MO,RESULT_PTR) = ALLOCATED_QUANT_AMOUNT(MO)
            ENDDO
            TRANSFR_REV_AMOUNT(0,RESULT_PTR) = ALLOCATION_VALUE(0) * TOTAL_AMEREN_MARKET_REVENUES
            CLASS_POINTER = CLASS_POINTER + 1
            IF(CLASS_POINTER > AVAIL_DATA_YEARS) EXIT
            IF(ASSET_CLASS_LIST(CLASS_POINTER) == 0. .OR. ASSET_CLASS_LIST(CLASS_POINTER) == -99.) EXIT
         ENDDO
      RETURN
!***********************************************************************
!
! GET THE CLASS INFORMATION
!
      ENTRY RETURN_CLASS_TRANSFR_AMOUNTS(R_ASSET_CLASS,R_REV_TRANSFERS_ARE_ACTIVE,R_EXP_TRANSFERS_ARE_ACTIVE,R_CLASS_REVENUES, &
                                         R_CLASS_REV_QUANITIES,R_CLASS_FUEL_EXPENSES,R_CLASS_VOM_EXPENSES,R_CLASS_EXP_QUANITIES)
!***********************************************************************
!
         R_CLASS_REVENUES = 0.
         R_CLASS_REV_QUANITIES = 0.
         R_CLASS_FUEL_EXPENSES = 0.
         R_CLASS_VOM_EXPENSES = 0.
         R_CLASS_EXP_QUANITIES = 0.
         R_REV_TRANSFERS_ARE_ACTIVE = TRANSFERS_ARE_ACTIVE ! .FALSE.
         R_EXP_TRANSFERS_ARE_ACTIVE = TRANSFERS_ARE_ACTIVE ! .FALSE.
         IF(TRANSFERS_ARE_ACTIVE) THEN
            IF(R_ASSET_CLASS > 0 .AND. R_ASSET_CLASS <= MAX_REV_CLASS_NUMBER) THEN
               RESULT_PTR = TRANSFR_REV_CLASS_POINTR(R_ASSET_CLASS)
               IF(RESULT_PTR > 0) THEN
                  R_REV_TRANSFERS_ARE_ACTIVE = .TRUE.
                  R_CLASS_REVENUES = TRANSFR_REV_AMOUNT(0,RESULT_PTR)
                  R_CLASS_REV_QUANITIES = TRANSFR_REV_QUANTITIES(0,RESULT_PTR)
               ENDIF
            ENDIF
            IF(R_ASSET_CLASS > 0 .AND. R_ASSET_CLASS <= MAX_COST_CLASS_NUMBER) THEN
               RESULT_PTR = TRANSFR_COST_CLASS_POINTR(R_ASSET_CLASS)
               IF(RESULT_PTR > 0) THEN
                  R_EXP_TRANSFERS_ARE_ACTIVE = .TRUE.
                  R_CLASS_FUEL_EXPENSES = TRANSFR_FUEL_COST_AMOUNT(0,RESULT_PTR)
                  R_CLASS_VOM_EXPENSES = TRANSFR_VAR_COST_AMOUNT(0,RESULT_PTR)
                  R_CLASS_EXP_QUANITIES = TRANSFR_COST_QUANTITIES(0,RESULT_PTR)
               ENDIF
            ENDIF
         ENDIF
      RETURN
      END
!***********************************************************************
      FUNCTION THE_RATIO_OF_A_TO_B(A,B)
!***********************************************************************
!
      REAL (KIND=4) :: THE_RATIO_OF_A_TO_B,THE_PERCENT_OF_A_TO_B
      REAL (KIND=4) :: A,B
      REAL (KIND=4) :: NOT_AVAIL
      PARAMETER(NOT_AVAIL=-999999.)
!
         IF(ABS(B) <= 0.0001 .AND. ABS(A) < 0.00001) THEN
            THE_RATIO_OF_A_TO_B = 0.
         ELSEIF(ABS(B) <= 0.0001) THEN
            THE_RATIO_OF_A_TO_B = NOT_AVAIL
         ELSEIF(ABS(A) < 0.00001) THEN
            THE_RATIO_OF_A_TO_B = 0.
         ELSE
            THE_RATIO_OF_A_TO_B = A/B
         ENDIF
      RETURN
!***********************************************************************
      ENTRY THE_PERCENT_OF_A_TO_B(A,B)
!***********************************************************************
         IF(ABS(B) <= 0.0001 .AND. ABS(A) < 0.00001) THEN
            THE_RATIO_OF_A_TO_B = 0.
         ELSEIF(ABS(B) <= 0.0001) THEN
            THE_RATIO_OF_A_TO_B = NOT_AVAIL
         ELSEIF(ABS(A) < 0.00001) THEN
            THE_RATIO_OF_A_TO_B = 0.
         ELSE
            THE_RATIO_OF_A_TO_B = 100.*A/B
         ENDIF
      RETURN
      END      
!***********************************************************************
      SUBROUTINE NEW_COVERAGE_RATIO_RPT(R_VARIABLE_VALUE)
!     +                              SRP_RATIO)
!***********************************************************************
!
! VARIOUS COVERAGE RATIOS
!
      USE FINANCIAL_SWITCHES_COMMON
      use class_run_switchesc
      use class_run_switchesl1
      use class_run_switchesl4


      REAL (KIND=4) :: R_VARIABLE_VALUE(0:*)
      REAL (KIND=4), PARAMETER :: NOT_AVAIL=-999999.
      REAL (KIND=4) :: GOPINC,ITC_ITCAMT,TAXES_PAID,INTINC,OTHINC,BTL_TAXES,RTEMP,LTD_STD_INTEREST,LTD_PS_RETIREMENT, &
                       COVERAGE_DRIVER_RATIO,LEASE_PAYMENT_LIMIT,DEP_AMORTIZATION,NOPINC,COVERAGE_RATIO_VALUE, &
                       FUNDS_FOR_CONSTRUCTION,SUM_OPERATIONS,INTEREST,AFUDC_ON_CASH,SRP_TOTAL_DEBT_SERVICE, &
                       SRP_FUNDS_FOR_DEBT_SERVICE,LTD_INTEREST_LESS_AFUDC
!                       
         GOPINC = R_VARIABLE_VALUE(31)    ! GOPINC
         TAXES_PAID = R_VARIABLE_VALUE(211) + & ! FEDERAL TAXES PAID
                      R_VARIABLE_VALUE(212)   ! STAET TAXEPAID
         ITC_ITCAMT = R_VARIABLE_VALUE(50) ! ITCAMT
         INTINC = R_VARIABLE_VALUE(34)
         OTHINC = R_VARIABLE_VALUE(33)
         BTL_TAXES = R_VARIABLE_VALUE(36)
         DEP_AMORTIZATION = R_VARIABLE_VALUE(17) + & ! BKDPPT + BDPAFC +
                            R_VARIABLE_VALUE(18)    ! AMTEXP
         AFUDC_ON_CASH = R_VARIABLE_VALUE(37) + & ! AFDC1-TAFDCB
                         R_VARIABLE_VALUE(41) ! TAFDCB
         RTEMP = GOPINC + ITC_ITCAMT + TAXES_PAID
         LTD_STD_INTEREST = R_VARIABLE_VALUE(39) + & ! LTDINT(RUN_YEAR)
                            R_VARIABLE_VALUE(40)   ! STDINT(2)
         LTD_PS_RETIREMENT = R_VARIABLE_VALUE(154) + & ! Preferred Stock Retirements
                             R_VARIABLE_VALUE(119)   ! Debt Retirements
!
! COVERAGE RATIO RESULT FOR THE RATIO CHOOSEN
!
         COVERAGE_DRIVER_RATIO = NOT_AVAIL
         IF(COVERAGE_RATIO == 1) THEN
!           LTD_STD_INTEREST = LTDINT(RUN_YEAR) + STDINT(2)
            IF(LTD_STD_INTEREST /= 0.) COVERAGE_DRIVER_RATIO = GOPINC/LTD_STD_INTEREST
         ELSEIF(COVERAGE_RATIO == 11) THEN
!           LTD_STD_INTEREST = LTDINT(RUN_YEAR) + STDINT(2)
            LTD_INTEREST_LESS_AFUDC = R_VARIABLE_VALUE(293) & ! LTD BOOKED INTEREST WITH AMORT
                                      - R_VARIABLE_VALUE(41)  ! afudc borrowed
            IF(LTD_INTEREST_LESS_AFUDC /= 0.) COVERAGE_DRIVER_RATIO = (LTD_INTEREST_LESS_AFUDC + R_VARIABLE_VALUE(45))/ &
                                              LTD_INTEREST_LESS_AFUDC
         ELSEIF(COVERAGE_RATIO == 2 .OR. COVERAGE_RATIO == 3) THEN
            RTEMP = GOPINC+ITC_ITCAMT+TAXES_PAID+INTINC+OTHINC-BTL_TAXES - R_VARIABLE_VALUE(35)   ! CLASS_BTL_EXPENSES
!           LTD_STD_INTEREST = LTDINT(RUN_YEAR) + STDINT(2)
            IF(COVERAGE_RATIO == 2) LTD_STD_INTEREST = LTD_STD_INTEREST - AFUDC_ON_CASH
            IF(LTD_STD_INTEREST /= 0.) COVERAGE_DRIVER_RATIO = RTEMP/LTD_STD_INTEREST
         ELSEIF(COVERAGE_RATIO == 8 .OR. COVERAGE_RATIO == 9) THEN
            LEASE_PAYMENT_LIMIT = MAX(0.,R_VARIABLE_VALUE(778) - .02*R_VARIABLE_VALUE(79))/3. ! COMEQU(2)
            RTEMP = GOPINC+ITC_ITCAMT+TAXES_PAID+INTINC+OTHINC-BTL_TAXES + LEASE_PAYMENT_LIMIT
            INTEREST = LTD_STD_INTEREST - AFUDC_ON_CASH + LEASE_PAYMENT_LIMIT
            IF(COVERAGE_RATIO == 9) INTEREST=INTEREST+AFUDC_ON_CASH
            IF(INTEREST /= 0.) COVERAGE_DRIVER_RATIO=RTEMP/INTEREST
         ELSEIF(COVERAGE_RATIO == 4 .OR. COVERAGE_RATIO == 5) THEN
            INTEREST = LTD_STD_INTEREST + LTD_PS_RETIREMENT
            RTEMP = GOPINC + ITC_ITCAMT + OTHINC + INTINC + DEP_AMORTIZATION + R_VARIABLE_VALUE(29) + & ! TXDEFP
                    R_VARIABLE_VALUE(28)    ! TXNORM
            IF(INTEREST /= 0.) COVERAGE_DRIVER_RATIO=RTEMP/INTEREST
         ELSEIF(COVERAGE_RATIO == 6 .OR. COVERAGE_RATIO == 7) THEN
               SRP_TOTAL_DEBT_SERVICE = R_VARIABLE_VALUE(39) + & ! LTDINT(RUN_YEAR) +
                                        R_VARIABLE_VALUE(119) + & ! LTDRET(RUN_YEAR)
                                        R_VARIABLE_VALUE(154)   ! PSRED(RUN_YEAR)
! NOTE OTNINC IS NET OF BLT_EXPENSES
               SRP_FUNDS_FOR_DEBT_SERVICE = R_VARIABLE_VALUE(31) + & ! GOPINC
                                            R_VARIABLE_VALUE(34) - & ! INTINC -
                                            R_VARIABLE_VALUE(40) + & ! STDINT(2) +
                                            R_VARIABLE_VALUE(33) + & ! OTHINC +
                                            DEP_AMORTIZATION + &        ! BKDPPT + BDPAFC + AMTEXP
                                            R_VARIABLE_VALUE(217)   ! TXPROP +
               IF(SRP_TOTAL_DEBT_SERVICE /= 0.) COVERAGE_DRIVER_RATIO = SRP_FUNDS_FOR_DEBT_SERVICE/SRP_TOTAL_DEBT_SERVICE

! 031207.
          ELSEIF(COVERAGE_RATIO == 13 .OR. COVERAGE_RATIO == 16 .OR. COVERAGE_RATIO == 14 .OR. COVERAGE_RATIO == 17) THEN
            RTEMP = R_VARIABLE_VALUE(38) &  ! INCOME BEFORE INTEREST
                      + R_VARIABLE_VALUE(41)   ! AFUDC-BORROWED
            LTD_STD_INTEREST = R_VARIABLE_VALUE(293) &  ! LTD + AMORTIZATION
                                 + R_VARIABLE_VALUE(40)   ! STDINT(2)
            IF(LTD_STD_INTEREST /= 0.) COVERAGE_DRIVER_RATIO = RTEMP/LTD_STD_INTEREST
         ENDIF
         R_VARIABLE_VALUE(757) = COVERAGE_DRIVER_RATIO
      RETURN
      END
      
